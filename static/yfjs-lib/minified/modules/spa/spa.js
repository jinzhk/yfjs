define("yfjs/spa",["yfjs/spa/app"],function(a){return new a}),define("yfjs/spa/app",["yfjs","./version","jquery","./util/helpers","./util/event","./util/error","./util/widget","./util/route","./util/remote","./util/template","./util/style-loader","./util/ajax","./util/websocket","./util/filter","./util/cookie","./util/console","./ui/loading"],function(YFjs,Version,$,_,Event,Error,Widget,Route,Remote,Template,StyleLoader,Ajax,WebSocket,Filter,Cookie,console,Loading){function App(a){if(!(this instanceof App))return new App(a);_.def(this,"__options__",_.extend({},App.DEFAULTS,a)),_.def(this,"__cache__",{})}function triggerAppFn(a,b){a=_.trim(a),b=b||[],a&&App.Event.trigger("AppFnCalled",[a].concat(b))}function logError(a,b){if(!((b=b||0)>1e3||_.isEmpty(a)))if(_.isArray(a))$.each(a,function(a,c){logError(c,b+1)});else{var c;a.context instanceof App.Creator||View.instanceof(a.context,View.Creator)||Layout.instanceof(a.context,Layout.Creator)?_.inError(a,a.context.getError())>-1?(c=a,a.context.removeError(a)):c=null:c=a,_.notNull(c)&&console.error(c)}}function normalizeErrMsg(a){return a&&_.isString(a.message)?(a.type?a.type+" ":"").replace(/^\w/,function(a){return a.toUpperCase()})+"Error"+(a.message?": "+a.message:""):""}function inFilters(a,b){var c=-1;if(!_.notNull(a)||!_.isArray(b))return c;for(var d=0;d<b.length;d++)if(_.notNull(b[d])&&_.notNull(b[d].name)&&a.name===b[d].name){c=d;break}return c}function normalizeBeforeDestroyText(a){a=_.notNull(a)?_.isObject(a)?"":_.trim(a):"";var b="页面还有未完成的操作";return a.length?b+="：\n==================================================\n"+a+"\n==================================================\n":b+="。",b+="确定离开吗？"}var JSON=_.JSON;_.window.$=$,_.window._=_.Exports,_.window.JSON=JSON,_.window.console=console,App.NAMESPACE="App",App.VERSION=Version(App.NAMESPACE),App.DEFAULTS={container:"body",baseUrl:{root:"",resource:"/",style:"/",view:"views",layout:"layouts",template:"templates"},index:"/home",cssPrefix:{layout:"app-layout_",view:"app-view_",include:"app-include_"},loading:_.__undef__,filter:_.__undef__,binds:_.__undef__,cache:!0,template:_.__undef__,styleLoader:_.__undef__,mode:_.__undef__,ajax:_.__undef__,websocket:_.__undef__,cookie:_.__undef__,statechange:_.__undef__,beforeCreate:_.__undef__,created:_.__undef__,beforeReady:_.__undef__,ready:_.__undef__,beforeLoad:_.__undef__,loaded:_.__undef__,beforeDestroy:_.__undef__,destroyed:_.__undef__,error:'<div class="container"><h1>Error</h1>{{if isArray(error)}}<dl>{{each error as err}}{{if err}}<dt>&diams;&ensp;{{err.type}}</dt><dd>{{err.message}}</dd>{{/if}}{{/each}}</dl>{{else if error}}<dl><dt>&diams;&ensp;{{error.type}}</dt><dd>{{error.message}}</dd></dl>{{/if}}</div>',errorFilter:_.__undef__,onError:_.__undef__,Widget:_.__undef__,Layout:_.__undef__,View:_.__undef__};var View=Route.View,Layout=Route.Layout;return App.REGEXP_PROTOCOL_START=_.REGEXP_PROTOCOL_START,App.REGEXP_DSLASH_START=_.REGEXP_DSLASH_START,App.REGEXP_SLASH_START=_.REGEXP_SLASH_START,App.REGEXP_SLASH_END=_.REGEXP_SLASH_END,App.REGEXP_HASH_START=_.REGEXP_HASH_START,App.REGEXP_PATH_HASH_START=_.REGEXP_PATH_HASH_START,App.STATE=["BEFORE_CREATE","CREATED","BEFORE_READY","READY","BEFORE_LOAD","LOADED","BEFORE_DESTROY","DESTROYED"],App.STATE[-1]="DISPOSE",App.STATE_INDEX={},$.each(App.STATE,function(a,b){App.STATE_INDEX[b]=a}),App.updateState=_.stateUpdater(App.STATE,App.STATE_INDEX),App.Event=Event(App.NAMESPACE),App.Error=Error(App.NAMESPACE),App.Error.translate({instantiated:App.NAMESPACE+" 的构造器对象必须通过 "+App.NAMESPACE+" 的实例对象进行实例化",initialized:App.NAMESPACE+" 的实例对象必须通过 "+App.NAMESPACE+" 的初始器对象进行实例化",setter:"App 设置错误。无法设置实例属性 {0}，因为它是 App 实例的固有属性",callback:"执行 App 的 {0} 操作时发生了错误: {1}"}),_.def(App,"LAST_VIEW",null,{writable:!1,configurable:!0}),App.prototype={_:_.Exports,remote:Remote,json:JSON,console:console,set:_.optionSetter(App.DEFAULTS),get:_.optionGetter(),getOptions:_.optionsGetter(),getCache:View.Initializer.prototype.getCache,setCache:View.Initializer.prototype.setCache,removeCache:View.Initializer.prototype.removeCache,helper:function(a,b){if((a=_.trim(a))&&_.isFunction(b)){var c=this.get("helpers")||{};c[a]=b,this.set("helpers",c)}return this},helpers:function(a){if(_.notNull(a)&&_.isObject(a)){var b=this.get("helpers")||{};_.extend(b,a),this.set("helpers",b)}return this},bind:View.Initializer.prototype.bind,on:View.Initializer.prototype.on,one:View.Initializer.prototype.one,create:function(a){var b={};for(var c in this)_.__hasOwn.call(this,c)&&(b[c]=this[c]);delete b.__options__,delete b.__cache__,a=_.extend(b,a);var d=new App.Launcher(new App.Creator(new App(a)));return d.startup(),d.getInstance()}},App.Launcher=function(a){if(!(a instanceof App.Creator))throw App.Error.make("instantiated");if(!(this instanceof App.Launcher))return new App.Launcher(a);_.def(this,"__widget__",a.__widget__),_.def(this,"__instance__",a),_.def(this,"__options__",a.__options__),_.def(this,"__err_frame__",30),_.def(this,"__err_buffer__",[]),_.def(this,"__err_stime__",0,{configurable:!0}),_.def(this,"ajax",a.ajax,{writable:!1,configurable:!1}),_.def(this,"ws",a.ws,{writable:!1,configurable:!1}),_.def(this,"template",a.template,{writable:!1,configurable:!1}),this.init()},App.Launcher.prototype={getInstance:function(){return this.__instance__},init:function(){var a=this.__options__,b=this.getInstance();this.container=b.container,Template.helpers({getCookie:function(){return this.rootContext.getCookie.apply(this.rootContext,arguments)},getRootUrl:function(){return this.rootContext.getRootUrl.apply(this.rootContext,arguments)},getResourceUrl:function(){return this.rootContext.getResourceUrl.apply(this.rootContext,arguments)},getStyleUrl:function(){return this.rootContext.getStyleUrl.apply(this.rootContext,arguments)},getFullUrl:function(){return this.rootContext.getFullUrl.apply(this.rootContext,arguments)},getUrl:function(){return this.getUrl.apply(this,arguments)}});var c;try{c=new RegExp("(^|\\s)("+a.cssPrefix.layout+"[^\\s'\"]+)(\\s|$)")}catch(a){c=null}_.def(this,"REGEXP_LAYOUT_CLASSNAME",c,{writable:!1,configurable:!1});var d;try{d=new RegExp("(^|\\s)("+a.cssPrefix.view+"[^\\s'\"]+)(\\s|$)")}catch(a){d=null}return _.def(this,"REGEXP_VIEW_CLASSNAME",d,{writable:!1,configurable:!1}),this},startup:function(){function callErrorFilter(a){var b=[];if(_.isArray(a))$.each(a,function(a,c){b=_.concatError(b,callErrorFilter(c))});else if(!_.isEmpty(a)){b.push(a);var c;c=View.instanceof(a.context,View.Creator)||Layout.instanceof(a.context,Layout.Creator)?a.context:appInst;var d;if(!_.isEmpty(a)&&_.isFunction(d=c.get("errorFilter"))){a.context!==c&&_.setPropsRecursive(a,{context:c}),c.inError(a)<0&&c.addError(a);try{d.call(c,a),c.inError(a)<0&&(b=_.shiftError(b,a))}catch(a){b=_.concatError(b,c.makeError("callback",["errorFilter",a.message],a))}}}return b}function callOnError(a){var b=[];if(_.isArray(a))$.each(a,function(a,c){b=_.concatError(b,callOnError(c))});else if(!_.isEmpty(a)){b.push(a);var c;(View.instanceof(a.context,View.Creator)||Layout.instanceof(a.context,Layout.Creator))&&(c=a.context);var d=a.__err_handler__;if(d&&(b=_.shiftError(b,a),_.isFunction(d)))try{d.call(c,a)}catch(a){b=_.concatError(b,(c||appInst).makeError("callback",["onPropError",a.message],a))}}return b}function callOnErrorOption(a,b){var c=[];if(_.isArray(a))$.each(a,function(a,d){c=_.concatError(c,callOnErrorOption(d,b))});else if(!_.isEmpty(a)&&(c.push(a),b||!View.instanceof(a.context,View.Creator)&&!Layout.instanceof(a.context,Layout.Creator)||(b=a.context),b)){if(b.inError(a)>-1){var d=b.get("onError");if(_.isFunction(d))try{d.call(b,a)}catch(a){c.push(b.makeError("callback",["onError",a.message],a))}}else c=_.shiftError(c,a);a.context!==b&&((View.instanceof(a.context,View.Creator)||Layout.instanceof(a.context,Layout.Creator))&&a.context.removeError(a),_.setPropsRecursive(a,{context:b}),b.inError(a)<0&&b.addError(a))}return c}var self=this,options=this.__options__||{},appInst=this.getInstance(),statechange=App.updateState.call(appInst,"beforeReady");if(!1!==statechange&&appInst.callOption("statechange",statechange),appInst.callOption("beforeReady"),App.Event.bind(["Error","LoadError","LoadingError","FilterError","CallbackError","WidgetError","IncludeError","TemplateError","AjaxError","WebSocketError","CookieError"].join(" "),function(a,b,c){function d(){function a(a,c){View.instanceof(a)&&(a.setData("$error",c),a.load(function(a,d){_.isEmpty(a)?(d=d||{},d.error=!0,App.Event.trigger("Loaded",d)):(a=_.concatError(a,c),b(a))}))}function b(a,b){_.isString(a)?(b=a,a=h):a=a||h;var c={view:!1,layout:!1};_.isUndef(b)&&(b=d.defaultErrorHtml(a)),b=Route.View.wrap()(b),Layout.updateWrap()?c.container=Layout.CONTAINER:b=Layout.wrap()(b),c.html=b,c.error=!0,App.Event.trigger("Loaded",c)}var d=this;_.def(d,"__err_stime__",0);var e=d.__err_buffer__.splice(0,d.__err_buffer__.length);e=callErrorFilter(e);var f=_.sliceError(e,{level:View.Error.LEVEL_PAGE}),g=_.shiftError(e,f);if(!_.isEmpty(f)&&_.isEmpty(g)){logError(e);var h=e,i=appInst.callOption("error");Remote.instanceof(i)&&(i=i.get(),_.isEmpty(i)||_.isObject(i)||(i={path:_.trim(i)})),_.isEmpty(i)?b():_.isObject(i)?i.path?View.load(i,function(c,d){View.instanceof(d)?a(d,h):b(_.concatError(c,h))}):(i.path="error",i.layout=i.layout||null,a(new View.Constructor(new View.Creator(View.create(i,View),View),View),h)):(i=_.trim(i),d.template.render(i,{error:h},function(a,c){b(_.isUndef(c)?_.concatError(a,h):c)}))}else{var j=_.sliceError(e,{level:View.Error.LEVEL_WIDGET});_.isEmpty(j)||(j=callOnError(j)),_.isEmpty(j)||(j=callOnErrorOption(j));var k=_.sliceError(e,{level:View.Error.LEVEL_APP});if(_.isEmpty(j)||(k=_.concatError(k,j)),_.isEmpty(k)||(appInst.addError(k),k=callOnErrorOption(k,appInst)),!_.isEmpty(k)){c=c||{};var l=_.sliceError(k,{__caller_name__:/^(view|layout)\.include/});if(!_.isEmpty(l)){var m,n={};if($.each(l,function(a,b){b.state&&(m=b.state.body)&&(n[m]=_.concatError(n[m],b))}),!_.isUndef(c.html)){var o;for(m in n)o=d.defaultErrorHtml(n[m]),c.html=_.replaceMainBody(c.html,m,o)}}}logError(e),_.isEmpty(c)||(c.view=c.view||!1,c.layout=c.layout||!1,App.Event.trigger("Loaded",c))}}var e=(new Date).getTime();self.__err_stime__||_.def(self,"__err_stime__",e);var f=e-self.__err_stime__;if(0==f||f<=self.__err_frame__){var g=_.concatError(self.__err_buffer__,b),h=[0,self.__err_buffer__.length];h=h.concat(g),self.__err_buffer__.splice.apply(self.__err_buffer__,h),0==f&&_.requestAnimationFrame.call(self,d,[],self.__err_frame__)}}),Cookie.Event.bind("Error",function(a,b){App.Event.trigger("CookieError",_.isArray(b)?[b]:b)}),Loading.Event.bind("Error",function(a,b){App.Event.trigger("LoadingError",_.isArray(b)?[b]:b)}),Filter.Event.bind("Error",function(a,b){App.Event.trigger("FilterError",_.isArray(b)?[b]:b)}),Template.Event.bind("Error",function(a,b){App.Event.trigger("TemplateError",_.isArray(b)?[b]:b)}),Template.Event.bind("CallbackError",function(a,b){App.Event.trigger("CallbackError",_.isArray(b)?[b]:b)}),Ajax.Event.bind("Error",function(a,b){App.Event.trigger("AjaxError",_.isArray(b)?[b]:b)}),WebSocket.Event.bind("Error",function(a,b){App.Event.trigger("WebSocketError",_.isArray(b)?[b]:b)}),View.Event.bind("Error",function(a,b){App.Event.trigger("WidgetError",_.isArray(b)?[b]:b)}),Layout.Event.bind("Error",function(a,b){App.Event.trigger("WidgetError",_.isArray(b)?[b]:b)}),View.Event.bind("IncludeError",function(a,b){App.Event.trigger("IncludeError",_.isArray(b)?[b]:b)}),Layout.Event.bind("IncludeError",function(a,b){App.Event.trigger("IncludeError",_.isArray(b)?[b]:b)}),Route.Event.bind("CallbackError",function(a,b){App.Event.trigger("CallbackError",_.isArray(b)?[b]:b)}),App.Event.bind("AppFnCalled",function(a,b){if(b&&_.__hasProto.call(App.Creator,b)){var c=_.__aslice.call(arguments,2),d=self[b];_.isFunction(d)&&d.apply(self,c)}}),Route.Event.bind("Loading",function(){appInst.__loading__.ready()}),App.Event.bind("Loaded",function(a,b){function c(a){a=a||{},_.docRoot.className=_.docRoot.className||"";var b=function(a,b,c){if(a&&a instanceof RegExp){var d=(b||"")+(c||"");a.test(_.docRoot.className)?_.docRoot.className=_.docRoot.className.replace(a,d?"$1"+d+"$3":" "):_.docRoot.className=_.docRoot.className?_.docRoot.className+" "+d:d}};Layout.instanceof(a.layout)?b(self.REGEXP_LAYOUT_CLASSNAME,options.cssPrefix.layout,_.stylePathId(a.layout.getState("name"))):b(self.REGEXP_LAYOUT_CLASSNAME),View.instanceof(a.view)?b(self.REGEXP_VIEW_CLASSNAME,options.cssPrefix.view,_.stylePathId(a.view.getState("name"))):b(self.REGEXP_VIEW_CLASSNAME)}function d(){appInst.__loading__.destroy()}b=b||{};var e=b.view,f=View.LAST_INSTANCE,g=View.isChanged(e);View.instanceof(f)&&f.destroy();var h=b.layout,i=Layout.LAST_INSTANCE,j=Layout.isChanged(h);j&&Layout.instanceof(i)&&i.destroy(),View.instanceof(e)?_.def(App,"LAST_VIEW",e.getInstance()):_.def(App,"LAST_VIEW",null);var k;View.instanceof(e)&&(k=e.getState(),self.replaceState(k)),View.instanceof(f)?self.replacePrevState(f.getState()):_.notNull(k)&&self.replacePrevState(k),_.isUndef(b.html)?(View.instanceof(f)&&View.setLastStyle$(f.getState("$style")||null),Layout.instanceof(i)&&Layout.setLastStyle$(i.getState("$style")||null)):(b.container?$(b.container).html(b.html):$(self.container).prepend(b.html),c(b),g&&(View.removeStyle$(View.LAST_$STYLE).setLastStyle$(),View.instanceof(f)&&f.destroyStyle(),View.instanceof(e)&&e.readyStyle()),j&&(Layout.removeStyle$(Layout.LAST_$STYLE).setLastStyle$(),Layout.instanceof(i)&&i.destroyStyle(),Layout.instanceof(h)&&h.readyStyle())),View.instanceof(f)&&f.destroyed(),j&&Layout.instanceof(i)&&i.destroyed(),self.prevState("hash")!==self.getState("hash")?App.Event.trigger("viewchange",[self.getState(),self.prevState()],_.window):self.replacePrevState(self.getState());var l=!1;View.instanceof(e)&&(l=!!e.getState("__reload_page__")),(l||j)&&Layout.instanceof(h)&&h.ready(),View.instanceof(e)&&e.ready(),!1!==h||Layout.instanceof(h)?_.def(Layout,"LAST_INSTANCE",h):_.def(Layout,"LAST_INSTANCE",null),!1!==e||View.instanceof(e)?_.def(View,"LAST_INSTANCE",e):_.def(View,"LAST_INSTANCE",null);var m=App.updateState.call(appInst,"loaded");!1!==m&&appInst.callOption("statechange",m),appInst.callOption("loaded"),d()}),$(_.document).on("click",'a[href^="#"]',function(e){var isDefaultPrevented=_.isFunction(e.isDefaultPrevented)&&e.isDefaultPrevented(),isPropagationStopped=_.isFunction(e.isPropagationStopped)&&e.isPropagationStopped(),isImmediatePropagationStopped=_.isFunction(e.isImmediatePropagationStopped)&&e.isImmediatePropagationStopped();if(!(isDefaultPrevented||isPropagationStopped||isImmediatePropagationStopped)){var $this=$(this),href=_.trim($this.attr("href")),path=href.replace(App.REGEXP_HASH_START,""),reload=_.trim($this.data("reload"))||!1;if("false"!==reload){if(e.preventDefault(),"boolean"!=typeof reload)try{reload=eval(_.trim(reload)),reload=!!reload}catch(e){reload=!1}reload&&(path=_.toUrl(path,{__reload__:!0})),path&&self.go(path)}}}),$(_.window).off("beforeunload").on("beforeunload",function(a){var b=self.beforeViewDestroy(a);return _.isNull(b)&&(b=self.beforeDestroy(a),_.isNull(b)&&self.destroy()),_.notNull(b)&&(b=normalizeBeforeDestroyText(b),a&&_.notNull(b)&&(a.returnValue=b)),b}),_.isArray(options.binds))for(var binds,i=0;i<options.binds.length;i++)binds=options.binds[i],_.isArray(binds)&&self.bind.apply(self,binds);return self.ready(),Route.listen(function(){self.go()}),self.go(),this},getState:function(a){var b=this.getInstance();return b.getState.apply(b,arguments)},setState:function(a,b){var c=this.getInstance();return c.setState.apply(c,arguments),this},replaceState:function(a){if(null!=a){var b=this.getInstance(),c=b.getState("label");_.stateReplacement.call(b,"__state__",a,{configurable:!0}),_.notNull(c)&&_.def(b.__state__,"label",c)}return this},prevState:function(a){var b=this.getInstance();return b.prevState.apply(b,arguments)},replacePrevState:function(a){if(null!=a){var b=this.getInstance(),c=b.prevState("label");_.stateReplacement.call(b,"__prev_state__",a,{configurable:!0}),_.notNull(c)&&_.def(b.__prev_state__,"label",c)}return this},ready:function(){var a=this.getInstance(),b=App.updateState.call(a,"ready");!1!==b&&a.callOption("statechange",b),a.callOption("ready")},destroy:function(){var a=this.getInstance(),b=App.updateState.call(a,"destroyed");!1!==b&&a.callOption("statechange",b),a.callOption("destroyed")},beforeDestroy:function(){var a=this.getInstance(),b=App.updateState.call(a,"beforeDestroy");!1!==b&&a.callOption("statechange",b);var c,d=a.get("beforeDestroy");if(_.isFunction(d))try{c=d.apply(a,arguments)}catch(b){var e=a.makeError("callback",["beforeDestroy",b.message],b);c=e.message}return c},go:function(a,b){function c(a,b){_.isEmpty(a)?App.Event.trigger("Loaded",b):App.Event.trigger("LoadError",[a,b])}function d(a){a=a||{},a.path=a.path||a.hash||"";var b=!0;return a.path&&g.__filters__.length?(a.filtered=[],$.each(g.__filters__,function(c,d){if(d instanceof Filter){if(!(b=d.doFilter(a.path)))return!1;a.filtered.push(d)}}),b):b}function e(a){a=_.extend({},a),a.hash=(a.hash||"").replace(App.REGEXP_PATH_HASH_START,""),a.hash&&"/"!==a.hash||(a.hash=j.index);var b=a.hash.lastIndexOf("#");return b>-1?(a.hash=a.hash.substring(b+1),e(a)):a=View.normalizeState(a)}var f=this,g=this.getInstance();if(!f.go.__before_destroy__){var h=f.beforeViewDestroy();if(_.notNull(h))try{if(!_.window.confirm(normalizeBeforeDestroyText(h)))return f}catch(a){return f}}if(_.isBoolean(a)||(b=a,a=!1),_.isUndef(f.go.reloadPage)||(a=!!f.go.reloadPage,delete f.go.reloadPage),_.isNumber(b))return f.go.reloadPage=a,Route.history.go(b),f;var i,j=f.__options__,k=Route.getState(),l=decodeURIComponent(k.hash.replace(App.REGEXP_PATH_HASH_START,""));if(_.notNull(b)){_.isObject(b)||(b={hash:_.trim(b)}),b=e(b);var m=b.param.__reload__;if(m&&(delete b.param.__reload__,b=e({hash:_.toUrl(b.path,b.param)}),f.go.reload=m),(i=b.hash.replace(App.REGEXP_HASH_START,""))!==l)return _.def(f.go,"__before_destroy__",!0,{configurable:!0}),Route.pushState(b.data||null,b.title||"",i),f}else if(b=e(k),(i=b.hash.replace(App.REGEXP_HASH_START,""))!==l)return _.def(f.go,"__before_destroy__",!0,{configurable:!0}),Route.replaceState(b.data||null,b.title||"",i),f;delete f.go.__before_destroy__,_.def(b,"__reload_page__",a),f.go.reload?(b.data.reload=f.go.reload,delete f.go.reload):delete b.data.reload;var n=f.getState();if(n&&f.replacePrevState(n),f.replaceState(b),d(b)){_.isFunction(console.clear)&&console.clear();var o=App.updateState.call(g,"beforeLoad");!1!==o&&g.callOption("statechange",o),g.callOption("beforeLoad");var p;_.isEmpty(p=g.getError())||App.Event.trigger("Error",p),Route.load(b,c)}return this},back:function(){return Route.history.back(),this},forward:function(){return Route.history.forward(),this},helper:function(a,b){return this.template.helper(a,b),this},helpers:function(a){return this.template.helpers(a),this},bind:function(a,b,c,d,e){var f=this,g=f.getInstance();if(_.notNull(a)&&_.isObject(a)){_.validElement(b)||(c=c||b,b=_.__undef__);for(var h in a)this.bind(h,b,c,a[h],e);return this}var i=Event.normalizeBindArgs.apply(this,arguments);return i?(a=i[0],b=i[1],c=i[2],d=i[3],d&&(d.context=g),_.is$(b)?App.Event.bind(a,b,c,d,e):(b=/^viewchange/.test(a)?_.window:b?$(b,_.document):_.document,App.Event.bind(a,b,c,d,e)),this):this},on:function(){return this.bind.apply(this,arguments)},one:function(a,b,c,d){return this.bind(a,b,c,d,1)},unbind:function(a,b,c){var d=Event.normalizeUnBindArgs.apply(Event,arguments);return a=d[0],b=d[1],c=d[2],_.is$(b)?App.Event.unbind(a,b,c):(b=/^viewchange/.test(a)?_.window:b?$(b,_.document):_.document,App.Event.unbind(a,b,c)),this},off:function(){return this.unbind.apply(this,arguments)},trigger:function(a,b,c){var d=Event.normalizeTriggerArgs.apply(Event,arguments);return a=d[0],b=d[1],c=d[2],_.is$(c)?App.Event.trigger(a,b,c):(c=/^viewchange/.test(a)?_.window:c?$(c,_.document):_.document,App.Event.trigger(a,b,c)),this},beforeViewDestroy:function(a){var b,c=View.LAST_INSTANCE,d=Layout.LAST_INSTANCE;return View.instanceof(c)&&(b=c.beforeDestroy(a)),_.isNull(b)&&Layout.instanceof(d)&&(b=d.beforeDestroy(a)),b},defaultErrorHtml:function(a){var b;return _.isString(App.DEFAULTS.error)&&(b=this.template.render(App.DEFAULTS.error,{error:a}),_.isString(b)||(a=_.isArray(b)?b.concat(a):[b].concat(a),b=_.__undef__)),_.isUndef(b)&&(b=[],_.isArray(a)?$.each(a,function(a,c){b.push(normalizeErrMsg(c))}):b.push(normalizeErrMsg(a)),b=b.join("\n")||"Error!"),b}},App.Creator=function(a){if(!(a instanceof App))throw App.Error.make("initialized");if(!(this instanceof App.Creator))return new App.Creator(a);_.def(this,"__ns__",App.NAMESPACE),_.def(this,"__widget__",View),_.def(this,"__initializer__",a),_.def(this,"__options__",{}),_.def(this,"__setter__",_.setter(App.DEFAULTS,App.Creator)),_.def(this,"__getter__",_.getter(App.DEFAULTS,App.Creator)),_.def(this,"__state_index__",App.STATE_INDEX.BEFORE_CREATE,{configurable:!0}),_.def(this,"__state_index_getter__",_.stateIndexGetter(App.STATE,App.STATE_INDEX)),_.def(this,"__error__",[]),_.def(this,"__error_ns__","APP"),_.def(this,"__error_maker__",_.errorMaker(App.Error)),_.def(this,"json",JSON,{writable:!1,configurable:!1}),_.def(this,"_",_.Exports,{writable:!1,configurable:!1});var b,c=this,d=a.getOptions();for(b in d)if(_.__hasOwn.call(d,b)){var e=d[b];_.isUndef(e)||this.set(b,e)}var f={};_.def(f,"label",App.STATE[this.__state_index__],{writable:!1,configurable:!0}),this.callOption("statechange",f),this.callOption("beforeCreate",f),_.def(this,"__state__",f,{configurable:!0}),_.def(this,"__prev_state__",null,{configurable:!0}),this.set("container",this.callOption("container")||_.docBody);var g=this.callOption("baseUrl");_.notNull(g)&&!_.isObject(g)&&(g={root:_.trim(g)}),g=_.extend({},App.DEFAULTS.baseUrl,g),g.root||(g.root=Route.getBaseHref()),g.root=_.trim(g.root).replace(App.REGEXP_SLASH_END,""),this.set("baseUrl",g),this.set("index",_.trim(this.callOption("index"))||Ajax.DEFAULTS.index);var h=this.callOption("cssPrefix")||{};_.isObject(h)?(h.layout=_.trim(h.layout)||App.DEFAULTS.cssPrefix.layout,h.view=_.trim(h.view)||App.DEFAULTS.cssPrefix.view,h.include=_.trim(h.include)||App.DEFAULTS.cssPrefix.include):h=_.extend({},App.DEFAULTS.cssPrefix),this.set("cssPrefix",h),this.set("loading",_.extend({},App.DEFAULTS.loading,this.callOption("loading"))),this.set("filter",_.normalizeArrOption(this.callOption("filter"))),this.set("binds",this.callOption("binds")),_.isNull(YFjs.mdCache)&&(YFjs.mdCache=this.callOption("cache")),_.notNull(YFjs.mdCache)&&this.set("cache",YFjs.mdCache),this.set("template",this.callOption("template")),this.set("styleLoader",this.callOption("styleLoader")),this.set("mode",this.callOption("mode")),this.set("ajax",this.callOption("ajax")),this.set("websocket",this.callOption("websocket")),this.set("cookie",this.callOption("cookie")),this.set("Widget",this.callOption("Widget")),this.set("Layout",this.callOption("Layout")),this.set("View",this.callOption("View")),d=this.__options__||{};var i=d.baseUrl,j={};j.root=_.getRelativePath(i.root,_.LOCAL_ROOT,!1),j.resource=_.getRelativePath(i.resource,j.root),j.style=_.getRelativePath(i.style,j.root),j.view=_.getRelativePath(i.view,j.root),j.layout=_.getRelativePath(i.layout,j.root),j.template=_.getRelativePath(i.template,j.root),_.def(this,"url",j,{writable:!1,configurable:!1});var k;try{k=$(d.container).length?d.container:_.docBody}catch(a){k=_.docBody}_.def(this,"container",k,{writable:!1}),_.def(this,"rootContext",this,{writable:!1,configurable:!1}),_.def(Layout,"CONTEXT",this.rootContext,{writable:!1,configurable:!1}),_.def(View,"CONTEXT",this.rootContext,{writable:!1,configurable:!1}),d.loading.type="page",d.loading.container=this.container,_.def(this,"__loading__",Loading(d.loading,this));var l=[];$.each(d.filter,function(a,b){var d=new Filter(b,c),e=inFilters(d,l);e<0?l.push(d):l.splice(e,1,d)}),_.def(this,"__filters__",l),_.def(this,"remote",Remote,{writable:!1,configurable:!1}),_.def(this,"mode",d.mode,{writable:!1,configurable:!1}),Ajax.config(_.extend({base:this.url.root,mode:d.mode},d.ajax)),_.def(this,"ajax",Ajax(null,this),{writable:!1,configurable:!1}),WebSocket.config(_.extend({base:this.url.root,mode:d.mode},d.websocket)),_.def(this,"ws",WebSocket(null,this),{writable:!1,configurable:!1});var m,n,o=d.cache;if(_.isUndef(o)?(m=d.template,n=d.styleLoader):(m=_.extend({cache:o},d.template),n=_.extend({cache:o},d.styleLoader)),_.notNull(m)&&Template.config(m),_.notNull(n)&&StyleLoader.config(n),_.def(this,"template",Template(null,this),{writable:!1,configurable:!1}),_.def(this,"__render_file__",null,{configurable:!0}),_.def(this,"styleLoader",StyleLoader(null,this),{writable:!1,configurable:!1}),_.notNull(d.cookie)&&_.isObject(d.cookie)){var p,q=_.extend({},Cookie.prototype);for(b in d.cookie)p=d.cookie[b],_.__hasOwn.call(Cookie.DEFAULTS,b)?Cookie.config(b,p):_.__hasProto.call(q,b)||(Cookie.prototype[b]=p),p=_.__undef__}_.def(this,"cookie",Cookie(null,this),{writable:!1,configurable:!1}),_.notNull(d.Widget)&&_.isObject(d.Widget)&&(View.config(d.Widget),Layout.config(d.Widget)),_.notNull(d.View)&&_.isObject(d.View)&&View.config(d.View),_.notNull(d.Layout)&&_.isObject(d.Layout)&&Layout.config(d.Layout),_.isFunction(d.errorFilter)&&(View.config("errorFilter",d.errorFilter),Layout.config("errorFilter",d.errorFilter)),_.notNull(d.cssPrefix.include)&&(_.def(View,"PREFIX_CSS_INCLUDE",d.cssPrefix.include),_.def(Layout,"PREFIX_CSS_INCLUDE",d.cssPrefix.include)),require.config({paths:{"app/resources":this.url.resource.replace(App.REGEXP_SLASH_END,""),"app/styles":this.url.style.replace(App.REGEXP_SLASH_END,""),"app/views":this.url.view.replace(App.REGEXP_SLASH_END,""),"app/layouts":this.url.layout.replace(App.REGEXP_SLASH_END,""),"app/templates":this.url.template.replace(App.REGEXP_SLASH_END,"")}}),define(App.NAMESPACE,function(){return c});var r=App.updateState.call(this,"created");!1!==r&&this.callOption("statechange",r),this.callOption("created")},App.Creator.prototype={getInitializer:function(){return this.__initializer__},set:function(a,b){var c,d=this.__setter__;if(_.isFunction(d)&&(c=d.apply(this,arguments)),!1===c){var e=this.makeError("setter",[a]);this.addError(e),this.afterState("beforeLoad")&&App.Event.trigger("Error",e)}return this},get:View.Creator.prototype.get,getOptions:View.Creator.prototype.getOptions,callOption:View.Creator.prototype.callOption,applyOption:function(a,b){var c,d;_.isArray(b)||(b=_.isUndef(b)?[]:[b]),_.isFunction(a)?(c=a,a=c.name):c=this.get(a);var e,f={__caller_name__:a};if(_.isFunction(c))try{d=c.apply(this,b)}catch(b){e=_.setPropsRecursive(this.makeError("callback",[a,b.message],b),f),this.addError(e),d=_.__undef__}else d=c;return!_.isEmpty(e)&&this.afterState("beforeLoad")&&App.Event.trigger("Error",e),d},getFilter:function(a){var b;if(a=_.trim(a),!_.isEmpty(a))for(var c,d=0;d<this.__filters__.length;d++)if((c=this.__filters__[d])&&c.name===a){b=c;break}return b},getFilters:function(){return[].concat(this.__filters__)},getStateIndex:View.Creator.prototype.getStateIndex,inState:View.Creator.prototype.inState,beforeState:View.Creator.prototype.beforeState,afterState:View.Creator.prototype.afterState,isBeforeCreate:View.Creator.prototype.isBeforeCreate,isCreated:View.Creator.prototype.isCreated,isBeforeReady:View.Creator.prototype.isBeforeReady,isReady:View.Creator.prototype.isReady,isBeforeLoad:View.Creator.prototype.isBeforeLoad,isLoaded:View.Creator.prototype.isLoaded,isBeforeDestroy:View.Creator.prototype.isBeforeDestroy,isDestroyed:View.Creator.prototype.isDestroyed,isDispose:View.Creator.prototype.isDispose,setState:View.Creator.prototype.setState,getState:View.Creator.prototype.getState,getPath:View.Creator.prototype.getPath,getPathId:View.Creator.prototype.getPathId,getParam:View.Creator.prototype.getParam,getParams:View.Creator.prototype.getParams,setPrevState:function(a,b){var c=_.stateSetter(this.__prev_state__);return _.isFunction(c)&&c.apply(this,arguments),this},prevState:function(a){var b,c=_.stateGetter(this.__prev_state__);return _.isFunction(c)&&(b=c.apply(this,arguments)),b},prevPath:function(a){return _.getPath(a,this.prevState("path"))},prevPathId:function(a){return _.getPathId(a,this.prevState("path"))},prevParam:function(a){return _.getParam(a,this.prevParams())},prevParams:function(){return this.prevState("param")||{}},getCache:View.Creator.prototype.getCache,setCache:View.Creator.prototype.setCache,removeCache:View.Creator.prototype.removeCache,getCacheKey:function(){return""},View:function(a){return View.create(a)},Layout:function(a){return Layout.create(a)},getView:function(){return App.LAST_VIEW},go:function(){return triggerAppFn("go",_.__aslice.call(arguments)),this},back:function(){return triggerAppFn("back",_.__aslice.call(arguments)),this},forward:function(){return triggerAppFn("forward",_.__aslice.call(arguments)),this},getCookie:function(){return this.cookie.get.apply(this.cookie,arguments)},setCookie:function(){return this.cookie.set.apply(this.cookie,arguments),this},removeCookie:function(a,b){return this.cookie.remove.apply(this.cookie,arguments)},getRootUrl:function(a,b){return this.getFullUrl(a,b)},getResourceUrl:function(a,b){return this.getFullUrl(a,b,this.url.resource)},getStyleUrl:function(a,b){return this.getFullUrl(a,b,this.url.style)},getFullUrl:function(a,b,c){a=a||"",b=b||"";var d=c||this.url.root;App.REGEXP_SLASH_START.test(a)&&(a=a.replace(App.REGEXP_SLASH_START,"")),d+=a;try{b=_.isObject(b)?$.param(b):_.trim(b)}catch(a){b=""}return b&&(/\?$/.test(d)?d+=b:d.indexOf("?")>-1?d+="&"+b:d+="?"+b),d},getUrl:function(a,b){var c,d=this.__widget__;c=_.notNull(this.__render_file__)?d.trimTemplatePath(this.__render_file__):this.getPath();var e=_.toUrl(a||this.get("index"),b,c);return App.REGEXP_HASH_START.test(e)||(e="#"+e),e},helper:function(a,b){return triggerAppFn("helper",_.__aslice.call(arguments)),this},helpers:function(a){return triggerAppFn("helpers",_.__aslice.call(arguments)),this},bind:function(){return triggerAppFn("bind",_.__aslice.call(arguments)),this},on:function(){return triggerAppFn("on",_.__aslice.call(arguments)),this},one:function(){return triggerAppFn("one",_.__aslice.call(arguments)),this},unbind:function(){return triggerAppFn("unbind",_.__aslice.call(arguments)),this},off:function(){return triggerAppFn("off",_.__aslice.call(arguments)),this},trigger:function(){return triggerAppFn("trigger",_.__aslice.call(arguments)),this},makeError:View.Creator.prototype.makeError,setError:View.Creator.prototype.setError,getError:View.Creator.prototype.getError,addError:View.Creator.prototype.addError,removeError:View.Creator.prototype.removeError,includeError:View.Creator.prototype.includeError,excludeError:View.Creator.prototype.excludeError,inError:View.Creator.prototype.inError,onError:View.Creator.prototype.onError,assignError:View.Creator.prototype.assignError},_.def(App.Creator.prototype,"__const_props__",["__ns__","__widget__","__initializer__","__options__","__setter__","__getter__","__error__","__error_ns__","__error_maker__","__state_index__","__state_index_getter__","__state__","__prev_state__","__loading__","__filters__","__render_file__","url","container","rootContext","remote","mode","ajax","ws","template","cookie","json"]),App}),define("yfjs/spa/version",function(){var a="1.0.0-rc.2",b={Loading:a,Ajax:a,App:a,Cookie:a,Error:a,Event:a,Filter:a,Layout:a,Remote:a,Route:a,StyleLoader:a,Template:a,View:a,WebSocket:a,Widget:a,PathWildcardCompiler:a};return function(a){return b[a]||"0.0.0"}}),define("yfjs/spa/util/ajax",["../version","jquery","./helpers","./event","./error"],function(a,b,c,d,e){function f(a,d,e){a=this.normalizeOptions(a),c.isFunction(d)&&(e=d,d=null);var i,j,k=this,l=b.Deferred(),m={},n=0;if(c.isArray(a)){var o=[];b.each(a,function(a,b){f.call(k,b,d,function(a,b,d){o.push(a),c.isFunction(b.success)&&(m.success=m.success||[],m.success.push(b.success)),c.isFunction(b.error)&&(m.error=m.error||[],m.error.push(b.error)),c.isFunction(b.complete)&&(m.complete=m.complete||[],
m.complete.push(b.complete)),i=i||[],i.push(d),n++}),j=b.__caller_name__}),function(a,d){b.when.apply(b.when,d).done(function(){if(d.length>1){var e,f,g,h=Array.prototype.slice.call(arguments),i=[];b.each(h,function(a,b){b[0]&&(e=e||new Array(d.length),e[a]=b[0]),c.isUndef(b[1])||(f=f||new Array(d.length),f[a]=b[1]),b[2]&&(g=g||new Array(d.length),g[a]=b[2])}),i.push(e,f,g),a.resolve.apply(a.resolve,i)}else a.resolve.apply(a.resolve,arguments)})}(l,o)}else if(a){if(c.notNull(d)&&(c.otype(d)!==c.otype(a.data)?a.data=d:c.isArray(d)?a.data=d.concat(a.data):c.isObject(d)?a.data=c.extend({},a.data,d):a.data=d),h.REGEXP_JSON_TEXT.test(a.contentType)&&(a.contentType=a.contentType.replace(h.REGEXP_JSON_TEXT,"application/json"),d=a.data,c.notNull(d)&&c.isObject(d)))try{a.data=g.stringify(d)}catch(b){a.data=d}var p=a.url.lastIndexOf("?");if(p>-1)try{var q=b.parseQuery(a.url),r=a.url.substring(0,p);r+="?"+b.param(q),a.url=r}catch(a){}a.success&&(m.success=a.success,delete a.success),a.error&&(m.error=a.error,delete a.error),a.complete&&(m.complete=a.complete,delete a.complete),i=a.context||a,function(a,d,e){var f=b.ajax(e);a.__xhr__.push(f),f.then(function(b,g,h){a.clear(f),h.options=c.extend({},e),h.textStatus=g;var i=[c.__undef__,b,h];if(c.isFunction(e.respFilter))try{i=e.respFilter.apply(d,[c.__undef__,b,h]),c.isArray(i)?i[2]!==h&&(i[2]=h):i=[c.__undef__,b,h]}catch(c){i=[a.makeError("callback",["respFilter",c.message],c),b,h]}i[0]=a.normalizeError(i[0],h),l.resolve.apply(l.resolve,i)},function(b,h,i){a.clear(f),b.options=c.extend({},e),b.textStatus=h;var j;j="abort"===h?c.__undef__:b.responseText;var k=a.makeError("ajax",(b.status||500)+" / "+(i||h||"unknown")),m=a.__options__||{},n=b.options||{};if(k.message&&n.url){var o=n.url;0==o.indexOf(m.base)&&(o=o.substring(m.base.length-1)||o);var p=" - "+o;k.message.indexOf(p)!=k.message.length-p.length&&(k.message+=p)}var q=[k,j,b];if(q[0]=k=a.normalizeError(q[0],b),!c.isUndef(j)){try{j=g.parse(j)}catch(a){j=b.responseText}q[1]=j}if(c.isFunction(e.respFilter)){try{q=e.respFilter.apply(d,q),c.isArray(q)?q[2]!==b&&(q[2]=b):q=[k,j,b]}catch(c){q=[a.makeError("callback",["respFilter",c.message],c),j,b]}q[0]=a.normalizeError(q[0],b)}l.resolve.apply(l.resolve,q)})}(k,i,a),j=a.__caller_name__,n++}else l.resolve(k.normalizeError(k.makeError("param_invalid")));var s=l.promise();return c.isFunction(e)&&e.call({length:n},s,m,i,j),s}var g=c.JSON,h=function(a,b){if(!(this instanceof h))return new h(a,b);c.def(this,"__options__",c.extend(!0,{},h.DEFAULTS,a)),c.def(this,"__context__",b),c.def(this,"__xhr__",[])};return h.NAMESPACE="Ajax",h.VERSION=a(h.NAMESPACE),h.DEFAULTS={base:"/",headers:{Accept:"application/json; charset=utf-8","Content-Type":"application/json; charset=utf-8"},dataType:"json",respFilter:c.__undef__,mode:"mock",urls:{},args:c.__undef__},h.REGEXP_PROTOCOL_START=c.REGEXP_PROTOCOL_START,h.REGEXP_DSLASH_START=c.REGEXP_DSLASH_START,h.REGEXP_SLASH_START=c.REGEXP_SLASH_START,h.REGEXP_SLASH_END=c.REGEXP_SLASH_END,h.REGEXP_REST_PARAM=c.REGEXP_REST_PARAM,h.REGEXP_JSON_TEXT=/text\/json/gi,h.config=c.configurator.call(h,h.DEFAULTS),h.Event=d(h.NAMESPACE),h.Error=e(h.NAMESPACE),h.Error.translate({callback:"执行 Ajax 的 {0} 时发生了错误：{1}",param_invalid:"执行 Ajax 时发生了错误：缺少请求地址参数"}),h.prototype={setOption:c.optionSetter(h.DEFAULTS),getOption:c.optionGetter(),getOptions:c.optionsGetter(),getContext:function(){return this.__context__},send:function(a,d,e){c.isFunction(d)&&(e=d,d=null);var g=this;return f.call(this,a,d,function(a,d,f,i){i={__caller_name__:i||"ajax.send"},a.done(function(){function a(b,d,e){var f=!1;if((e=e||0)>1e3)return f;if(c.isArray(d)){e+=1;for(var g,h=0;h<d.length;h++)g=a(b,d[h],e),b=g.errs,f=f||g.bAbortErr}else c.notNull(d)&&((f="abort"===d.textStatus&&d.xhr&&!1===d.xhr.__abort_err__)||(c.setPropsRecursive(d,i),d.context&&c.isFunction(d.context.addError)&&d.context.addError.call(d.context,d),b=c.concatError(b,d)));return{errs:b,bAbortErr:f}}function j(a,b){var d=[],e=c.extend({NS:h.NAMESPACE},i);if((b=b||0)>1e3)return a;if(c.isArray(a))for(var f=0;f<a.length;f++)d=d.concat(j(a[f],b));else c.notNull(a)&&(a.context&&c.isFunction(a.context.getError)?c.inError(c.sliceError(a.context.getError(),e),a)>-1&&d.push(a):d.push(a));return d}var k=Array.prototype.slice.call(arguments),l=a([],k[0]),m=l.errs,n=l.bAbortErr,o=function(b,d){if(c.isFunction(b)){var e;if(d>-1&&k[d]&&!k[d][0])try{b.call(f[d],k[d][1],"success",k[d][2])}catch(b){e=g.normalizeError(g.makeError("callback",["success ("+d+") callback",b.message],b)),l=a(m,e),m=l.errs}else if(-1==d&&!k[0])try{b.call(f,k[1],"success",k[2])}catch(b){e=g.normalizeError(g.makeError("callback",["success callback",b.message],b)),l=a(m,e),m=l.errs}}},p=function(b,d){if(c.isFunction(b)){var e;if(d>-1&&k[d]&&k[d][0])try{b.call(f[d],k[d][2],k[d][2].statusText||"error",k[d][1])}catch(b){e=g.normalizeError(g.makeError("callback",["error ("+d+") callback",b.message],b)),l=a(m,e),m=l.errs}else if(-1==d&&k[0])try{b.call(f,k[2],k[2].statusText||"error",k[1])}catch(b){e=g.normalizeError(g.makeError("callback",["error callback",b.message],b)),l=a(m,e),m=l.errs}}},q=function(b,d){if(c.isFunction(b)){var e,h=d>-1&&k[d]&&!k[d][0],i=-1==d&&!k[0],j=d>-1&&k[d]&&k[d][0],n=-1==d&&k[0];if(h||j)try{h?b.call(f[d],k[d][1],"success",k[d][2]):b.call(f[d],k[d][2],k[d][2].statusText||"error",k[d][1])}catch(b){e=g.normalizeError(g.makeError("callback",["complete ("+d+") callback",b.message],b)),l=a(m,e),m=l.errs}else if(i||n)try{i?b.call(f,k[1],"success",k[2]):b.call(f,k[2],k[2].statusText||"error",k[1])}catch(b){e=g.normalizeError(g.makeError("callback",["complete callback",b.message],b)),l=a(m,e),m=l.errs}}};if(c.isArray(d.success)?b.each(d.success,function(a,b){o(b,a)}):o(d.success,-1),c.isArray(d.error)?b.each(d.error,function(a,b){p(b,a)}):p(d.error,-1),c.isArray(d.complete)?b.each(d.complete,function(a,b){q(b,a)}):q(d.complete,-1),!n&&c.isFunction(e))try{e.apply(g.getContext(),k),c.normalizeCallbackArgs(e,k)}catch(b){var r=g.normalizeError(g.makeError("callback",["callback",b.message],b));l=a(m,r),m=l.errs}m=j(m),c.isEmpty(m)||h.Event.trigger("Error",[m])})})},get:function(a,b,d){var e={type:"GET",__caller_name__:"ajax.get"};return c.isFunction(b)&&(d=b,b=null),this.send(this.normalizeOptions(a,e),b,d)},post:function(a,b,d){var e={type:"POST",__caller_name__:"ajax.post"};return c.isFunction(b)&&(d=b,b=null),this.send(this.normalizeOptions(a,e),b,d)},postJSON:function(a,b,d){var e={type:"POST",contentType:"text/json",__caller_name__:"ajax.postJSON"};return c.isFunction(b)&&(d=b,b=null),this.send(this.normalizeOptions(a,e),b,d)},put:function(a,b,d){var e={type:"PUT",__caller_name__:"ajax.put"};return c.isFunction(b)&&(d=b,b=null),this.send(this.normalizeOptions(a,e),b,d)},putJSON:function(a,b,d){var e={type:"PUT",contentType:"text/json",__caller_name__:"ajax.putJSON"};return c.isFunction(b)&&(d=b,b=null),this.send(this.normalizeOptions(a,e),b,d)},delete:function(a,b,d){var e={type:"DELETE",__caller_name__:"ajax.delete"};return c.isFunction(b)&&(d=b,b=null),this.send(this.normalizeOptions(a,e),b,d)},head:function(a,b,d){var e={type:"HEAD",dataType:"text",__caller_name__:"ajax.head"};return c.isFunction(b)&&(d=b,b=null),this.send(this.normalizeOptions(a,e),b,d)},normalizeOptions:function(a,d){var e=this,f=function(a,d,g,i){var j;if((i=i||0)>1e3)return j;if(g=g||0,!c.isArray(a)){if(a&&a.__normalized__)return a;if(j=e.getOptions(),c.isArray(d)&&(d=d[g]),c.isPlainObject(d)||(d={name:d?c.trim(d):c.__undef__}),c.isPlainObject(a)?c.extend(!0,j,a,d):c.extend(!0,j,{name:a?c.trim(a):c.__undef__},d),!j.url&&j.urls&&j.name&&j.mode){var k;(k=j.urls[name])&&(j.url=k[j.mode])}return delete j.urls,(j.url=c.trim(j.url||j.name),c.isEmpty(j.url))?c.__undef__:(j.args=j.args||{},j.url=j.url.replace(h.REGEXP_REST_PARAM,function(a,b){return b=c.trim(b),c.isUndef(j.args[b])?"":j.args[b]}),delete j.args,h.REGEXP_DSLASH_START.test(j.url)&&(j.url=c.LOCAL_PROTOCOL+j.url),h.REGEXP_PROTOCOL_START.test(j.url)||(j.url=j.url.replace(h.REGEXP_SLASH_START,""),j.base=j.base||"/",h.REGEXP_SLASH_END.test(j.base)||(j.base+="/"),h.REGEXP_PROTOCOL_START.test(j.base)||h.REGEXP_SLASH_START.test(j.base)||(j.base="/"+j.base),0!=j.url.indexOf(j.base)&&(j.url=j.base+j.url)),delete j.base,c.def(j,"__normalized__",!0),c.isEmpty(j.url)?c.__undef__:j)}return i+=1,b.each(a,function(a,b){(b=f(b,d,a,i))&&(j=j||[],j=j.concat(b))}),j};return f(a,d)},normalizeError:function(a,b,d){if(!a)return a;if((d=d||0)>1e3)return a;if(c.isArray(a)){d+=1;for(var e=0;e<a.length;e++)a[e]=this.normalizeError(a[e],b,d)}else c.notNull(b)&&(a.xhr=b,a.status=b.status,a.textStatus=b.textStatus),a.context=this.getContext();return a},abort:function(a,d){function e(a){return a&&c.isFunction(a.abort)}if(c.isBoolean(a)&&(d=a,a=c.__undef__),e(a))!1===d&&c.def(a,"__abort_err__",!1),a.abort(),this.clear(a);else{var f=this,g=[].concat(this.__xhr__);b.each(g,function(a,b){e(b)?f.abort(b,d):b&&f.clear(b)})}},clear:function(a){if(a){var b;(b=c.inArray(a,this.__xhr__))>-1&&this.__xhr__.splice(b,1)}else c.isUndef(a)&&this.__xhr__.splice(0,this.__xhr__.length)},makeError:function(a,b,d){var e=this.__error_maker__;return e||(c.def(this,"__error_maker__",c.errorMaker(h.Error,this.getContext())),e=this.__error_maker__),e.apply(this,arguments)}},h}),define("yfjs/spa/util/console",function(){var a=a||this||{};return void 0===a.console&&(a.console={}),void 0===a.console.emulated&&("function"==typeof a.console.log?a.console.hasLog=!0:(void 0===a.console.log&&(a.console.log=function(){}),a.console.hasLog=!1),"function"==typeof a.console.debug?a.console.hasDebug=!0:(void 0===a.console.debug&&(a.console.debug=a.console.hasLog?function(){for(var b=["console.debug:"],c=0;c<arguments.length;c++)b.push(arguments[c]);a.console.log.apply(a.console,b)}:function(){}),a.console.hasDebug=!1),"function"==typeof a.console.warn?a.console.hasWarn=!0:(void 0===a.console.warn&&(a.console.warn=a.console.hasLog?function(){for(var b=["console.warn:"],c=0;c<arguments.length;c++)b.push(arguments[c]);a.console.log.apply(a.console,b)}:function(){}),a.console.hasWarn=!1),"function"==typeof a.console.error?a.console.hasError=!0:(void 0===a.console.error&&(a.console.error=function(){var b="An error has occured.";if(a.console.hasLog){for(var c=["console.error:"],d=0;d<arguments.length;d++)c.push(arguments[d]);a.console.log.apply(a.console,c),b="An error has occured. More information is available in your browser's javascript console."}for(var d=0;d<arguments.length&&"string"==typeof arguments[d];++d)b+="\n"+arguments[d];throw"undefined"!=typeof Error?new Error(b):b}),a.console.hasError=!1),"function"==typeof a.console.trace?a.console.hasTrace=!0:(void 0===a.console.trace&&(a.console.trace=function(){a.console.error("console.trace does not exist")}),a.console.hasTrace=!1),a.console.emulated=!0),a.console}),define("yfjs/spa/util/cookie",["../version","./helpers","./error","./event"],function(a,b,c,d){var e=b.JSON,f=b.document,g=function(a,c){if(!(this instanceof g))return new g(a,c);b.def(this,"__options__",b.extend({},g.DEFAULTS,a)),b.def(this,"__context__",c)};return g.NAMESPACE="Cookie",g.VERSION=a(g.NAMESPACE),g.DEFAULTS={domain:b.LOCAL_HOST,path:"/",expires:b.__undef__,secure:!1,encode:!1},g.config=b.configurator.call(g,g.DEFAULTS),g.Error=c(g.NAMESPACE),g.Error.translate({config:"设置 cookie 时发生了错误：{0}",converter:"转换 cookie 值时发生了错误：{0}"}),g.Event=d(g.NAMESPACE),g.prototype={setOption:b.optionSetter(g.DEFAULTS),getOption:b.optionGetter(),getOptions:b.optionsGetter(),getContext:function(){return this.__context__},getAll:function(){return this.config()||{}},get:function(a,c){return b.isFunction(c)?this.config(a,c):this.config(a)},set:function(a,c,d){return b.isUndef(c)||b.isFunction(c)?this:(this.config(a,c,d),this)},remove:function(a,c){return!b.isUndef(this.get(a))&&(this.config(a,"",b.extend({},c,{expires:-1})),!b.isUndef(this.get(a)))},setDomain:function(a){return b.isEmpty(a)||this.setOption("domain",b.trim(a)),this},setPath:function(a){return b.isEmpty(a)||this.setOption("path",b.trim(a)),this},setExpires:function(a){return(b.isNumber(a)||a instanceof Date)&&this.setOption("expires",a),this},config:function(a,c,d){var e=!this.getOption("encode");if(!b.isUndef(c)&&!b.isFunction(c)){if(d=this.getOptions(d),b.isNumber(d.expires)){var h=d.expires,i=d.expires=new Date;i.setTime(+i+864e5*h)}e=!d.encode;try{return f.cookie=[this.encode(a,e),"=",this.stringifyCookieValue(c,e),d.expires instanceof Date?"; expires="+d.expires.toUTCString():"",d.path?"; path="+d.path:"",d.domain?"; domain="+d.domain:"",d.secure?"; secure":""].join("")}catch(a){return g.Event.trigger("Error",this.makeError("config",[a.message],a)),f.cookie}}a=b.trim(a);for(var j=b.isEmpty(a)?{}:b.__undef__,k=f.cookie?f.cookie.split("; "):[],l=0,m=k.length;l<m;l++){var n=k[l].split("="),o=this.decode(n.shift(),e),p=n.join("=");if(a&&a===o){j=this.read(p,c);break}a||b.isUndef(p=this.read(p))||(j[o]=p)}return j},encode:function(a,b){return b?a:encodeURIComponent(a)},decode:function(a,b){return b?a:decodeURIComponent(a)},stringifyCookieValue:function(a,c){if(b.notNull(a)&&b.isObject(a))try{a=e.stringify(a)}catch(b){a=String(a)}else a=String(a);return this.encode(a,c)},parseCookieValue:function(a,b){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));var c;try{a=this.decode(a,b),c=e.parse(a)}catch(b){c=a}return c},read:function(a,c,d){var e,f=this.parseCookieValue(a,d);if(b.isFunction(c))try{e=c.call(this.getContext()||this,f)}catch(a){g.Event.trigger("Error",this.makeError("converter",[a.message],a)),e=f}else e=f;return e},makeError:function(a,c,d){var e=this.__error_maker__;return e||(b.def(this,"__error_maker__",b.errorMaker(g.Error,this.getContext())),e=this.__error_maker__),e.apply(this,arguments)}},g}),define("yfjs/spa/util/error",["../version","jquery","./helpers"],function(a,b,c){function d(a){var b;return c.isNumber(a)?b=a==e.LEVELS.LEVEL_PAGE||a==e.LEVELS.LEVEL_APP||a==e.LEVELS.LEVEL_WIDGET||a==e.LEVELS.LEVEL_CONSOLE?a:e.LEVELS.LEVEL_CONSOLE:(a+="",b=/page$/i.test(a)?e.LEVELS.LEVEL_PAGE:/app$/i.test(a)?e.LEVELS.LEVEL_APP:/widget$/i.test(a)?e.LEVELS.LEVEL_WIDGET:e.LEVELS.LEVEL_CONSOLE),b}var e=function(a){if(!(this instanceof e))return new e(a);c.notNull(a)&&!c.isObject(a)&&(a={NS:c.trim(a)}),c.def(this,"__options__",c.extend({},e.DEFAULTS,a)),c.def(this,"__errors__",{});for(var b in e.LEVELS)c.__hasOwn.call(e.LEVELS,b)&&c.def(this,b,e.LEVELS[b],{writable:!1,configurable:!1})};e.NAMESPACE="Error",e.VERSION=a(e.NAMESPACE),e.LEVELS={LEVEL_PAGE:-3,LEVEL_APP:-2,LEVEL_WIDGET:-1,LEVEL_CONSOLE:0},e.DEFAULTS={NS:"",level:e.LEVELS.LEVEL_CONSOLE,args:c.__undef__,message:c.__undef__},e.REGEXP_REST_PARAM=c.REGEXP_REST_PARAM,e.prototype={setOption:c.optionSetter(e.DEFAULTS),getOption:c.optionGetter(),getOptions:c.optionsGetter(),make:function(a,b,d){a=c.isEmpty(a)?"unknown":c.trim(a),b=c.extend({},this.__options__,this.normalizeOption(b)),c.isUndef(b.message)&&(b.message=this.format(a,b.args)),d&&c.isUndef(b.message)&&(b.message=d.message),c.isUndef(b.message)&&(b.message=a);var e=new f(b.message);return e.type=a,e.NS=b.NS,e.level=b.level,c.notNull(d)&&(e.originalError=d,c.isUndef(d.stack)||(e.stack=d.stack)),e},normalizeOption:function(a){var b={};return c.isArray(a)?b.args=a:c.notNull(a)&&(c.isObject(a)?c.isUndef(a.level)||(a.level=d(a.level)):a={message:c.trim(a)},c.extend(b,a)),b},translate:function(a,b,d){var e=this,f=function(a,b,d){c.isString(b)&&!c.isEmpty(b)&&(e.__errors__[a]={message:b,formatter:d})};if(!c.isEmpty(a))if(c.isObject(a)){var g;for(var h in a)g=a[h],c.notNull(g)&&c.isObject(g)?f(h,g.message,g.formatter):f(h,g)}else a=c.trim(a),f(a,b,d)},format:function(a,b){if(c.isEmpty(a))return"";a=c.trim(a);var d,f=this.__errors__[a];if(f){if(!c.isEmpty(b))if(c.isFunction(f.formatter))try{d=f.formatter.call(f.formatter,f.message,b)}catch(a){d=c.__undef__}else c.isString(f.message)&&!c.isEmpty(f.message)&&(d=f.message.replace(e.REGEXP_REST_PARAM,function(a,d){return d=c.trim(d),c.isUndef(b[d])?"":b[d]}));c.isUndef(d)&&c.notNull(f.message)&&(d=c.trim(f.message))}return d}};var f=c.window.Error||function(a){this.message=c.notNull(a)?c.trim(a):""};return e}),define("yfjs/spa/util/event",["../version","jquery","./helpers","./console"],function(a,b,c,d){function e(a){return c.isEmpty(a)?/\s*/:new RegExp("\\."+a+"$")}function f(a,b){a=a||{},b=c.trim(b);var d=c.trim(a.selector);return b.length?d.length&&0==b.indexOf(d)&&(b=c.trim(b.substring(d.length))):b=d,b}function g(a){return/\.App\.G$/.test(a)}var h=function(a){if(!(this instanceof h))return new h(a);c.notNull(a)&&!c.isObject(a)&&(a={NS:c.trim(a)}),c.def(this,"__options__",c.extend({},h.DEFAULTS,a))};return h.NAMESPACE="Event",h.VERSION=a(h.NAMESPACE),h.DEFAULTS={NS:""},h.prototype={setOption:c.optionSetter(h.DEFAULTS),getOption:c.optionGetter(),getOptions:c.optionsGetter(),bind:function(a,i,j,k,l){if(c.notNull(a)&&c.isObject(a)){c.validElement(i)||(j=j||i,i=c.__undef__);for(var m in a)this.bind(m,i,j,a[m],l);return this}var n=h.normalizeBindArgs.apply(this,arguments);if(!n)return this;a=n[0],i=n[1],j=n[2],k=n[3];var o=this,p=o.getOption("NS"),q=e(p),r=function(a,e,h,i,j){if(!c.isEmpty(a)){g(a)||q.test(a)||(a+="."+p);var k=function(a){var e,f;try{e=c.__aslice.call(a.handleObj.handler.arguments),f=a.handleObj.handler.delegateHandler}catch(b){e=a?[a]:[],f=null}try{if(c.isFunction(f)&&(!f.delegateTarget||a.delegateTarget===c.window||f.delegateTarget===a.delegateTarget||b.contains(f.delegateTarget,a.delegateTarget)))return f.context&&c.isFunction(f.context.applyOption)?f.context.applyOption.call(f.context,f,e):f.apply(f.context||this,e)}catch(a){d.error(a)}};i.delegateCallback=k,k.delegateHandler=i;try{if(c.isString(e))b(c.document).on(a,e,h,k,j);else{var l=f(e);e.prevObject&&e.prevObject.length?(e=e.prevObject,l=f(e,l)):l="";var m=c.is$(e)?e:b(e);l.length?m.on(a,l,h,k,j):m.on(a,c.__undef__,h,k,j)}}catch(a){}}},s=c.unique(a.split(/\s+/));return b.each(s,function(a,b){r(b,i,j,k,l)}),this},on:function(){return this.bind.apply(this,arguments)},one:function(a,b,c,d){return this.bind(a,b,c,d,1)},unbind:function(a,d,i){if(c.notNull(a)&&c.isObject(a)){for(var j in a)this.unbind(j,d,a[j]);return this}var k=h.normalizeUnBindArgs.apply(h,arguments);a=k[0],d=k[1],i=k[2];var l=this,m=l.getOption("NS"),n=e(m),o=function(a,d,e){if(!c.isEmpty(a)){g(a)||n.test(a)||(a+="."+m);var h;e&&(h=e.delegateCallback||e);try{if(c.isString(d))b(c.document).off(a,d,e);else{var i=f(d);d.prevObject&&d.prevObject.length?(d=d.prevObject,i=f(d,i)):i="";var j=c.is$(d)?d:b(d);i.length?j.off(a,i,h):j.off(a,h)}}catch(a){}}},p=c.unique(a.split(/\s+/));return b.each(p,function(a,b){o(b,d,i)}),this},off:function(){return this.unbind.apply(this,arguments)},trigger:function(a,d,f){var i=h.normalizeTriggerArgs.apply(h,arguments);a=i[0],d=i[1],f=i[2];var j=this.getOption("NS"),k=e(j),l=function(a){if(!c.isEmpty(a)){g(a)||k.test(a)||(a+="."+j);try{(c.is$(f)?f:b(f)).trigger(a,d)}catch(a){}}},m=c.unique(a.split(/\s+/));return b.each(m,function(a,b){l(b,d)}),this}},h.normalizeBindArgs=function(a,b,d,e,f){var g;if(a=c.trim(a),c.validElement(b)?c.isFunction(d)&&(e=d,d=null):(c.isFunction(b)?(e=b,d=null):(c.isFunction(d)&&(e=d,d=null),null==d&&(d=b)),b=c.document),!1===e)e=c.returnFalse;else if(!e)return g;return a=a.replace(/viewchange(?!\.App\.G)/i,"viewchange.App.G"),c.isString(b)&&(/^window$/i.test(b)?b=c.window:/^document$/i.test(b)&&(b=c.document)),f=1===arguments[arguments.length-1]?1:c.__undef__,g=[a,b,d,e,f]},h.normalizeUnBindArgs=function(a,b,d){return a=c.trim(a),(!1===b||c.isFunction(b))&&(d=b,b=c.document),c.isString(b)&&(/^window$/i.test(b)?b=c.window:/^document$/i.test(b)&&(b=c.document)),!1===d&&(d=c.returnFalse),a=a.replace(/viewchange(?!\.App\.G)/i,"viewchange.App.G"),c.isString(b)&&(/^window$/i.test(b)?b=c.window:/^document$/i.test(b)&&(b=c.document)),[a,b,d]},h.normalizeTriggerArgs=function(a,b,d){return a=c.trim(a),c.validElement(b)&&(d=b,b=c.__undef__),c.validElement(d)||(d=c.document),a=a.replace(/viewchange(?!\.App\.G)/i,"viewchange.App.G"),c.isString(d)&&(/^window$/i.test(d)?d=c.window:/^document$/i.test(d)&&(d=c.document)),[a,b,d]},h}),define("yfjs/spa/util/filter",["../version","./helpers","./path-wildcard-compiler","./error","./event"],function(a,b,c,d,e){var f=function(a,d){if(!(this instanceof f))return new f(a,d);b.notNull(a)&&!b.isObject(a)&&(a={name:b.trim(a)}),b.def(this,"__options__",b.extend({},f.DEFAULTS,a)),this.setOption("name",b.trim(this.getOption("name"))),b.isFunction(this.getOption("access"))||this.setOption("access",f.DEFAULTS.access),b.isFunction(this.getOption("do"))||this.setOption("do",f.DEFAULTS.do),b.def(this,"id",b.increaseId(f.ID),{writable:!1,configurable:!1}),b.def(this,"__context__",d);var e=this.getOption("name");b.isEmpty(e)&&(e=f.NAMESPACE.toLowerCase()+"-"+this.id),b.def(this,"name",e,{writable:!1,configurable:!1});var g,h,i,j=b.normalizeArrOption(this.getOption("includes"));for(g=0;g<j.length;g++)(h=j[g])instanceof RegExp||(i=c.compilePathName(h))&&(j[g]=i);b.def(this,"includes",j,{writable:!1,configurable:!1});var k=b.normalizeArrOption(this.getOption("excludes"));for(g=0;g<k.length;g++)(h=k[g])instanceof RegExp||(i=c.compilePathName(h))&&(k[g]=i);b.def(this,"excludes",k,{writable:!1,configurable:!1})};return f.NAMESPACE="Filter",f.VERSION=a(f.NAMESPACE),f.DEFAULTS={name:"",access:b.returnTrue,do:b.noop,includes:[],excludes:[]},f.Event=e(f.NAMESPACE),f.Error=d(f.NAMESPACE),f.Error.translate({callback:"执行过滤器 {0} 的 {1} 操作时发生了错误: {2}"}),f.ID=0,f.prototype={setOption:b.optionSetter(f.DEFAULTS),getOption:b.optionGetter(),getOptions:b.optionsGetter(),getContext:function(){return this.__context__},doFilter:function(a){if(this.exclude(a))return!0;var c,d=this.__options__||{},e=!0;if(b.isFunction(d.access))try{e=d.access.call(this.getContext()||this,a,this)}catch(a){c=this.makeError("callback",[this.name,"access",a.message],a)}if(c)return f.Event.trigger("Error",c),!1;if(!e&&b.isFunction(d.do))try{d.do.call(this.getContext()||this,a,this)}catch(a){c=this.makeError("callback",[this.name,"do",a.message],a)}return c?(f.Event.trigger("Error",c),!1):e},include:function(a){var c=!1;if(!b.notNull(a))return c;var d,e,f=!1;for(d=0;d<this.excludes.length;d++)if((e=this.excludes[d])instanceof RegExp&&e.test(a)||e===a){f=!0,c=!1;break}if(!f)for(d=0;d<this.includes.length;d++)if((e=this.includes[d])instanceof RegExp&&e.test(a)||e===a){c=!0;break}return c},exclude:function(a){var c=!0;return b.notNull(a)?!(c=this.include(a)):c},makeError:function(a,c,d){var e,g=this.__error_maker__;return g||(b.def(this,"__error_maker__",b.errorMaker(f.Error,this.getContext())),g=this.__error_maker__),e=g.apply(this,arguments),e.level=f.Error.LEVEL_PAGE,e}},f.pathMatch=function(a,d){if(!b.notNull(a))return null;a=b.trim(a);var e;return d instanceof RegExp?e=d:(d+="",e=c.compilePathName(d)),b.notNull(e)?a.match(e):null},f.pathMatches=function(a,d){if(!b.notNull(a))return!1;a=b.trim(a);var e;return d instanceof RegExp?e=d:(d+="",(e=c.compilePathName(d))||(e=d)),e instanceof RegExp?e.test(a):e===a},f}),define("yfjs/spa/util/helpers",function(a){var b=["jquery"];return void 0!==a.JSON&&define("json",function(){return a.JSON}),b.push("json"),Object.defineProperty||b.push("es5-shim"),b}(this),function(a,b){function c(a){a=_.trim(a).toUpperCase();var b=/^BEFORE(?!_)/;return b.test(a)&&(a=a.replace(b,"BEFORE_")),a}function d(b){var c;if(_.isArray(b)){c=[];for(var e=0;e<b.length;e++)c[e]=d(b[e])}else c=_.isPlainObject(b)?a.extend(!0,{},b):b;return c}var e=e||this||{},f=f||e.document||{};!f.location&&(f.location={});var g,h=f.location.protocol||"",i=f.location.hostname||f.location.host||"",j=null==f.location.port?"":f.location.port+"",k=function(){var a=":"+j,b=i.indexOf(a);return b==i.length-a.length&&(i=i.substring(0,b)),j.length?i+a:i}(),l=function(){var a=h+"//"+k;return"//"===a&&(a=""),a+="/"}(),m=/^((?:(?:https?|s?ftp):)|(?:file:\/))\/\//,n=/((?:(?:https?|s?ftp):)|(?:file:\/))\/\//g,o=/^((?:https|sftp):)\/\//,p=/^(wss?:)\/\//,q=/^\/\/(?!\/)/,r=/:(\d+)$/,s=/^\/+/,t=/\/+$/,u=/^#/,v=/^#\//,w=/^\/#/,x=/^\.+\//,y=/url\s*\(([^\)]+)\)/g,z=/^('|")/,A=/('|")$/,B=/\{([^\}]+)\}/g,C=/function\s*\(([^\)]*)\)/,D=Object.prototype,E=Array.prototype,F=String.prototype,G=D.hasOwnProperty,H=(D.isPrototypeOf,function(){var a;try{a=G.apply(this.prototype,arguments)}catch(b){a=!1}return a}),I=D.toString,J=E.slice,K=E.splice,L=function(a){return I.call(a).slice(8,-1).toLowerCase()},M=function(a){return"function"!=typeof F.trim||F.trim.call("\ufeff ")?null==a?"":(a+"").replace(/(^\s*)|(\s*$)/g,""):null==a?"":F.trim.call(a)},N=function(a){return"function"!=typeof F.trimLeft||F.trim.call("\ufeff ")?null==a?"":(a+"").replace(/(^\s*)/g,""):null==a?"":F.trimLeft.call(a)},O=function(a){return"function"!=typeof F.trimRight||F.trim.call("\ufeff ")?null==a?"":(a+"").replace(/(\s*$)/g,""):null==a?"":F.trimRight.call(a)},P=function(a){a=M(a);var b;try{b=M(require.toUrl(a)),s.test(b)&&(b=l+b.replace(s,""));var c=b.indexOf("?");c>-1&&(b=b.substring(0,c))}catch(c){b=a}return b},Q=function(a){a=M(a);var b,c=a.match(m);return null!=c&&(b=c[1]),b||""},R=function(a){a=M(a);var b;if(m.test(a)?b=a.replace(m,""):q.test(a)&&(b=a.replace(q,"")),null!=b){b=b.replace(s,"");var c=b.indexOf("/");c>-1&&(b=b.substring(0,c)),b=b.toLowerCase()}return b||""},S=function(b){return b&&b instanceof a},T=function(a){var b=L(a);return"window"===b||"global"===b||a===e||"htmldocument"===b||a===f||/^html(\w+)element$/.test(L(a))},U=function(){return a.inArray.apply(a,arguments)},V=function(b,c,d,e){if(null==b)try{b=Object.create(null)}catch(a){b={}}if(c=M(c+""),c.length<=0)return b;try{var f;f=/^__(.+)__$/.test(c)?{enumerable:!1,writable:!1,configurable:!1}:{enumerable:!0,writable:!0,configurable:!0},e="object"!=typeof e?{value:d}:a.extend({},e,{value:d}),b&&void 0!==b[c]||(e=a.extend({},f,e)),Object.defineProperty(b,c,e)}catch(a){null!=b&&(b[c]=d)}return b},W=function(a){return!(!a||"object"!=typeof a)&&("function"==typeof a.resolve&&"function"==typeof a.reject&&"function"==typeof a.done&&"function"==typeof a.fail&&"function"==typeof a.then&&"function"==typeof a.always&&"function"==typeof a.promise)},X=function(a){return!(!a||"object"!=typeof a)&&("function"==typeof a.done&&"function"==typeof a.fail&&"function"==typeof a.then&&"function"==typeof a.always)},Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-".split(""),Z=function(a){var b="";if(!a||!a.length)return b;var c=a.length-1;if(isNaN(c))return b;var d=5381;if("string"==typeof a)for(;c>-1;c--)d+=(d<<5)+a.charCodeAt(c);else for(;c>-1;c--)d+=(d<<5)+a[c];var e=2147483647&d;do{b+=Y[63&e]}while(e>>=6);return b},$=function(a,b,c){function d(a){return"array"!==L(a)?void 0===a?[]:[a]:a}function e(a){return"number"==typeof a&&a||(a=1e3/60),a<0&&(a=0),a}return"function"!=typeof a?this:(arguments.length<3&&"number"==typeof b&&(c=b),b=d(b),c=e(c),function(a,b,c,d){setTimeout(function(){"function"==typeof b&&b.apply(a,c)},d)}(this,a,b,c),this)},_={__undef__:g,__op__:D,__ap__:E,__hasOwn:G,__hasProto:H,__ostring:I,__aslice:J,__asplice:K,JSON:b,def:V,setPropsRecursive:function(a,b,c,d){if(_.isBoolean(a)||(d=c,c=b,b=a,a=!0),null!=b&&null!=c){var e=function(b){if("array"===L(b))for(var f=0;f<b.length;f++)b[f]=e(b[f]);else if("object"==typeof c)for(var g in c)(_.isUndef(b[g])||a)&&(b=V(b,g,c[g],d));return b};b=e(b)}return b},encodeIdFromURI:function(a){var b=M(a);if(b){try{b=encodeURI(b)}catch(a){}b=b.replace(s,"").replace(t,"").replace(/\/+/g,"—").replace(/\.+/g,"&sdot;")}return b},decodeIdToPath:function(a){var b=M(a);if(b){b=b.replace(/&sdot;/g,".").replace(/—/g,"/"),b="/"+b;try{b=decodeURI(b)}catch(a){}}return b},stylePathId:function(a){return a=M(a).replace(/—/g,"-")},configurator:function(b){return b=b||{},function(c,d){return null!=c&&("object"==typeof c?a.extend(!0,b,c):"number"==typeof c?isNaN(c)||(b[c]=d):(c=M(c),c.length>0&&(b[c]=d))),this}},setter:function(b,c){return!b&&(b={}),!c&&(c={}),function(d,e){var f=this,g=!0;if(!f&&(f={}),!f.__options__&&_.def(f,"__options__",{}),!f.__const_props__&&_.def(f,"__const_props__",[]),d=M(d),d.length>0)if(G.call(b,d))_.isUndef(e)?delete f.__options__[d]:V(f.__options__,d,e);else if(!H.call(c,d)&&U(d,f.__const_props__)<0){G.call(f.__options__,d)&&delete f.__options__[d];var h=function(b,c,d){if(!((d=d||0)>1e3)){if(a.isPlainObject(c)){V(this,b,c);for(var e in c)G.call(c,e)&&V(this,b,h.call(c,e,c[e],d+1))}else{if(a.isFunction(c)){c=function(){var a=this.context,b=this.caller,c=J.call(arguments);return a.applyOption(b,c)}.bind({context:f,caller:c}),c.name=b}V(this,b,c)}return this}};h.call(f,d,e)}else g=!1;return g}},getter:function(a,b){return!a&&(a={}),!b&&(b={}),function(c){var d=this;return!d&&(d={}),!d.__options__&&_.def(d,"__options__",{}),!d.__const_props__&&_.def(d,"__const_props__",[]),c=M(c),c.length>0?G.call(a,c)?d.__options__[c]:!H.call(b,c)&&U(c,d.__const_props__)<0?d[c]:g:g}},optionSetter:function(a){return a=a||{},function(b,c){return b=M(b),b.length>0&&G.call(a,b)&&this&&this.__options__&&V(this.__options__,b,c),this}},optionGetter:function(){return function(a){var b;return a=_.trim(a),a.length>0&&this&&this.__options__&&(b=this.__options__[a]),b}},optionsGetter:function(){return function(b){return this&&this.__options__?a.extend(!0,{},this.__options__,b):a.extend(!0,{},b)}},stateUpdater:function(a,b){return a=a||{},b=b||{},function(d){d=c(d);var e,f=this||{},g=!1,h=b[d];return null!=h&&(g=h!==f.__state_index__&&(null!=f.__state__?_.extend(!0,{},f.__state__):null),_.def(f,"__state_index__",h),null!=(e=a[h])&&_.def(f.__state__,"label",e)),g}},stateIndexGetter:function(a,b){return a=a||{},b=b||{},function(c){var d;if(_.notNull(c)){if(c=_.trim(c),!_.isEmpty(c)){var e=a[c];_.isUndef(e)&&(e=c),e=_.normalizeStateLabel(e),d=b[e]}}else d=this.__state_index__;return d}},normalizeStateLabel:c,stateSetter:function(a,b){return b=b||{},function(c,d){if(a&&_.notNull(c))if(_.isObject(c))for(var e in c)_.isUndef(b[e])&&(a[e]=c[e]);else c=_.trim(c),c.length>0&&_.isUndef(b[c])&&(a[c]=d);return this}},stateGetter:function(a){return function(b){var c;return a&&(_.isUndef(b)?c=a:(b=_.trim(b),b.length>0&&(c=a[b])),c=d(c)),c}},stateReplacement:function(a,b,c){var d=this||{};a=a||"__state__",b=b||{},V(d,a,{},c),V(d[a],"__normalized__",!0),b.__reload_page__&&V(d[a],"__reload_page__",!0);for(var e in b)_.def(d[a],e,b[e],{writable:!1,configurable:"label"===e});return this},errorMaker:function(a,b){return function(c,d,e){b=b||this,d=a.normalizeOption(d),d.level=a["LEVEL_"+b.__error_ns__];var f=a.make(c,d,e);return f.context=b,f}},getRelativePath:function(a,b,c){if(a=M(a)||M(b)||"/","boolean"!=typeof c&&(c=!0),q.test(a)&&(a=h+a),!m.test(a)){if(c&&!s.test(a)){var d=P();t.test(d)||(d+="/"),a=d+a}!m.test(a)&&b&&(a=a.replace(s,""),t.test(b)||(b+="/"),a=b+a)}return t.test(a)||(a+="/"),a},getRequireUrl:P,validElement:function(a){return null!=a&&("string"==typeof a||S(a)||T(a))},returnFalse:function(){return!1},returnTrue:function(){return!0},increaseId:function(a){a=M(a);var b="-",c=a.lastIndexOf(b);return c>-1&&(a=a.substring(c+1)),a=(parseInt(a)||0)+1,a>Number.MAX_SAFE_INTEGER&&(a=a+b+1),M(a)},normalizeArrOption:function(a){return"array"!==L(a)&&(a=null!=a?[a]:[]),a},html2str:function(b){if(S(b)){var c="";b.each(function(){var b=a(this);c+=b.prop("outerHTML")||b.text()||""}),b=c}return M(b)},replaceMainBody:function(a,b,c){if(null==a||null==b)return"";if(b=M(b),!b.length||null==c)return a;a+="",c+="";try{a=a.replace(new RegExp("\\{\\{\\{"+b+"\\}\\}\\}","g"),c)}catch(e){b="{{{ "+b+"}}}";for(var d;(d=a.indexOf(b))>-1;)a=a.substring(0,d)+c+a.substring(d+b.length)}return a},disposeDeferred:function(a,b){var c=function(a,d){if((d=d||0)>1e3)return a;if(null!=a&&null!=a.__deferred__){if(a=c(a.__deferred__,d+1),"array"===L(a.__deferred__)){d+=1;for(var e=0;e<a.__deferred__.length;e++)a.__deferred__[e]=c(a.__deferred__[e],d),W(a.__deferred__[e])&&!1!==b&&a.__deferred__[e].reject()}else W(a.__deferred__)&&(!1!==b?(a.__deferred__.reject(),
V(a.__deferred__,"__rejected__",!0,{configurable:!0})):delete a.__deferred__.__rejected__);delete a.__deferred__}return a};return c(a)},assignDeferred:function(a,b){if(null!=a){var c={writable:!1,enumerable:!1,configurable:!0};if(_.isArray(b)){V(a,"__deferred__",[],c);for(var d=0;d<b.length;d++)W(b[d])&&a.__deferred__.push(b[d])}else W(b)&&V(a,"__deferred__",b,c)}return a},copyValue:d,requestAnimationFrame:$,REGEXP_PROTOCOL_START:m,REGEXP_SECURE_PROTOCOL_START:o,REGEXP_PROTOCOL_WS_START:p,REGEXP_PORT_END:r,REGEXP_DSLASH_START:q,REGEXP_SLASH_START:s,REGEXP_SLASH_END:t,REGEXP_HASH_START:u,REGEXP_HASH_PATH_START:v,REGEXP_PATH_HASH_START:w,REGEXP_RELATIVE_START:x,REGEXP_URL_IMPORT:y,REGEXP_QUOTA_START:z,REGEXP_QUOTA_END:A,REGEXP_REST_PARAM:B,REGEXP_FUNCTION:C};_.Exports={window:e,document:f,docRoot:f.documentElement||{},docBody:f.body||{},LOCAL_PROTOCOL:h,LOCAL_HOST:i,LOCAL_PORT:j,LOCAL_DOMAIN:k,LOCAL_ROOT:l,trim:M,trimLeft:N,trimRight:O,otype:L,is$:S,isDom:T,isDeferred:W,isPromise:X,isUndef:function(a){return void 0===a},eqNull:function(a){return null===a},isNull:function(a){return null==a},notNull:function(a){return null!=a},isNumber:function(a){return"number"==typeof a},isBoolean:function(a){return"boolean"==typeof a},isString:function(a){return"string"==typeof a},isObject:function(a){return"object"==typeof a},isPlainObject:function(b){return a.isPlainObject(b)},isArray:function(a){return"array"===L(a)},isFunction:function(a){return"function"==typeof a},isEmpty:function(a){if(null==a)return!0;if("object"!=typeof a)return M(a).length<=0;if("array"===L(a))return a.length<=0;var b;for(b in a)return!1;return!0},unique:function(b){return"array"===L(b)?a.unique(b):b},inArray:U,getProtocol:Q,getHost:function(a){var b=R(a);return r.test(b)&&(b=b.replace(r,"")),b},getPort:function(a){var b=R(a),c=b.match(r);return b=null==c?"":c[1]},getDomain:R,extend:a.extend,hash:Z,timestamp:function(){return(new Date).getTime()},noop:function(){},Extends:function(a,b,c){function d(){this.constructor=a}c=c||{};for(var e in b)G.call(c,e)?a[e]=c[e]:G.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b,a}};for(var aa in _.Exports)G.call(_.Exports,aa)&&(_[aa]=_.Exports[aa]);return _.toUrl=function(b,c,d){b=_.trim(b),d=_.trim(d),_.isEmpty(b)&&(b=d,d=""),0==b.indexOf("+/")?(d.length&&!t.test(d)&&(d+="/"),b=b.substring(2)):0==b.indexOf("+/")&&(b=b.substring(1)),d.length&&(d=d.split("/"),d.pop(),d=d.join("/"));var e=b,f=e.indexOf("?"),g="";f>-1&&(g=e.substring(f+1),e=e.substring(0,f)),q.test(e)&&(e=_.LOCAL_PROTOCOL+e),m.test(e)||s.test(e)||(e=d+"/"+e),e=_.normalizeUrl(e),e=e.replace(/\/\.\//g,"/");for(var h,i,j,k=/\/\.{2,}\//g;null!=(j=k.exec(e));)h=e.substring(0,j.index),h=h.split("/"),h.pop(),h=h.join("/"),i=e.substring(k.lastIndex),k.lastIndex=h.length,e=h+(i.length?"/"+i:"");if(e=e.replace(u,""),_.isEmpty(c))c="";else if(_.isObject(c))try{c=a.param(c)}catch(a){c=""}else c=_.trim(c);return g&&c?c=[g,c].join("&"):g&&(c=g),c&&(e=e+"?"+c),_.isEmpty(e)&&(e="/"),e},_.getPath=function(a,b){return a=_.toUrl(a,null,b)},_.getPathId=function(a,b){return a=_.getPath(a,b),_.encodeIdFromURI(a)},_.normalizeUrl=function(a){function b(a){return(a+"").replace(/\/{2,}/g,"/")}if(a=_.trim(a),a.length){var c=n.exec(a);if(null!=c){var d,e=[],f=[];do{e.push(c[0]),f.length>1&&(d=f[f.length-1],f[f.length-1]=d.substring(0,c.index)),a=a.substring(n.lastIndex),f.push(a)}while(null!=(c=n.exec(a)));for(var g=0;g<f.length;g++)f[g]=e[g]+b(f[g]);a=f.join("")}else a=b(a)}return a},_.getParam=function(a,b){return b=b||{},b[a]},_.concatError=function(b,c){b=_.sliceError(b),c=_.__aslice.call(arguments,1),c=_.sliceError(c);var d=function(c,e){if((e=e||0)>1e3)return b;if(_.isArray(c))e+=1,a.each(c,function(a,b){d(b,e)});else{var f=_.inError(b,c);f<0?b.push(c):b.splice(f,1,c)}return b};return d(c)},_.sliceError=function(b,c){_.isNull(b)?b=[]:_.isArray(b)||(b=[b]);var d=function(b,c,e){var f=[];if((e=e||0)>1e3)return f;if(_.isArray(b))e+=1,a.each(b,function(a,b){f=f.concat(d(b,c,e))});else if(_.notNull(b))if(_.isEmpty(c))f.push(b);else{var g,h,i=/^!/;for(var j in c)if(h=i.test(j),h&&(j=(j+"").replace(i,"")),g=c[j]instanceof RegExp?c[j].test(b[j]):c[j]===b[j],h&&(g=!g),!g)break;g&&f.push(b)}return f};return d(b,c)},_.shiftError=function(b,c){b=_.sliceError(b),c=_.__aslice.call(arguments,1),c=_.sliceError(c);var d=function(c,e){var f=-1;return(e=e||0)>1e3?b:(_.isArray(c)?(e+=1,a.each(c,function(a,b){d(b,e)})):(f=_.inError(b,c))>-1&&b.splice(f,1),b)};return d(c)},_.includeError=function(b,c,d){b=_.sliceError(b),_.isBoolean(c)?d=_.__aslice.call(arguments,2):(d=_.__aslice.call(arguments,1),c=!1),d=_.sliceError(d);var e=function(d,f){var g=[],h=-1;return(f=f||0)>1e3?g:(_.isArray(d)?(f+=1,a.each(d,function(a,b){g=g.concat(e(b,f))})):(h=_.inError(b,d))>-1&&(c?g.push(b.splice(h,1)[0]):g.push(b[h])),g)};return e(d)},_.excludeError=function(b,c,d){b=_.sliceError(b),_.isBoolean(c)?d=_.__aslice.call(arguments,2):(d=_.__aslice.call(arguments,1),c=!1),d=_.sliceError(d);var e=function(d,f){var g=[],h=-1;return(f=f||0)>1e3?g:(_.isArray(d)?(f+=1,a.each(d,function(a,b){g=g.concat(e(b,f))})):-1==(h=_.inError(b,d))?g.push(d):c&&b.splice(h,1),g)};return e(d)},_.inError=function(b,c){b=_.sliceError(b),c=_.__aslice.call(arguments,1),c=_.sliceError(c);var d=function(c,e){var f=-1,g=f;return(e=e||0)>1e3?g:(_.isArray(c)?(e+=1,a.each(c,function(a,b){if((f=d(b,e))<0)return!1;g<0&&(g=f)})):_.notNull(c)&&(g=f=_.inArray(c,b)),g)};return d(c)},_.matchFn=function(a){var b=null;if(_.isFunction(a)){var c=_.trim(a+""),d=c.match(C);if(null!=d){b=[];var e=_.trim(d[1]);e=e.split(/\s*,\s*/),b=b.concat(e);var f=c.indexOf("{"),g=c.lastIndexOf("}"),h=c.substring(f+1,g);b.push(_.trim(h))}}return b},_.normalizeCallbackArgs=function(b,c){var d;try{d=J.call(c)}catch(a){d=[].concat(c)}var e,f,g=d.shift(),h=function(a){var b;if(a&&a.context)try{b=a.context.inError(a)<0}catch(a){b=!1}else b=!1;return b},i=function(a){return!(!a||_.isUndef(a.__err_handler__))};if(_.notNull(g)){if(_.isArray(g))for(var j=0;j<g.length&&(e=h(g[j]),f=i(g[j]),!e&&!f);j++);else e=h(g),f=i(g);var k;if(!e&&!f&&null!=(k=_.matchFn(b))){var l=k[0],m=k[k.length-1];if(_.notNull(l)&&_.notNull(m))try{l=_.trim(l),m=_.trim(m);var n=m.replace(/\/\/[^\n]+/g,"").replace(/'[^']+'/g,"").replace(/"[^"]+"/g,"").replace(/[\w\$@]+\s*=/g,"").replace(/[\w\$@]+\s*:/g,""),o="";a.each(n.split(/\/\*/),function(a,b){b=b.split(/\*\//),1===b.length?o+=b[0]:o+=b[1]}),n=o;var p,q=new RegExp("\\b"+l+"\\b"),r=/\$|@/,s=!1;null==(p=q.exec(n))||r.test(n.charAt(p.index-1))||r.test(n.charAt(p.index+l.length))||(s=!0),s&&(g=_.setPropsRecursive(!1,g,{__err_handler__:!0},{configurable:!0}))}catch(a){}}}return d.unshift(g),d},_}),define("yfjs/spa/util/history",function(a){var b=[];return void 0!==a.JSON&&define("json",function(){return a.JSON}),b.push("json"),b}(this),function(a){var b,c=this;return function(a,c){"use strict";if(b=a.History=a.History||{},void 0!==b.Adapter)throw new Error("History.js Adapter has already been loaded...");b.Adapter={handlers:{},_uid:1,uid:function(a){return a._uid||(a._uid=b.Adapter._uid++)},bind:function(a,c,d){var e=b.Adapter.uid(a);b.Adapter.handlers[e]=b.Adapter.handlers[e]||{},b.Adapter.handlers[e][c]=b.Adapter.handlers[e][c]||[],b.Adapter.handlers[e][c].push(d),a["on"+c]=function(a,c){return function(d){b.Adapter.trigger(a,c,d)}}(a,c)},trigger:function(a,c,d){d=d||{};var e,f,g=b.Adapter.uid(a);for(b.Adapter.handlers[g]=b.Adapter.handlers[g]||{},b.Adapter.handlers[g][c]=b.Adapter.handlers[g][c]||[],e=0,f=b.Adapter.handlers[g][c].length;e<f;++e)b.Adapter.handlers[g][c][e].apply(this,[d])},extractEventData:function(a,b){return b&&b[a]||c},onDomLoad:function(b){var c=a.setTimeout(function(){b()},2e3);a.onload=function(){clearTimeout(c),b()}}}}(c),function(a,c){"use strict";var d=a.document,e=a.setTimeout||e,f=a.clearTimeout||f,g=a.setInterval||g;if(b=a.History=a.History||{},void 0!==b.initHtml4)throw new Error("History.js HTML4 Support has already been loaded...");b.initHtml4=function(){if(void 0!==b.initHtml4.initialized)return!1;b.initHtml4.initialized=!0,b.enabled=!0,b.savedHashes=[],b.isLastHash=function(a){var c=b.getHashByIndex();return a===c},b.isHashEqual=function(a,b){return a=encodeURIComponent(a).replace(/%25/g,"%"),b=encodeURIComponent(b).replace(/%25/g,"%"),a===b},b.saveHash=function(a){return!b.isLastHash(a)&&(b.savedHashes.push(a),!0)},b.getHashByIndex=function(a){return void 0===a?b.savedHashes[b.savedHashes.length-1]:a<0?b.savedHashes[b.savedHashes.length+a]:b.savedHashes[a]},b.discardedHashes={},b.discardedStates={},b.discardState=function(a,c,d){var e,f=b.getHashByState(a);return e={discardedState:a,backState:d,forwardState:c},b.discardedStates[f]=e,!0},b.discardHash=function(a,c,d){var e={discardedHash:a,backState:d,forwardState:c};return b.discardedHashes[a]=e,!0},b.discardedState=function(a){var c=b.getHashByState(a);return b.discardedStates[c]||!1},b.discardedHash=function(a){return b.discardedHashes[a]||!1},b.recycleState=function(a){var c=b.getHashByState(a);return b.discardedState(a)&&delete b.discardedStates[c],!0},b.emulated.hashChange&&(b.hashChangeInit=function(){b.checkerFunction=null;var c,e,f,h,i=b.getHash()||"",j=Boolean(b.getHash());return b.isInternetExplorer()?(c="historyjs-iframe",e=d.createElement("iframe"),e.setAttribute("id",c),e.setAttribute("src","#"),e.style.display="none",d.body.appendChild(e),e.contentWindow.document.open(),e.contentWindow.document.close(),f="",h=!1,b.checkerFunction=function(){if(h)return!1;h=!0;var c=b.getHash(),d=b.getHash(e.contentWindow.document);return c!==i?(i=c,d!==c&&(f=d=c,e.contentWindow.document.open(),e.contentWindow.document.close(),e.contentWindow.document.location.hash=b.escapeHash(c)),b.Adapter.trigger(a,"hashchange")):d!==f&&(f=d,j&&""===d?b.back():b.setHash(d,!1)),h=!1,!0}):b.checkerFunction=function(){var c=b.getHash()||"";return c!==i&&(i=c,b.Adapter.trigger(a,"hashchange")),!0},b.intervalList.push(g(b.checkerFunction,b.options.hashChangeInterval)),!0},b.Adapter.onDomLoad(b.hashChangeInit)),b.emulated.pushState&&(b.onHashChange=function(c){var d,e=c&&c.newURL||b.getLocationHref(),f=b.getHashByUrl(e),g=null;return b.isLastHash(f)?(b.busy(!1),!1):(b.doubleCheckComplete(),b.saveHash(f),f&&b.isTraditionalAnchor(f)?(b.Adapter.trigger(a,"anchorchange"),b.busy(!1),!1):(g=b.extractState(b.getFullUrl(f||b.getLocationHref()),!0),b.isLastSavedState(g)?(b.busy(!1),!1):(b.getHashByState(g),(d=b.discardedState(g))?(b.getHashByIndex(-2)===b.getHashByState(d.forwardState)?b.back(!1):b.forward(!1),!1):(b.pushState(g.data,g.title,encodeURI(g.url),!1),!0))))},b.Adapter.bind(a,"hashchange",b.onHashChange),b.pushState=function(c,d,e,f){if(e=encodeURI(e).replace(/%25/g,"%"),b.getHashByUrl(e))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(!1!==f&&b.busy())return b.pushQueue({scope:b,callback:b.pushState,args:arguments,queue:f}),!1;b.busy(!0);var g=b.createStateObject(c,d,e),h=b.getHashByState(g),i=b.getState(!1),j=b.getHashByState(i),k=b.getHash(),l=b.expectedStateId==g.id;return b.storeState(g),b.expectedStateId=g.id,b.recycleState(g),b.setTitle(g),h===j?(b.busy(!1),!1):(b.saveState(g),l||b.Adapter.trigger(a,"statechange"),b.isHashEqual(h,k)||b.isHashEqual(h,b.getShortUrl(b.getLocationHref()))||b.setHash(h,!1),b.busy(!1),!0)},b.replaceState=function(c,d,e,f){if(e=encodeURI(e).replace(/%25/g,"%"),b.getHashByUrl(e))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(!1!==f&&b.busy())return b.pushQueue({scope:b,callback:b.replaceState,args:arguments,queue:f}),!1;b.busy(!0);var g=b.createStateObject(c,d,e),h=b.getHashByState(g),i=b.getState(!1),j=b.getHashByState(i),k=b.getStateByIndex(-2);return b.discardState(i,g,k),h===j?(b.storeState(g),b.expectedStateId=g.id,b.recycleState(g),b.setTitle(g),b.saveState(g),b.Adapter.trigger(a,"statechange"),b.busy(!1)):b.pushState(g.data,g.title,g.url,!1),!0}),b.emulated.pushState&&b.getHash()&&!b.emulated.hashChange&&b.Adapter.onDomLoad(function(){b.Adapter.trigger(a,"hashchange")})},void 0!==b.init&&b.init()}(c),function(c,d){"use strict";var e=c.console||d,f=c.document,g=c.navigator,h=c.sessionStorage||!1,i=c.setTimeout,j=c.clearTimeout,k=c.setInterval,l=c.clearInterval,m=c.alert;b=c.History=c.History||{};var n=c.history;try{h.setItem("TEST","1"),h.removeItem("TEST")}catch(a){h=!1}if(a.stringify=a.stringify||a.encode,a.parse=a.parse||a.decode,void 0!==b.init)throw new Error("History.js Core has already been loaded...");b.init=function(a){return void 0!==b.Adapter&&(void 0!==b.initCore&&b.initCore(a),void 0!==b.initHtml4&&b.initHtml4(),!0)},b.initCore=function(o){if(void 0!==b.initCore.initialized)return!1;if(b.initCore.initialized=!0,o=o||{},b.options=b.options||{},b.options.hashChangeInterval=o.hashChangeInterval||b.options.hashChangeInterval||100,b.options.safariPollInterval=o.safariPollInterval||b.options.safariPollInterval||500,b.options.doubleCheckInterval=o.doubleCheckInterval||b.options.doubleCheckInterval||500,b.options.disableSuid=o.disableSuid||b.options.disableSuid||!1,b.options.storeInterval=o.storeInterval||b.options.storeInterval||1e3,b.options.busyDelay=o.busyDelay||b.options.busyDelay||250,b.options.debug=o.debug||b.options.debug||!1,b.options.initialTitle=o.initialTitle||b.options.initialTitle||f.title,b.options.html4Mode=o.html4Mode||b.options.html4Mode||!1,b.options.delayInit=o.delayInit||b.options.delayInit||!1,b.intervalList=[],b.clearAllIntervals=function(){var a,c=b.intervalList;if(void 0!==c&&null!==c){for(a=0;a<c.length;a++)l(c[a]);b.intervalList=null}},b.debug=function(){b.options.debug&&b.log.apply(b,arguments)},b.log=function(){var b,c,d,g,h,i=!(void 0===e||void 0===e.log||void 0===e.log.apply),j=f.getElementById("log");for(i?(g=Array.prototype.slice.call(arguments),b=g.shift(),void 0!==e.debug?e.debug.apply(e,[b,g]):e.log.apply(e,[b,g])):b="\n"+arguments[0]+"\n",c=1,d=arguments.length;c<d;++c){if("object"==typeof(h=arguments[c])&&void 0!==a)try{h=a.stringify(h)}catch(a){}b+="\n"+h+"\n"}return j?(j.value+=b+"\n-----\n",j.scrollTop=j.scrollHeight-j.clientHeight):i||m(b),!0},b.getInternetExplorerMajorVersion=function(){return b.getInternetExplorerMajorVersion.cached=void 0!==b.getInternetExplorerMajorVersion.cached?b.getInternetExplorerMajorVersion.cached:function(){for(var a=3,b=f.createElement("div"),c=b.getElementsByTagName("i");(b.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e")&&c[0];);return a>4&&a}()},b.isInternetExplorer=function(){return b.isInternetExplorer.cached=void 0!==b.isInternetExplorer.cached?b.isInternetExplorer.cached:Boolean(b.getInternetExplorerMajorVersion())},b.options.html4Mode?b.emulated={pushState:!0,hashChange:!0}:b.emulated={pushState:!Boolean(c.history&&c.history.pushState&&c.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(g.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(g.userAgent))),hashChange:Boolean(!("onhashchange"in c||"onhashchange"in f)||b.isInternetExplorer()&&b.getInternetExplorerMajorVersion()<8)},b.enabled=!b.emulated.pushState,b.bugs={setHash:Boolean(!b.emulated.pushState&&"Apple Computer, Inc."===g.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(g.userAgent)),safariPoll:Boolean(!b.emulated.pushState&&"Apple Computer, Inc."===g.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(g.userAgent)),ieDoubleCheck:Boolean(b.isInternetExplorer()&&b.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(b.isInternetExplorer()&&b.getInternetExplorerMajorVersion()<7)},b.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},b.cloneObject=function(b){var c,d;return b?(c=a.stringify(b),d=a.parse(c)):d={},d},b.getRootUrl=function(){var a=f.location.protocol+"//"+(f.location.hostname||f.location.host);return f.location.port&&(a+=":"+f.location.port),a+="/"},b.getBaseHref=function(){var a=f.getElementsByTagName("base"),b=null,c="";return 1===a.length&&(b=a[0],c=b.href.replace(/[^\/]+$/,"")),c=c.replace(/\/+$/,""),c&&(c+="/"),c},b.getBaseUrl=function(){return b.getBaseHref()||b.getBasePageUrl()||b.getRootUrl()},b.getPageUrl=function(){var a=b.getState(!1,!1),c=(a||{}).url||b.getLocationHref();return c.replace(/\/+$/,"").replace(/[^\/]+$/,function(a,b,c){return/\./.test(a)?a:a+"/"})},b.getBasePageUrl=function(){return b.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a,b,c){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/"},b.getFullUrl=function(a,c){var d=a,e=a.substring(0,1);return c=void 0===c||c,/[a-z]+\:\/\//.test(a)||(d="/"===e?b.getRootUrl()+a.replace(/^\/+/,""):"#"===e?b.getPageUrl().replace(/#.*/,"")+a:"?"===e?b.getPageUrl().replace(/[\?#].*/,"")+a:c?b.getBaseUrl()+a.replace(/^(\.\/)+/,""):b.getBasePageUrl()+a.replace(/^(\.\/)+/,"")),d.replace(/\#$/,"")},b.getShortUrl=function(a){var c=a,d=b.getBaseUrl(),e=b.getRootUrl();return b.emulated.pushState&&(c=c.replace(d,/\/$/.test(d)?"/":"")),c=c.replace(e,"/"),b.isTraditionalAnchor(c)&&(c="./"+c),c=c.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},b.getLocationHref=function(a){return a=a||f,a.URL===a.location.href?a.location.href:a.location.href===decodeURIComponent(a.URL)?a.URL:a.location.hash&&decodeURIComponent(a.location.href.replace(/^[^#]+/,""))===a.location.hash?a.location.href:-1==a.URL.indexOf("#")&&-1!=a.location.href.indexOf("#")?a.location.href:a.URL||a.location.href},b.store={},b.idToState=b.idToState||{},b.stateToId=b.stateToId||{},b.urlToId=b.urlToId||{},b.storedStates=b.storedStates||[],b.savedStates=b.savedStates||[],b.normalizeStore=function(){b.store.idToState=b.store.idToState||{},b.store.urlToId=b.store.urlToId||{},b.store.stateToId=b.store.stateToId||{}},b.getState=function(a,c){void 0===a&&(a=!0),void 0===c&&(c=!0);var d=b.getLastSavedState();return!d&&c&&(d=b.createStateObject()),a&&(d=b.cloneObject(d),d.url=d.cleanUrl||d.url),d},b.getIdByState=function(a){var c,d=b.extractId(a.url);if(!d)if(c=b.getStateString(a),void 0!==b.stateToId[c])d=b.stateToId[c];else if(void 0!==b.store.stateToId[c])d=b.store.stateToId[c];else{for(;;)if(d=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),void 0===b.idToState[d]&&void 0===b.store.idToState[d])break;b.stateToId[c]=d,b.idToState[d]=a}return d},b.normalizeState=function(a){var c,d;return a&&"object"==typeof a||(a={}),void 0!==a.normalized?a:(a.data&&"object"==typeof a.data||(a.data={}),c={},c.normalized=!0,c.title=a.title||"",c.url=b.getFullUrl(a.url?a.url:b.getLocationHref()),c.hash=b.getShortUrl(c.url),c.data=b.cloneObject(a.data),c.id=b.getIdByState(c),c.cleanUrl=c.url.replace(/\??\&_suid.*/,""),c.url=c.cleanUrl,d=!b.isEmptyObject(c.data),(c.title||d)&&!0!==b.options.disableSuid&&(c.hash=b.getShortUrl(c.url).replace(/\??\&_suid.*/,""),/\?/.test(c.hash)||(c.hash+="?"),c.hash+="&_suid="+c.id),c.hashedUrl=b.getFullUrl(c.hash),(b.emulated.pushState||b.bugs.safariPoll)&&b.hasUrlDuplicate(c)&&(c.url=c.hashedUrl),c)},b.createStateObject=function(a,c,d){var e={data:a,title:c,url:d};return e=b.normalizeState(e)},b.getStateById=function(a){return a=String(a),b.idToState[a]||b.store.idToState[a]||d},b.getStateString=function(c){var d,e;return d=b.normalizeState(c),e={data:d.data,title:c.title,url:c.url},a.stringify(e)},b.getStateId=function(a){var c;return c=b.normalizeState(a),c.id},b.getHashByState=function(a){var c;return c=b.normalizeState(a),c.hash},b.extractId=function(a){var b,c;return c=-1!=a.indexOf("#")?a.split("#")[0]:a,b=/(.*)\&_suid=([0-9]+)$/.exec(c),b?b[1]||a:a,(b?String(b[2]||""):"")||!1},b.isTraditionalAnchor=function(a){return""!==a&&!/[\/\?\.]/.test(a)},b.extractState=function(a,c){var d,e,f=null;return c=c||!1,d=b.extractId(a),d&&(f=b.getStateById(d)),f||(e=b.getFullUrl(a),d=b.getIdByUrl(e)||!1,d&&(f=b.getStateById(d)),f||!c||b.isTraditionalAnchor(a)||(f=b.createStateObject(null,null,e))),f},b.getIdByUrl=function(a){return b.urlToId[a]||b.store.urlToId[a]||d},b.getLastSavedState=function(){return b.savedStates[b.savedStates.length-1]||d},b.getLastStoredState=function(){return b.storedStates[b.storedStates.length-1]||d},b.hasUrlDuplicate=function(a){var c;return c=b.extractState(a.url),c&&c.id!==a.id},b.storeState=function(a){return b.urlToId[a.url]=a.id,b.storedStates.push(b.cloneObject(a)),a},b.isLastSavedState=function(a){var c,d,e,f=!1;return b.savedStates.length&&(c=a.id,d=b.getLastSavedState(),e=d.id,f=c===e),f},b.saveState=function(a){return!b.isLastSavedState(a)&&(b.savedStates.push(b.cloneObject(a)),!0)},b.getStateByIndex=function(a){return void 0===a?b.savedStates[b.savedStates.length-1]:a<0?b.savedStates[b.savedStates.length+a]:b.savedStates[a]},b.getCurrentIndex=function(){return b.savedStates.length<1?0:b.savedStates.length-1},b.getHash=function(a){var c=b.getLocationHref(a);return b.getHashByUrl(c)},b.unescapeHash=function(a){var c=b.normalizeHash(a);return c=decodeURIComponent(c)},b.normalizeHash=function(a){return a.replace(/[^#]*#/,"").replace(/#.*/,"")},b.setHash=function(a,c){var d,e;return!1!==c&&b.busy()?(b.pushQueue({scope:b,callback:b.setHash,args:arguments,queue:c}),!1):(b.busy(!0),d=b.extractState(a,!0),d&&!b.emulated.pushState?b.pushState(d.data,d.title,d.url,!1):b.getHash()!==a&&(b.bugs.setHash?(e=b.getPageUrl(),b.pushState(null,null,e+"#"+a,!1)):f.location.hash=a),b)},b.escapeHash=function(a){var d=b.normalizeHash(a);return d=c.encodeURIComponent(d),b.bugs.hashEscape||(d=d.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),d},b.getHashByUrl=function(a){var c=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return c=b.unescapeHash(c)},b.setTitle=function(a){var c,d=a.title;d||(c=b.getStateByIndex(0))&&c.url===a.url&&(d=c.title||b.options.initialTitle);try{f.getElementsByTagName("title")[0].innerHTML=d.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(a){}return f.title=d,b},b.queues=[],b.busy=function(a){if(void 0!==a?b.busy.flag=a:void 0===b.busy.flag&&(b.busy.flag=!1),!b.busy.flag){j(b.busy.timeout);var c=function(){var a,d,e;if(!b.busy.flag)for(a=b.queues.length-1;a>=0;--a)d=b.queues[a],0!==d.length&&(e=d.shift(),b.fireQueueItem(e),b.busy.timeout=i(c,b.options.busyDelay))};b.busy.timeout=i(c,b.options.busyDelay)}return b.busy.flag},b.busy.flag=!1,b.fireQueueItem=function(a){return a.callback.apply(a.scope||b,a.args||[])},b.pushQueue=function(a){return b.queues[a.queue||0]=b.queues[a.queue||0]||[],b.queues[a.queue||0].push(a),b},b.queue=function(a,c){return"function"==typeof a&&(a={callback:a}),void 0!==c&&(a.queue=c),b.busy()?b.pushQueue(a):b.fireQueueItem(a),b},b.clearQueue=function(){return b.busy.flag=!1,b.queues=[],b},b.stateChanged=!1,b.doubleChecker=!1,b.doubleCheckComplete=function(){return b.stateChanged=!0,b.doubleCheckClear(),b},b.doubleCheckClear=function(){return b.doubleChecker&&(j(b.doubleChecker),b.doubleChecker=!1),b},b.doubleCheck=function(a){return b.stateChanged=!1,b.doubleCheckClear(),b.bugs.ieDoubleCheck&&(b.doubleChecker=i(function(){return b.doubleCheckClear(),b.stateChanged||a(),!0},b.options.doubleCheckInterval)),b},b.safariStatePoll=function(){var a,d=b.extractState(b.getLocationHref());if(!b.isLastSavedState(d))return a=d,a||(a=b.createStateObject()),b.Adapter.trigger(c,"popstate"),b},b.back=function(a){return!1!==a&&b.busy()?(b.pushQueue({scope:b,callback:b.back,args:arguments,queue:a}),!1):(b.busy(!0),b.doubleCheck(function(){b.back(!1)}),n.go(-1),!0)},b.forward=function(a){return!1!==a&&b.busy()?(b.pushQueue({scope:b,callback:b.forward,args:arguments,queue:a}),!1):(b.busy(!0),b.doubleCheck(function(){b.forward(!1)}),n.go(1),!0)},b.go=function(a,c){var d;if(a>0)for(d=1;d<=a;++d)b.forward(c);else{if(!(a<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(d=-1;d>=a;--d)b.back(c)}return b},b.emulated.pushState){var p=function(){};b.pushState=b.pushState||p,b.replaceState=b.replaceState||p}else b.onPopState=function(a,d){var e,f,g=!1,h=!1;return b.doubleCheckComplete(),(e=b.getHash())?(f=b.extractState(e||b.getLocationHref(),!0),f?b.replaceState(f.data,f.title,f.url,!1):(b.Adapter.trigger(c,"anchorchange"),b.busy(!1)),b.expectedStateId=!1,!1):(g=b.Adapter.extractEventData("state",a,d)||!1,h=g?b.getStateById(g):b.expectedStateId?b.getStateById(b.expectedStateId):b.extractState(b.getLocationHref()),h||(h=b.createStateObject(null,null,b.getLocationHref())),b.expectedStateId=!1,b.isLastSavedState(h)?(b.busy(!1),!1):(b.storeState(h),b.saveState(h),b.setTitle(h),b.Adapter.trigger(c,"statechange"),b.busy(!1),!0))},b.Adapter.bind(c,"popstate",b.onPopState),b.pushState=function(a,d,e,f){if(b.getHashByUrl(e)&&b.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==f&&b.busy())return b.pushQueue({scope:b,callback:b.pushState,args:arguments,queue:f}),!1;b.busy(!0);var g=b.createStateObject(a,d,e);return b.isLastSavedState(g)?b.busy(!1):(b.storeState(g),b.expectedStateId=g.id,n.pushState(g.id,g.title,g.url),b.Adapter.trigger(c,"popstate")),!0},b.replaceState=function(a,d,e,f){if(b.getHashByUrl(e)&&b.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==f&&b.busy())return b.pushQueue({scope:b,callback:b.replaceState,args:arguments,queue:f}),!1;b.busy(!0);var g=b.createStateObject(a,d,e);return b.isLastSavedState(g)?b.busy(!1):(b.storeState(g),b.expectedStateId=g.id,n.replaceState(g.id,g.title,g.url),b.Adapter.trigger(c,"popstate")),!0};if(h){try{b.store=a.parse(h.getItem("History.store"))||{}}catch(a){b.store={}}b.normalizeStore()}else b.store={},b.normalizeStore();b.Adapter.bind(c,"unload",b.clearAllIntervals),b.saveState(b.storeState(b.extractState(b.getLocationHref(),!0))),h&&(b.onUnload=function(){var c,d,e;try{c=a.parse(h.getItem("History.store"))||{}}catch(a){c={}}c.idToState=c.idToState||{},c.urlToId=c.urlToId||{},c.stateToId=c.stateToId||{};for(d in b.idToState)b.idToState.hasOwnProperty(d)&&(c.idToState[d]=b.idToState[d]);for(d in b.urlToId)b.urlToId.hasOwnProperty(d)&&(c.urlToId[d]=b.urlToId[d]);for(d in b.stateToId)b.stateToId.hasOwnProperty(d)&&(c.stateToId[d]=b.stateToId[d]);b.store=c,b.normalizeStore(),e=a.stringify(c);try{h.setItem("History.store",e)}catch(a){if(a.code!==DOMException.QUOTA_EXCEEDED_ERR)throw a;h.length&&(h.removeItem("History.store"),h.setItem("History.store",e))}},b.intervalList.push(k(b.onUnload,b.options.storeInterval)),b.Adapter.bind(c,"beforeunload",b.onUnload),b.Adapter.bind(c,"unload",b.onUnload)),b.emulated.pushState||(b.bugs.safariPoll&&b.intervalList.push(k(b.safariStatePoll,b.options.safariPollInterval)),"Apple Computer, Inc."!==g.vendor&&"Mozilla"!==(g.appCodeName||"")||(b.Adapter.bind(c,"hashchange",function(){b.Adapter.trigger(c,"popstate")}),b.getHash()&&b.Adapter.onDomLoad(function(){b.Adapter.trigger(c,"hashchange")})))}}(c),b}),define("yfjs/spa/util/layout",["../version","./helpers","./event","./error","./widget"],function(a,b,c,d,e){var f="Layout",g=e({NAMESPACE:f,VERSION:a(f),CONTAINER_ID:"app-layout",BIND_KEY:"data-layout",Event:c(f),Error:d(f),PREFIX_PATH_SCRIPT:"app/layouts",PREFIX_PATH_TEMPLATE:"app/templates/layouts",defaultTemplate:function(a){return b.isUndef(a)||(a=a||"{{body}}"),a}});return g.Error.translate({script_unfound:"加载 {0} 布局失败。找不到依赖文件或模块 {1}",script_timeout:"加载 {0} 布局失败。依赖文件或模块 {1} 加载超时",script_error:"加载 {0} 布局失败。文件 {1} 存在错误：{2}",script_invalid_return:"加载 {0} 布局失败。布局文件 {1} 必须明确返回布局实例",callback:"执行 {0} 布局的 {1} 时发生了错误: {2}",style_unfound:"布局 {0} - {1}",load_fail:"加载 {0} 布局失败。{1}"}),g.Error.translate("setter","布局 {0} 设置错误。无法设置实例属性 {1}，因为它是布局实例的固有属性"),g.Error.translate("include_limit","布局 {0} 模板引入错误。引入 {1} 时超过最大引入层数（"+e.INCLUDE_LEVEL_LIMIT+"）限制"),g}),define("yfjs/spa/util/path-wildcard-compiler",["../version","jquery","./helpers"],function(a,b,c){var d={};return d.NAMESPACE="PathWildcardCompiler",d.VERSION=a(d.NAMESPACE),d.DEFAULTS={forceAbsolutePath:!1,forceRelativePath:!1,forceMatchPrefix:!1,forceMatchSuffix:!1},d.REGEXP_PREFIX=/^\^/,d.REGEXP_SUFFIX=/\$$/,d.config=function(a,e){return c.isEmpty(a)||(c.isObject(a)?b.extend(d.DEFAULTS,a):(a=c.trim(a),d.DEFAULTS[a]=e)),d},b.extend(d,{ESCAPE_CHAR:"\\",SLASH:"/",UNDERSCORE:"_",DASH:"-",DOT:".",STAR:"*",QUESTION:"?",REGEX_MATCH_PREFIX:"^",REGEX_MATCH_SUFFIX:"$",REGEX_WORD_BOUNDARY:"\\b",REGEX_SLASH:"\\/",REGEX_SLASH_NO_DUP:"\\/(?!\\/)",REGEX_FILE_NAME_CHAR:"[\\w\\-\\.]",LAST_TOKEN_START:0,LAST_TOKEN_SLASH:1,LAST_TOKEN_FILE_NAME:2,LAST_TOKEN_STAR:3,LAST_TOKEN_DOUBLE_STAR:4,LAST_TOKEN_QUESTION:5}),b.extend(d,{REGEX_FILE_NAME_SINGLE_CHAR:"("+d.REGEX_FILE_NAME_CHAR+")",REGEX_FILE_NAME:"("+d.REGEX_FILE_NAME_CHAR+"*)",REGEX_FILE_PATH:"("+d.REGEX_FILE_NAME_CHAR+"+(?:"+d.REGEX_SLASH_NO_DUP+d.REGEX_FILE_NAME_CHAR+"*)*(?="+d.REGEX_SLASH+"|$)|)"+d.REGEX_SLASH+"?"}),b.extend(d,{compilePathName:function(a,b){try{return new RegExp(d.pathToRegex(a,b))}catch(a){return null}},getPathNameRelevancy:function(a){if(!(a=d.normalizePath(a)))return 0;for(var b=0,c=0;c<a.length;c++)switch(a.charAt(c)){case d.SLASH:case d.STAR:case d.QUESTION:continue;default:b++}return b},pathToRegex:function(a,e){if(!(a=d.normalizePath(a)))return null;e=b.extend({},d.DEFAULTS,e),d.REGEXP_PREFIX.test(a)&&(e.forceMatchPrefix=!0,a=a.slice(1)),d.REGEXP_SUFFIX.test(a)&&(e.forceMatchSuffix=!0,a=a.slice(0,-1)),a=c.trim(a);var f=d.LAST_TOKEN_START,g="";(e.forceMatchPrefix||a.length>0&&a.charAt(0)==d.SLASH)&&(g+=d.REGEX_MATCH_PREFIX),a==d.SLASH&&(a="");for(var h=0;h<a.length;h++){var i=a.charAt(h);if(e.forceAbsolutePath&&f==d.LAST_TOKEN_START&&i!=d.SLASH)throw new Error({name:"Syntax Error",filename:a,number:h,message:'Path must start with "/" when FORCE_ABSOLUTE_PATH is true.'});switch(i){case d.SLASH:if(f==d.LAST_TOKEN_SLASH)throw new Error({name:"Syntax Error",filename:a,number:h,message:'Path can not contains double slash "//".'});if(e.forceRelativePath&&f==d.LAST_TOKEN_START)throw new Error({name:"Syntax Error",filename:a,number:h,message:'Path can not starts with "/" when FORCE_RELATIVE_PATH is true.'});f!=d.LAST_TOKEN_DOUBLE_STAR&&(g+=d.REGEX_SLASH_NO_DUP),f=d.LAST_TOKEN_SLASH;break;case d.STAR:var j=h+1;if(j<a.length&&a.charAt(j)==d.STAR){if(h=j,f!=d.LAST_TOKEN_START&&f!=d.LAST_TOKEN_SLASH)throw new Error({name:"Syntax Error",filename:a,number:h,message:'Double stars "**" in front of only slash "/".'});f=d.LAST_TOKEN_DOUBLE_STAR,g+=d.REGEX_FILE_PATH}else{if(f==d.LAST_TOKEN_STAR||f==d.LAST_TOKEN_DOUBLE_STAR)throw new Error({name:"Syntax Error",filename:a,number:h,message:'If the front is not slash "/", the front of star "*" cannot be "*" or "**".'});f=d.LAST_TOKEN_STAR,g+=d.REGEX_FILE_NAME}break;case d.QUESTION:f=d.LAST_TOKEN_QUESTION,g+=d.REGEX_FILE_NAME_SINGLE_CHAR;break;default:if(f==d.LAST_TOKEN_DOUBLE_STAR)throw new Error({name:"Syntax Error",filename:a,number:h,message:'Double stars "**" must be followed by slash "/".'});if(/[a-z0-9]/i.test(i)||i==d.UNDERSCORE||i==d.DASH)f==d.LAST_TOKEN_START?g+=d.REGEX_WORD_BOUNDARY+i:h+1==a.length?g+=i+d.REGEX_WORD_BOUNDARY:g+=i;else{if(i!=d.DOT)throw new Error({name:"Syntax Error",filename:a,number:h,message:"Path contains non-standard characters."});g+=d.ESCAPE_CHAR+d.DOT}f=d.LAST_TOKEN_FILE_NAME}}return e.forceMatchSuffix&&(g+=d.REGEX_MATCH_SUFFIX),g},normalizePath:function(a){return c.isEmpty(a)?null:c.trim(a).replace(/\\\\/g,"/").replace(/\/\//g,"/")}}),d}),define("yfjs/spa/util/remote",["../version","./helpers"],function(a,b){var c=function(){return new c.Constructor(b.__aslice.call(arguments))};return c.NAMESPACE="Remote",c.VERSION=a(c.NAMESPACE),c.instanceof=function(a){return a&&a instanceof c.Constructor},c.Constructor=function(a){if(!(this instanceof c.Constructor))return new c.Constructor(a);this.args=a||[],this.length=a.length},c.Constructor.prototype={get:function(a){if(!(this.length<1))return 1==this.length?this.args[0]:"number"==typeof a?this.args[a]:this.args}},c}),
define("yfjs/spa/util/route",["../version","./history","jquery","./helpers","./event","./error","./widget","./layout","./view","./template"],function(a,b,c,d,e,f,g,h,i,j){b.init({html4Mode:!0,disableSuid:!0});var k={};return k.NAMESPACE="Route",k.VERSION=a(k.NAMESPACE),k.Event=e(k.NAMESPACE),k.Error=f(k.NAMESPACE),k.Error.translate({callback:"执行 Route 的 {0} 时发生了错误: {1}"}),d.def(h,"INCLUDE_WIDGET",i),k.Layout=h,k.View=i,k.Callback=d.__undef__,k.OriginalTitle=function(){var a;try{a=d.document.getElementsByTagName("title")[0].innerHTML.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}catch(b){a=""}return a}(),k.setTitle=function(a){try{a=a||k.OriginalTitle||d.document.location.href}catch(b){a=""}if(a){a=String(a);try{d.document.getElementsByTagName("title")[0].innerHTML=a.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(a){}d.document.title=a}return k},d.def(k,"LAST_VIEW",null,{writable:!1,configurable:!0}),d.def(k,"LAST_LAYOUT",null,{writable:!1,configurable:!0}),k.load=function(a,b){function e(a){function b(a,b){return a=a||{},b=d.isFunction(a.wrap)?a.wrap(b):i.wrap()(b),d.html2str(b)}function e(a,b){return a=a||{},b=d.isFunction(a.wrap)?a.wrap(b):h.wrap()(b),d.html2str(b)}if(i.instanceof(a)){var g=a.getInstance(),j=g.callOption("title");d.notNull(j)&&k.setTitle(j);var l=c.Deferred();l.done(function(j,l){var m={view:a};if(d.isEmpty(j)){var n,o;h.instanceof(l)?(o=h.isChanged(l),o?d.def(g,"__layout__",l.getInstance()):d.def(g,"__layout__",h.LAST_INSTANCE.getInstance()),m.layout=l):(o=h.isChanged(),d.def(g,"__layout__",null),m.layout=d.__undef__,n=l);var p=c.Deferred();p.done(function(c,g){if(m.html=g.html,d.isUndef(m.html))m.layout=h.LAST_INSTANCE,f.resolve(c,m);else if(m.layout){var j,l=a.getState("__reload_page__");if(l||o){m.html=b(g,m.html),o||(m.layout=h.LAST_INSTANCE,m.layout.reset());var p=k.LAST_LAYOUT;h.instanceof(p)&&p.dispose(),d.def(k,"LAST_LAYOUT",m.layout),j=m.layout.getInstance(),d.def(j.__state__.data,"__body__",m.html,{enumerable:!0,configurable:!0}),d.assignDeferred(f,m.layout.load(function(a,b){n=b||{},a&&(c=d.concatError(c,a)),d.isUndef(n.html)||(m.html=n.html),h.updateWrap(m.layout.getState("name"))?m.container=h.CONTAINER:m.html=e(n,m.html),f.resolve(c,m)}))}else m.layout=h.LAST_INSTANCE,m.container=i.CONTAINER,f.resolve(c,m)}else m.html=b(g,m.html),h.updateWrap()?m.container=h.CONTAINER:m.html=e(n,m.html),f.resolve(c,m)}),d.assignDeferred(f,p);var q=k.LAST_VIEW;i.instanceof(q)&&q.dispose(),d.def(k,"LAST_VIEW",a),d.assignDeferred(p,a.load(function(a,b){d.disposeDeferred(p,!1),p.resolve(a,b)}))}else f.resolve(j,m)}),d.assignDeferred(f,l);var m=g.callOption("layout");d.assignDeferred(l,h.load(m,function(a,b){if(d.isNull(j)){var c;if(h.instanceof(b)){c=b.getInstance().callOption("title")}c?k.setTitle(c):k.setTitle()}d.disposeDeferred(l,!1),l.resolve(a,b)}))}}var f=c.Deferred();return d.disposeDeferred(k.load),d.assignDeferred(k.load,f),k.Event.trigger("Loading"),f.done(function(a,c){i.Event.unbind("CallbackError"),h.Event.unbind("CallbackError");var e=c&&c.view?c.view.getInstance():d.__undef__;if(e&&e.context===e.rootContext){var f=g.updateState.call(e,"loaded");!1!==f&&e.callOption("statechange",f),e.callOption("loaded")}if(d.isEmpty(a)||(a=d.concatError(a,d.setPropsRecursive(d.sliceError(a,{NS:j.NAMESPACE}),{level:k.Error.LEVEL_PAGE}))),d.isFunction(b))try{b.apply(k,arguments)}catch(a){k.Event.trigger("CallbackError",k.makeError("callback",["loadCallback",a.message],a))}d.disposeDeferred(k.load,!1)}),i.Event.bind("CallbackError",function(a,b){k.Event.trigger("CallbackError",b)}),h.Event.bind("CallbackError",function(a,b){k.Event.trigger("CallbackError",b)}),i.instanceof(a)?e(a):d.assignDeferred(f,i.load(a,function(a,b){d.isEmpty(a)?e(b):f.resolve(a)})),f.promise()},k.listen=function(a){k.Callback||b.Adapter.bind(window,"statechange",function(){try{d.isFunction(k.Callback)&&k.Callback.call(k)}catch(a){k.Event.trigger("CallbackError",k.makeError("callback",["stateChangeCallback",a.message],a))}}),d.isFunction(a)&&(k.Callback=a)},k.makeError=function(a,b,c){var e,f=k.__error_maker__;return f||(d.def(k,"__error_maker__",d.errorMaker(k.Error)),f=k.__error_maker__),e=f.apply(this,arguments),e.level=k.Error.LEVEL_PAGE,e},k.history={back:function(a){return b.back(a)},forward:function(a){return b.forward(a)},go:function(a,c){return b.go(a,c)}},k.getRootUrl=function(){return b.getRootUrl()},k.getBaseHref=function(){return b.getBaseHref()},k.getState=function(){return b.getState()},k.getStateById=function(a){return b.getStateById(a)},k.getStateByIndex=function(a){return b.getStateByIndex(a)},k.pushState=function(){return b.pushState.apply(b,arguments)},k.replaceState=function(){return b.replaceState.apply(b,arguments)},k}),define("yfjs/spa/util/style-loader",["../version","jquery","./helpers","./event","./error","./ajax"],function(a,b,c,d,e,f){var g=c.REGEXP_PROTOCOL_START,h=c.REGEXP_DSLASH_START,i=c.REGEXP_SLASH_START,j=c.REGEXP_URL_IMPORT,k=c.REGEXP_QUOTA_START,l=c.REGEXP_QUOTA_END,m=c.LOCAL_ROOT,n=c.LOCAL_DOMAIN,o=function(a,b){if(!(this instanceof o))return new o(a,b);c.def(this,"__options__",c.extend(!0,{},o.DEFAULTS,a)),c.def(this,"__context__",b)};return o.NAMESPACE="StyleLoader",o.VERSION=a(o.NAMESPACE),o.DEFAULTS={cache:!0,remote:{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},dataType:"text"}},o.Event=d(o.NAMESPACE),o.Error=e(o.NAMESPACE),o.Error.translate({style_unfound:"找不到样式文件 {0}",callback:"执行 StyleLoader 的 {0} 时发生了错误: {1}"}),o.config=c.configurator.call(o,o.DEFAULTS),o.cache={},o.ajax=null,o.load=function(a,d){var e=b.Deferred();a=c.trim(a);var p,q=this;try{p=this.__context__||this||{}}catch(a){p={}}return function(a,d,e,p){function r(a){var d=c.trim(a),e={},f=a.lastIndexOf("?");return f>-1&&(d=a.substring(0,f),e=b.parseQuery(a)),a=c.getRequireUrl(d),t.cache||c.extend(e,{bust:c.timestamp()}),e=b.param(e),a=d+(e?"?"+e:"")}c.isFunction(e)&&a.done(function(a,b){try{e.apply(p,arguments),c.normalizeCallbackArgs(e,arguments)}catch(a){o.Event.trigger("CallbackError",q.makeError("callback",["loadCallback",a.message],a))}});var s,t;if(t=q&&q.__options__?q.__options__:o.DEFAULTS,t.cache&&!c.isUndef(s=o.cache[d]))a.resolve(c.__undef__,{filename:d,source:s});else{var u=r(d),v=c.encodeIdFromURI(d);d=0==d.indexOf(m)?d.substring(m.length-1):u;var w=c.getDomain(u);if(w&&w!==n){var x=p.NS||"",y=c.isFunction(p.getState)?p.getState("name"):"";a.resolve(c.__undef__,{filename:d,html:'<link id="'+v+'" '+(x&&y?"data-"+x.toLowerCase()+'="'+y+'" ':"")+'href="'+u+'" rel="stylesheet" type="text/css"/>'})}else{var z,A,B=u.lastIndexOf("/"),C=u.substring(0,B+1);A=t.remote?t.remote:o.DEFAULTS.remote,p.ajax instanceof f?z=p.ajax:(o.ajax||(o.ajax=new f(o.DEFAULTS.remote)),z=o.ajax),u=c.extend(!0,{},A,{url:u}),z.get(u,function(b,e){b&&c.isFunction(this.removeError)&&this.removeError(b),b||c.isUndef(e)?b&&(b=q.makeError("style_unfound",[d],b)):(s=c.trim(e),s=s.replace(j,function(a,b){return b=c.trim(b).replace(k,"").replace(l,""),h.test(b)&&(b=c.LOCAL_PROTOCOL+b),g.test(b)||(i.test(b)?(b=b.replace(i,""),b=m+b):b=C+b),'url("'+b+'")'}),t.cache&&(o.cache[u]=s)),a.resolve(b,{filename:d,source:s})})}}}(e,a,d,p),e.promise()},o.makeError=function(){return o.Error.make.apply(o.Error,arguments)},o.prototype={setOption:c.optionSetter(o.DEFAULTS),getOption:c.optionGetter(),getOptions:c.optionsGetter(),getContext:function(){return this.__context__},load:function(a,b){return o.load.apply(this,arguments)},makeError:function(a,b,d){var e,f=this.__error_maker__;return f||(c.def(this,"__error_maker__",c.errorMaker(o.Error,this.getContext())),f=this.__error_maker__),e=f.apply(this,arguments),e.level=o.Error.LEVEL_CONSOLE,e}},o}),define("yfjs/spa/util/template",["../version","jquery","./helpers","./template-helpers","./event","./error","./ajax"],function(a,b,c,d,e,f,g){function h(a,b){(a=c.trim(a))&&c.isFunction(b)&&(this[a]=b)}function i(a){if(c.notNull(a)&&c.isObject(a))for(var b in a)c.__hasOwn.call(a,b)&&h.call(this,b,a[b])}function j(a,b,d){return arguments.length<3&&(d=b,b=c.__undef__),c.isEmpty(d)||(c.notNull(a)&&c.isFunction(a.addError)&&a.addError(d),b=b?c.isArray(d)?d.concat(b):[d].concat(b):d),b}function k(a,b,d){var e=l(a,b,d);c.isEmpty(e)||n.Event.trigger("Error",e)}function l(a,b,d){return c.notNull(a)&&c.isFunction(a.sliceError)?a.sliceError(c.extend({NS:n.NAMESPACE},d)):b}var m=c.LOCAL_ROOT,n=function(a,b){if(!(this instanceof n))return new n(a,b);var d=this;c.def(this,"__options__",c.extend({},n.DEFAULTS,a)),a&&c.notNull(a.helpers)?this.setOption("helpers",c.extend({},n.HELPERS,n.DEFAULTS.helpers,a.helpers)):this.setOption("helpers",c.extend({},n.HELPERS,n.DEFAULTS.helpers)),a&&c.notNull(a.remote)?this.setOption("remote",c.extend(!0,{},n.DEFAULTS.remote,a.remote)):this.setOption("remote",c.extend(!0,{},n.DEFAULTS.remote)),c.def(this,"__context__",b),c.def(this,"__include_promise__",[]),c.def(this,"utils",{$helpers:{},$string:n.toString,$escape:n.escapeHTML,$each:n.each,$context:this.getContext()||this,$include:function(){return d.include.apply(d,arguments)}},{writable:!1,configurable:!1}),this.helpers(this.getOption("helpers"))};return n.NAMESPACE="Template",n.VERSION=a(n.NAMESPACE),n.DEFAULTS={openTag:"{{",closeTag:"}}",escape:!0,cache:!1,comment:!1,compress:!1,parser:null,include:null,rendered:null,helpers:c.__undef__,remote:{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},dataType:"text"}},n.Event=e(n.NAMESPACE),n.Error=f(n.NAMESPACE),n.Error.translate({remote_error:"模板加载失败：{0}",render_error:"模板文件 {0} {1} 编译错误：{2}",param_invalid_include:"模板内 include 方法缺少 {0} 参数",callback:"执行 Template 的 {0} 时发生了错误: {1}"}),n.config=c.configurator.call(n,n.DEFAULTS),n.HELPERS={},n.helper=function(a,b){return h.apply(n.HELPERS,arguments),n},n.helpers=function(a){return i.apply(n.HELPERS,arguments),n},n.helpers(d),n.KEYWORDS="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",n.REGEXP_REMOVE=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,n.REGEXP_SPLIT=/[^\w$]+/g,n.REGEXP_KEYWORDS=new RegExp(["\\b"+n.KEYWORDS.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),n.REGEXP_OBJECT_KEY=/\{\s*(\w+)\s*:/g,n.REGEXP_NUMBER=/^\d[^,]*|,\d[^,]*/g,n.REGEXP_BOUNDARY=/^,+|,+$/g,n.REGEXP_SPLIT2=/^$|,+/,n.REGEXP_COMMENT_START=/<!--/,n.REGEXP_COMMENT_END=/-->/,n.REGEXP_TAG_SOURCE=/<script\s+(?:[^>]*)type=\s*(?:'|")text\/html(?:'|")(?:[^>]*)>([\s\S]*)<\/script>/gi,n.REGEXP_MAIN_OPEN=/^\{+/,n.REGEXP_MAIN_CLOSE=/^\}+/,n.cache={},n.remoteCache={},n.ajax=null,n.prototype={setOption:c.optionSetter(n.DEFAULTS),getOption:c.optionGetter(),getOptions:c.optionsGetter(),getContext:function(){return this.__context__},helper:function(a,b){var d=c.__aslice.call(arguments);if(c.isFunction(d[1])){d[1]=b.bind(this.getContext()||this);var e=this.utils||{};e.$helpers=e.$helpers||{},h.apply(e.$helpers,d)}return this},helpers:function(a){if(c.notNull(a)&&c.isObject(a))for(var b in a)c.__hasOwn.call(a,b)&&this.helper(b,a[b]);return this},include:function(a,b,d,e){var f,g,h=this.__options__||{};if(c.isFunction(h.include))try{g=h.include.apply(this.getContext()||this,arguments)}catch(a){f=this.makeError("callback",["include",a.message],a),g=f.message}else{var i=c.__aslice.call(arguments);if(i.length<3||c.isEmpty(i[0]))f=this.makeError("param_invalid_include",["filename"]),g=f.message;else{var j={$include:d};i.length<4?i.splice(1,1,j):i.splice(1,2,c.extend({},n.normalizeData(b),j));var k=this.render.apply(this.getContext()||this,i);g=c.isString(k)?k:k.message}}return c.notNull(f)&&n.Event.trigger("Error",f),c.notNull(g)?String(g):""},includeIndex:function(a){var b=1;if(!c.isEmpty(a)){var d,e,f;if((e=this.getIncludePromisePos(a))>-1){for(b=0,d=0;d<e;d++)f=this.__include_promise__[d]||{},c.isNumber(f.len)?b+=f.len:b+=1;f=this.__include_promise__[e]||{},c.isArray(f.promise)?b+=f.promise.length+1:b+=1}else{for(b=0,d=0;d<this.__include_promise__.length;d++)f=this.__include_promise__[d],c.isNumber(f.len)?b+=f.len:b+=1;b+=1}}return b},setIncludePromise:function(a,b){if(!c.isEmpty(b)){var d={};d.key=b=c.trim(b);var e=this.getIncludePromisePos(d.key);if(e<0)d.promise=[a],d.len=1,this.__include_promise__.push(d);else{var f=this.__include_promise__.splice(e,1)[0]||{};c.isArray(f.promise)||(f.promise=[]),f.promise.push(a),f.len=f.promise.length,this.__include_promise__.splice(e,0,f)}}return this},getIncludePromises:function(a){var b,d;return!c.isEmpty(a)&&(d=this.getIncludePromisePos(a))>-1&&(b=this.__include_promise__[d]||{},b=b.promise),c.isNull(b)?b=[]:c.isArray(b)||(b=[b]),b},getIncludePromisePos:function(a){for(var b=-1,c=0;c<this.__include_promise__.length;c++)if(this.__include_promise__[c]&&this.__include_promise__[c].key===a){b=c;break}return b},clearIncludePromise:function(a){if(c.isNull(a))for(var b in this.__include_promise__)delete this.__include_promise__[b];else{var d=this.getIncludePromisePos(a);if(d>-1){var e=this.__include_promise__[d]||{};c.isArray(e.promise)&&e.promise.splice(0,e.promise.length)}}},dataFilter:function(a,b){var d,e=!1;if(b=c.__aslice.call(arguments,1),c.isFunction(a))try{d=a.apply(this.getContext()||this,b),c.normalizeCallbackArgs(a,b),delete a.__err_called__,e=!0}catch(b){c.def(a,"__err_called__",this.makeError("callback",["dataFilter",b.message],b),{configurable:!0})}return e||(b.length>1?d=b:b.length>0&&(d=b[0])),d},remote:function(a,b){var d=this;return n.remote.call(d,a,function(a,e){var f=d.getContext(),g={__caller_name__:"template.remote"},h=c.extend({context:f},g);a=c.setPropsRecursive(a,h);var i=j(f,a);if(c.isFunction(b))try{b.apply(f||d,arguments),c.normalizeCallbackArgs(b,arguments)}catch(a){i=l(f,i,g);var m=c.setPropsRecursive(d.makeError("callback",["remote callback",a.message],a),h);i=j(f,i,m)}k(f,i,g)})},render:function(a,d,e,f){function g(b,e,f){if(c.isFunction(b)){var g=m.getContext();e=c.normalizeArrOption(e),e=m.rendered.apply(m,e),e.push(d,a),c.notNull(f)&&e.push(f);try{b.apply(g||m,e)}catch(a){x=l(g,x,B),y=c.setPropsRecursive(m.makeError("callback",["renderCallback",a.message],a),B),x=j(g,x,y)}}k(g,x,B)}function h(a){var b;if(c.isArray(a))for(var d,e=0;e<a.length;e++)c.isUndef(b)&&(b=""),d=h(b),c.isEmpty(d)||(b+="\n"+d);else c.notNull(a)&&(b=c.trim(a.message));return c.isUndef(b)&&(b=""),b}var i,m=this,o=this.__options__||{},p=this.getContext();if(c.isFunction(d)?(f=d,e=c.__undef__,d={}):c.isFunction(e)&&(f=e,c.notNull(d)&&!c.isObject(d)?(e=c.trim(d),d={}):e=c.__undef__),c.isEmpty(a))return"";a=c.trim(a),d=n.normalizeData(d);var q=!1,r=!1;if(/^[_a-z][a-z\-_0-9—]*$/i.test(a)){var s;try{s=c.document.getElementById(a)}catch(a){s=c.__undef__}s&&(r=!0,e=c.decodeIdToPath(a),p&&c.def(p,"__render_file__",e,{configurable:!0}),q=!c.isEmpty(e),q&&o.cache&&(i=n.cache[e]),i||(a=(s.value||s.innerHTML||"").replace(/^\s*|\s*$/g,""),i=this.compile(a,e)))}else(q=!c.isEmpty(e))&&p&&c.def(p,"__render_file__",e,{configurable:!0});if(q){if(!r){var t=e.lastIndexOf("?");if(t>-1){var u=e.substring(t+1);e=e.substring(0,t);var v=u.match(/bust=[^&]+/);null!=v&&null!=v[0]&&(u=u.substring(0,v.index)+u.substring(v.index+v[0].length)),u.length&&(e+="?"+u)}}}else e=c.hash(a);i||(o.cache&&(i=n.cache[e]),i||(i=this.compile(a,e)));var w=i.call(this,d);p&&c.def(p,"__render_file__",null);var x,y,z,A=[c.__undef__],B={__caller_name__:"template.render"};c.isString(w)?A.push(w):(y=c.setPropsRecursive(this.makeError("render_error",[w.filename,"- line: "+w.line+" -",w.message],w),B),A[0]=z=y,x=j(p,y),A.push(c.__undef__));for(var C,D=e,E=this.getIncludePromises(D),F=0;F<E.length;F++)c.isPromise(E[F])&&(C=C||[],C.push(E[F]));if(E=null,!c.isArray(C)||!C.length)return g(f,A),c.isEmpty(z)?w:h(z);if(c.isString(A[1])){var G=b.Deferred();return function(a,d,e,f,h){b.when.apply(b.when,e).done(function(){function i(a,b){function d(a){var d=i?h.PREFIX_CSS_INCLUDE+c.stylePathId(k.getState("name")):"";if(c.isFunction(b.wrap))return b.wrap(a,d);if(j||b.state){var e=b.state?b.state.container:k.getState("container");e=e.replace(h.REGEXP_HASH_START,"");var f=b.state?b.state.name:k.getState("name");return h.wrap(f,e)(a,d)}return a||""}if(b&&b.widget){var e,f,g,h=b.widget,i=h.instanceof(b.context),j=i?b.context:null,k=j?j.getInstance():null,l=k?k.context:null;if(i?(c.inArray(j,l.__included__)<0&&l.__included__.push(j),g=k.getState("include")||{},e=g.body):b.state?(g=b.state.include||{},e=g.body):e=c.__undef__,!c.isEmpty(e)){if(c.isUndef(b.html))f=d(a?"{{{"+e+"}}}":"");else{var m;i&&(m=j.getState("$style"))&&(b.html=c.html2str(m)+"\n"+b.html),f=d(b.html)}n=c.replaceMainBody(n,e,f)}}}var j,k,l=h[0],n=c.trim(h[1]),o=c.__aslice.call(arguments);e.length>1?b.each(o,function(a,b){c.isUndef(b[0])||(j=j||new Array(e.length),j[a]=b[0]),c.isUndef(b[1])||(k=k||new Array(e.length),k[a]=b[1])}):(j=o[0],k=o[1]),c.isEmpty(j)||(l=c.concatError(l,j),h[0]=l);var q;if(c.isArray(k))for(q=0;q<k.length;q++)i(j?j[q]:c.__undef__,k[q]);else i(j,k);h[1]=n,m.clearIncludePromise(d),a.resolve(h[1]),o=[j,k],g(f,h,o),!o.__do_ready__&&p&&c.isFunction(p.readyInclude)&&(c.def(o,"__do_ready__",!0),p.readyInclude.apply(p,o))})}(G,D,C,f,A),G.promise()}this.clearIncludePromise(D),g(f,A)},rendered:function(){var a=this.getOption("rendered"),b=c.__aslice.call(arguments),d=b;if(c.isFunction(a)){var e;try{d=a.apply(this.getContext()||this,b),c.isArray(d)||(d=b),e=d[0],d[1]}catch(a){var f=this.makeError("callback",["rendered",a.message],a);d[0]=c.concatError(e,f)}}return d},compile:function(a,b){function d(h){try{return g.prototype!==this.utils&&(d.prototype=g.prototype=this.utils),g.__tag_source__&&(h=c.extend({},h,g.__tag_source__)),new g(h,b)+""}catch(c){return e.debug?c:(e.debug=!0,f.compile(a,b)(h))}}var e=this.__options__||{},f=this;try{var g=this.compiler(a)}catch(a){return a.filename=b||"anonymous",a.name="Syntax Error",function(){return a}}return d.prototype=g.prototype,d.toString=function(){return g.toString()},b&&e.cache&&(n.cache[b]=d),d},compiler:function(a){function b(a){var b="";return n.each(a.split(n.REGEXP_COMMENT_START),function(a){a=a.split(n.REGEXP_COMMENT_END);var c=a[0],d=a[1];1===a.length?b+=c:b+=d}),b}function d(a){for(var b,c,d,e=0;null!=(b=n.REGEXP_TAG_SOURCE.exec(a));)d="__TEMPLATE_TAG_SRC_"+e+"__",c=c||{},c[d]=b[0],d="{{"+d+"}}",a=a.substring(0,b.index)+d+a.substring(n.REGEXP_TAG_SOURCE.lastIndex),n.REGEXP_TAG_SOURCE.lastIndex=b.index+d.length+1,e++;return{source:a,map:c}}function e(a){return s+=a.split(/\n/).length-1,q&&(a=a.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),a&&(a=v[1]+h(a)+v[2]+"\n"),a}function f(a){var b=s;if(c.isFunction(i)?a=j.parser(a,k):l&&(a=a.replace(/\n/g,function(){return"$line="+ ++s+";"})),0===a.indexOf("=")){var d=r&&!/^=[=#]/.test(a);if(a=a.replace(/^=[=#]?|[\s;]*$/g,""),d){var e=a.replace(/\s*\([^\)]+\)/,"");j.utils[e]||/^(include|print)$/.test(e)||(a="$escape("+a+")")}else a="$string("+a+")";a=v[1]+a+v[2]}return l&&(a="$line="+b+";"+a),n.each(g(a),function(a){if(a&&!t[a]){var b;b="print"===a?w:"include"===a?x:j.utils[a]?"$utils."+a:j.utils.$helpers[a]?"$helpers."+a:"$data."+a,y+=a+"="+b+",",t[a]=!0}}),a+"\n"}function g(a){return a.replace(n.REGEXP_OBJECT_KEY,"{'$1':").replace(n.REGEXP_REMOVE,"").replace(n.REGEXP_SPLIT,",").replace(n.REGEXP_KEYWORDS,"").replace(n.REGEXP_NUMBER,"").replace(n.REGEXP_BOUNDARY,"").split(n.REGEXP_SPLIT2)}function h(a){return"'"+(null==a?"":a+"").replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}var i,j=this,k=j.__options__,l=k.debug,m=k.openTag,o=k.closeTag,p=k.comment,q=k.compress,r=k.escape;i=c.isFunction(k.parser)?k.parser:this.parser;var s=1,t={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},u="".trim,v=u?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],w="function(){var text=''.concat.apply('',arguments);return text;}",x="function(filename,data){var args=Array.prototype.slice.call(arguments);args.push($data,$filename);var text=$utils.$include.apply($utils,args);return text;}",y="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(l?"$line=0,":""),z=v[0],A="return new String("+v[3]+");";a=c.trim(a),p||(a=b(a));var B=d(a);a=B.source,n.each(a.split(m),function(a){a=a.split(o);var b=a[0],c=a[1];1===a.length?z+=e(b):n.REGEXP_MAIN_OPEN.test(b)&&n.REGEXP_MAIN_CLOSE.test(c)?(z+=e(b.replace(n.REGEXP_MAIN_OPEN,"{{{")),z+=e(c.replace(n.REGEXP_MAIN_CLOSE,"}}}"))):(z+=f(b),c&&(z+=e(c)))});var C=y+z+A;l&&(C="try{"+C+"}catch(e){$line = $line || 0;var $source = "+h(a)+";throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:($line?$source.split(/\\n/)[$line-1]:$source).replace(/^\\s+/,'')};}");try{var D=new Function("$data","$filename",C);return D.prototype=j.utils,c.def(D,"__tag_source__",B.map),D}catch(a){throw a.temp="function anonymous($data,$filename) {"+C+"}",a}},parser:function(a,b){if(b=b||this.__options__||{},c.isFunction(b.parser)){var d;try{d=b.parser.apply(this.getContext()||this,arguments)}catch(b){n.Event.trigger("Error",this.makeError("callback",["parser",b.message],b)),d=a}return d}a=a.replace(/^\s/,"");var e=a.split(" "),f=e.shift(),g=e.join(" ");switch(f){case"if":a="if("+g+"){";break;case"else":e="if"===e.shift()?" if("+e.join(" ")+")":"",a="}else"+e+"{";break;case"/if":a="}";break;case"each":var h=e[0]||"$data",i=e[1]||"as",j=e[2]||"$value",k=e[3]||"$index",l=j+","+k;"as"!==i&&(h="[]"),a="$each("+h+",function("+l+"){";break;case"/each":a="});";break;case"echo":a="print("+g+");";break;case"print":case"include":a=f+"("+e.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(g)){var m=!0;0===a.indexOf("#")&&(a=a.substr(1),m=!1);for(var o=0,p=a.split("|"),q=p.length,r=p[o++];o<q;o++)r=n.filtered(r,p[o]);a=(m?"=":"=#")+r}else a=this.utils.$helpers[f]?"=#"+f+"("+e.join(",")+");":"="+a}return a},makeError:function(a,b,d){var e=this.__error_maker__;return e||(c.def(this,"__error_maker__",c.errorMaker(n.Error,this.getContext())),e=this.__error_maker__),e.apply(this,arguments)}},n.toString=function(a,b){return c.isString(a)||(b=typeof a,"number"===b?a+="":a="function"===b?n.toString(a.call(a)):""),a},n.ESCAPE_MAP={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},n.escapeFn=function(a){return n.ESCAPE_MAP[a]},n.escapeHTML=function(a){return n.toString(a).replace(/&(?![\w#]+;)|[<>"']/g,n.escapeFn)},n.each=function(a,b){var d,e;if(c.isArray(a))for(d=0,e=a.length;d<e;d++)b.call(a,a[d],d,a);else for(d in a)b.call(a,a[d],d)},n.filtered=function(a,b){var c=b.split(":"),d=c.shift(),e=c.join(":")||"";return e&&(e=", "+e),"$helpers."+d+"("+a+e+")"},n.normalizeData=function(a){return c.notNull(a)?!c.isArray(a)&&c.isObject(a)||(a={data:a}):a={},a},n.remote=function(a,d){var e=b.Deferred();a=c.trim(a);var f,h=this;try{f=this.__context__||this||{}}catch(a){f={}}return function(a,d,e,f){function i(a){var d=c.trim(a),e={},f=a.lastIndexOf("?");return f>-1&&(d=a.substring(0,f),e=b.parseQuery(a)),a=c.getRequireUrl(d),k.cache||c.extend(e,{bust:c.timestamp()}),e=b.param(e),a+=e?"?"+e:""}c.isFunction(e)&&a.done(function(a,b){try{e.apply(this,arguments),c.normalizeCallbackArgs(e,arguments)}catch(a){n.Event.trigger("CallbackError",h.makeError("callback",["remote callback",a.message],a))}});var j,k;if(k=h&&h.__options__?h.__options__:n.DEFAULTS,k.cache&&!c.isUndef(j=n.remoteCache[d]))a.resolve(c.__undef__,{filename:d,source:j});else{var l=i(d);d=0==l.indexOf(m)?l.substring(m.length-1):l;var o,p;p=k.remote?k.remote:n.DEFAULTS.remote,f.ajax instanceof g?o=f.ajax:(n.ajax||(n.ajax=new g(n.DEFAULTS.remote)),o=n.ajax),l=c.extend({},p,{url:l}),o.get(l,function(b,e){b&&c.isFunction(this.removeError)&&this.removeError(b),b||c.isUndef(e)?b=h.makeError("remote_error",[d],b):(j=c.trim(e),k.cache&&(n.remoteCache[l]=j)),a.resolve(b,{filename:d,source:j})})}}(e,a,d,f),e.promise()},n.makeError=function(){return n.Error.make.apply(n.Error,arguments)},n}),define("yfjs/spa/util/template-helpers",["./helpers"],function(a){var b=a.JSON;return{trim:function(b){return a.trim(b)},trimLeft:function(b){return a.trimLeft(b)},trimRight:function(b){return a.trimRight(b)},otype:function(b){return a.otype(b)},is$:function(b){return a.is$(b)},isUndef:function(b){return a.isUndef(b)},eqNull:function(b){return a.eqNull(b)},isNull:function(b){return a.isNull(b)},notNull:function(b){return a.notNull(b)},isNumber:function(b){return a.isNumber(b)},isBoolean:function(b){return a.isBoolean(b)},isString:function(b){return a.isString(b)},isObject:function(b){return a.isObject(b)},isPlainObject:function(b){return a.isPlainObject(b)},isArray:function(b){return a.isArray(b)},isFunction:function(b){return a.isFunction(b)},isEmpty:function(b){return a.isEmpty(b)},inArray:function(b,c){return a.inArray(b,c)},stringify:function(c){return a.notNull(c)?a.isObject(c)?b.stringify(c):a.trim(c):""},parseJSON:function(c){return c=a.trim(c),c.length?b.parse(c):{}}}}),define("yfjs/spa/util/view",["../version","./helpers","./event","./error","./widget"],function(a,b,c,d,e){var f="View",g=e({NAMESPACE:f,VERSION:a(f),DEFAULTS:{layout:b.__undef__},CONTAINER_ID:"app-view",BIND_KEY:"data-view",Event:c(f),Error:d(f),defaultState:function(a){return a||{}}});return g.Error.translate({script_unfound:"加载 {0} 视图失败。找不到依赖文件或模块 {1}",script_timeout:"加载 {0} 视图失败。依赖文件或模块 {1} 加载超时",script_error:"加载 {0} 视图失败。文件 {1} 存在错误：{2}",script_invalid_return:"加载 {0} 视图失败。视图文件 {1} 必须明确返回视图实例",callback:"执行 {0} 视图的 {1} 时发生了错误: {2}",style_unfound:"视图 {0} 错误。{1}",load_fail:"加载 {0} 视图失败。{1}"}),g.Error.translate("setter","视图 {0} 设置错误。无法设置实例属性 {1}，因为它是视图实例的固有属性"),g.Error.translate("include_limit","视图 {0} 模板引入错误。引入 {1} 时超过最大引入层数（"+e.INCLUDE_LEVEL_LIMIT+"）限制"),g}),define("yfjs/spa/util/websocket",["../version","jquery","./helpers","./history","./event","./error"],function(a,b,c,d,e,f){var g=c.JSON,h=c.window.WebSocket||c.window.MozWebSocket,i=function(a,b){if(!(this instanceof i))return new i(a,b);c.def(this,"__options__",c.extend({},i.DEFAULTS,a)),c.def(this,"__context__",b),c.def(this,"__ws__",[])};return i.NAMESPACE="WebSocket",i.VERSION=a(i.NAMESPACE),i.DEFAULTS={base:"/",respFilter:c.__undef__,mode:"mock",urls:{}},i.REGEXP_PROTOCOL_START=c.REGEXP_PROTOCOL_START,i.REGEXP_PROTOCOL_WS_START=c.REGEXP_PROTOCOL_WS_START,i.REGEXP_SECURE_PROTOCOL_START=c.REGEXP_SECURE_PROTOCOL_START,i.REGEXP_SLASH_START=c.REGEXP_SLASH_START,i.REGEXP_SLASH_END=c.REGEXP_SLASH_END,i.config=c.configurator.call(i,i.DEFAULTS),i.Event=e(i.NAMESPACE),i.Error=f(i.NAMESPACE),i.Error.translate({unsupported:"当前环境不支持 WebSocket",initialized:"初始化 WebSocket 失败：{0}",callback:"执行 WebSocket 的 {0} 时发生了错误：{1}",ws_error:"WebSocket 发生了错误：{0}"}),i.prototype={setOption:c.optionSetter(i.DEFAULTS),getOption:c.optionGetter(),getOptions:c.optionsGetter(),getContext:function(){return this.__context__},open:function(a,d){var e,f,j=this.normalizeOptions(a),k=this,l=function(a){function j(b,d){var e;try{e=g.parse(b.data)}catch(a){e=b.data}var f=["error"===d?c.setPropsRecursive(k.makeError("ws_error",[e.message||e]),s):c.__undef__,e,t],h=[].concat(f);if(c.isFunction(a.respFilter))try{h=a.respFilter.apply(q,f),c.isArray(h)?h[2]!==f[2]&&(h[2]=f[2]):h=[].concat(f)}catch(a){var i=c.setPropsRecursive(k.makeError("callback",["respFilter",a.message],a),s);h[0]=h[0]?[i].concat(h[0]):i}m.apply(q,h)}function m(){var a,b=c.__aslice.call(arguments);if(e=c.__undef__,n.call(this,b[0]),c.isFunction(d))try{d.apply(this,b),c.normalizeCallbackArgs(d,b)}catch(b){a=c.setPropsRecursive(k.makeError("callback",["callback",b.message],b),s),n(a)}o.call(this)}function n(a){if(!c.isEmpty(a)){var b=this;c.notNull(b)&&c.isFunction(b.addError)&&b.addError(a),e=e?c.isArray(a)?a.concat(e):[a].concat(e):a}}function o(){var a,b=this;a=c.notNull(b)&&c.isFunction(b.sliceError)?b.sliceError(c.extend({NS:i.NAMESPACE},r)):e,c.isEmpty(a)||i.Event.trigger("Error",a)}if(c.isArray(a))b.each(a,function(a,b){l(b)});else if(c.notNull(a)){var p,q=k.getContext()||a,r={__caller_name__:"ws.open"},s=r;if(h||f){var t;try{if(!(t=new h(a.url)))return k;k.__ws__.push(t),t.onopen=function(a){t.onerror=function(a){j(a,"error")},t.onmessage=function(a){j(a)},t.onclose=function(a){}}}catch(a){t=c.__undef__,p=c.setPropsRecursive(k.makeError("initialized",[a.message],a),s),m.call(q,p)}}else p=c.setPropsRecursive(k.makeError("unsupported"),s),f=!0,m.call(q,p)}};return l(j),this},close:function(a){function d(a){return a&&c.isFunction(a.close)}if(d(a)){try{a.close()}catch(a){}this.clear(a)}else{var e=this,f=[].concat(this.__ws__);b.each(f,function(a,b){d(b)?e.close(b):b&&e.clear(b)})}},clear:function(a){if(a){var b;(b=c.inArray(a,this.__ws__))>-1&&this.__ws__.splice(b,1)}else c.isUndef(a)&&this.__ws__.splice(0,this.__ws__.length)},normalizeOptions:function(a){var e=this,f=function(a,g){var h;if((g=g||0)>1e3)return h;if(c.isArray(a))g+=1,b.each(a,function(a,b){(b=f(b,g))&&(h=h||[],h=h.concat(b))});else{if(a&&a.__normalized__)return a;if(h=e.getOptions(),c.isPlainObject(a)?c.extend(!0,h,a):c.extend(!0,h,{name:a?c.trim(a):c.__undef__}),!h.url&&h.urls&&h.name&&h.mode){var j;(j=h.urls[name])&&(h.url=j[h.mode])}if(delete h.urls,h.url=c.trim(h.url||h.name),!h.url)return c.__undef__;var k=function(a){return a=a.replace(i.REGEXP_SECURE_PROTOCOL_START,"wss://"),a=a.replace(i.REGEXP_PROTOCOL_START,"ws://")};i.REGEXP_PROTOCOL_WS_START.test(h.url)||(i.REGEXP_PROTOCOL_START.test(h.url)||(h.base=h.base||"/",i.REGEXP_SLASH_END.test(h.base)||(h.base+="/"),i.REGEXP_PROTOCOL_START.test(h.base)||(h.base=d.getRootUrl()+h.base.replace(i.REGEXP_SLASH_START,"")),h.url=h.url.replace(i.REGEXP_SLASH_START,"").replace(/\/{2,}/,"/"),0!=h.url.indexOf(h.base)&&(h.url=h.base+h.url)),h.url=k(h.url)),delete h.base,c.def(h,"__normalized__",!0)}return h};return f(a)},makeError:function(a,b,d){var e=this.__error_maker__;return e||(c.def(this,"__error_maker__",c.errorMaker(i.Error,this.getContext())),e=this.__error_maker__),e.apply(this,arguments)}},i}),define("yfjs/spa/util/widget",["../version","jquery","./helpers","./event","./error","./remote","./template","./ajax","./websocket","./style-loader","./cookie","../ui/loading"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){if(!(this instanceof m))return new m(a);a=c.extend({},m.PROPERTIES,a),a.DEFAULTS=a.DEFAULTS||{};var b,d=m.PROPERTIES.DEFAULTS||{};for(b in d)c.isUndef(a.DEFAULTS[b])&&c.__hasOwn.call(d,b)&&(a.DEFAULTS[b]=d[b]);a.NAMESPACE=c.trim(a.NAMESPACE)||m.PROPERTIES.NAMESPACE;for(b in a)c.__hasOwn.call(a,b)&&c.def(this,b,a[b],{writable:!1,configurable:"PREFIX_CSS_INCLUDE"===b});p=this.NAMESPACE.toLowerCase(),c.def(this,"CONTAINER","#"+this.CONTAINER_ID,{writable:!1,configurable:!1}),this.Error instanceof e&&(this.Error.translate({instantiated:this.NAMESPACE+" 的构造器对象必须通过 "+this.NAMESPACE+" 的实例对象进行实例化",initialized:this.NAMESPACE+" 的实例对象必须通过 "+this.NAMESPACE+" 的初始器对象进行实例化",param_invalid:"执行 "+this.NAMESPACE+".{0} 时发生了错误：缺少 {0} 参数"}),this.Error.translate("callback_"+p,"执行 "+this.NAMESPACE+" 的 {0} 时发生了错误: {1}")),c.def(this,"LAST_INSTANCE",null,{writable:!1,configurable:!0}),c.def(this,"LAST_$STYLE",null,{writable:!1,configurable:!0}),c.def(this,"INCLUDE_WIDGET",this,{writable:!1,configurable:!0})}function n(a,b,d){function e(a){var b=-1;if(c.isNull(a))return b;for(var d,e=0;e<r.__includes__.length;e++)if(d=r.__includes__[e]||{},d.id===a.id){b=e;break}return b}var f="";if(this.isDestroyed()||this.isDispose())return f;var h,i=this.__widget__.INCLUDE_WIDGET||this,j=this.getState("level")||1;if(j>=m.INCLUDE_LEVEL_LIMIT)return h=this.makeError("include_limit",[this.getPath(),a]),this.addError(h),this.afterState("beforeLoad")&&i.Event.trigger("Error",h),f;var k=c.__aslice.call(arguments),n=k.pop(),o=k.pop();if(!k[0]||!(k[0]=c.trim(k[0])))return h=g.Error.make("param_invalid",["include","path"]),this.addError(h),
this.afterState("beforeLoad")&&i.Event.trigger("Error",h),f;var p,q,r=this,s=k[0];k.length>2?(p=b,q=d):c.inArray(k[1],m.INCLUDE_MODE)>-1?(p={},q=k[1]):p=k[1]||{},c.inArray(q,m.INCLUDE_MODE)<0&&(q=m.INCLUDE_MODE[0]);var t;t=c.notNull(n)&&/\//.test(n)?i.trimTemplatePath(n):this.getPath(),s=c.toUrl(s,null,t);var u=i.normalizeState(s);if(!u||!u.path)return h=g.Error.make("param_invalid",["include","path"]),this.addError(h),this.afterState("beforeLoad")&&i.Event.trigger("Error",h),f;var v={};c.def(v,"context",this,{writable:!1,configurable:!1}),c.def(v,"mode",q,{writable:!1,configurable:!1});var w;if(p)for(w in p)u.param[w]=p[w];var x=this.getParams();for(w in x)c.__hasOwn.call(u.param,w)||(u.param[w]=x[w]);c.extend(u.data,{$include:o});var y=c.isEmpty(n)?this.getState("name"):n,z=this.template.includeIndex(y);c.def(v,"id",z,{writable:!1,configurable:!1});var A=this.getState("id");i.instanceof(this.__layout__,i.Creator)&&(A=this.__layout__.getState("id")+(A?"-"+A:"")),A&&(z=A+"-"+z),c.def(u,"id",z,{writable:!1,configurable:"script"!=u.type}),c.def(u,"level",j+1,{writable:!1,configurable:!1});var B=i.CONTAINER_ID+"-"+u.id;c.def(u,"container","#"+B,{writable:!1,configurable:!1});var C="__body_"+(u.id+"").replace(/\-/g,"_")+"__";c.def(v,"body",C,{writable:!1,configurable:!1}),c.def(u,"include",v,{writable:!1,configurable:!1});var D=e(u);if(D>-1?this.__includes__.splice(D,1,u):this.__includes__.push(u),"include"===q)return this.template.setIncludePromise(i.include(u,this.__included__),y),"{{{"+C+"}}}";this.template.setIncludePromise(null,y);var E=i.PREFIX_CSS_INCLUDE+c.stylePathId(u.name);if("lazy"===q){var F,G=this.get("loading")||{};return(F=G.html)&&(c.isFunction(F)&&(F=F.call(this)),F=l.wrap("include-"+u.id,"include")(F)),i.wrap(u.name,B)(F,E)}return i.wrap(u.name,B)("",E)}var o=c.LOCAL_ROOT;m.NAMESPACE="Widget",m.VERSION=a(m.NAMESPACE);var p=m.NAMESPACE.toLowerCase();return m.PROPERTIES={NAMESPACE:m.NAMESPACE,VERSION:m.VERSION,DEFAULTS:{title:c.__undef__,template:c.__undef__,data:{},dataFilter:c.__undef__,rendered:c.__undef__,style:c.__undef__,binds:c.__undef__,loading:{html:'<div class="loader center-block"></div>'},cache:c.__undef__,styleLoader:c.__undef__,mode:c.__undef__,ajax:c.__undef__,websocket:c.__undef__,cookie:c.__undef__,statechange:c.__undef__,beforeCreate:c.__undef__,created:c.__undef__,beforeLoad:c.__undef__,loaded:c.__undef__,beforeReady:c.__undef__,ready:c.__undef__,beforeDestroy:c.__undef__,destroyed:c.__undef__,errorFilter:c.__undef__,onError:c.__undef__},PREFIX_PATH_SCRIPT:"app/views",PREFIX_PATH_TEMPLATE:"app/templates",PREFIX_PATH_STYLE:"app/styles",PREFIX_CSS_INCLUDE:"app-include_",CONTAINER_ID:"app-"+p,BIND_KEY:"data-"+p,Event:d(m.NAMESPACE),Error:e(m.NAMESPACE),REGEXP_PROTOCOL_START:c.REGEXP_PROTOCOL_START,REGEXP_DSLASH_START:c.REGEXP_DSLASH_START,REGEXP_SLASH_START:c.REGEXP_SLASH_START,REGEXP_SLASH_END:c.REGEXP_SLASH_END,REGEXP_RELATIVE_START:c.REGEXP_RELATIVE_START,REGEXP_HASH_START:c.REGEXP_HASH_START,REGEXP_HASH_PATH_START:c.REGEXP_HASH_PATH_START,defaultState:function(a){return a},defaultTemplate:function(a){return a}},m.INCLUDE_MODE=["include","lazy","trigger"],m.INCLUDE_LEVEL_LIMIT=1e3,m.STATE=["BEFORE_CREATE","CREATED","BEFORE_LOAD","LOADED","BEFORE_READY","READY","BEFORE_DESTROY","DESTROYED"],m.STATE[-1]="DISPOSE",m.STATE_INDEX={},b.each(m.STATE,function(a,b){m.STATE_INDEX[b]=a}),m.updateState=c.stateUpdater(m.STATE,m.STATE_INDEX),m.prototype.config=function(a,b){return this.__configurator__||c.def(this,"__configurator__",c.configurator.call(this,this.DEFAULTS)),this.__configurator__.apply(this,arguments)},m.prototype.ID=0,m.prototype.uuid=function(){return m.ID=c.increaseId(m.ID),m.ID},m.prototype.instanceof=function(a,b){b=b||this.Launcher;try{return a instanceof b}catch(a){return!1}},m.prototype.isChanged=function(a){var b=this.LAST_INSTANCE;return this.instanceof(a)?!this.instanceof(b)||(a.getInitializer()!==b.getInitializer()||a.getState("hash")!==b.getState("hash")):a!==b},m.prototype.setLastStyle$=function(a){if(c.isUndef(a))c.def(this,"LAST_$STYLE",null);else if(c.is$(a)){var d=this.LAST_$STYLE;c.is$(d)||(d=b([])),d=d.add(a),c.def(this,"LAST_$STYLE",d)}return this},m.prototype.removeStyle$=function(a,d){var e=this;if(c.is$(a)){var f,g=b([]),h=b(c.document.head||"head");if(d)try{f=b(d)}catch(a){f=h}f&&f.length||(f=h),a.each(function(){var a=b(this),c="#"+a.attr("id")+"["+e.BIND_KEY+'="'+a.attr(e.BIND_KEY)+'"]';g=g.add(b(c,f))}),g.remove()}return this},m.prototype.load=function(a,d){var e=this,f=b.Deferred();return a=this.normalizeState(a),function(a,d,f){if(c.isFunction(f)&&a.done(function(a,b){try{f.apply(e,arguments)}catch(a){e.Event.trigger("CallbackError",e.Error.make("callback_"+p,["loadCallback",a.message],a))}}),d){var h=b.Deferred();c.assignDeferred(a,h);var i=d&&"script"==d.type,k=d&&"style"==d.type,l=d&&!i&&!k,n=!!d.include&&e.instanceof(d.include.context,e.Creator),q=n?d.include.context:null;if(h.done(function(b,f){var g=[b];e.instanceof(f)||(f=f||{},f.state=f.state||d,l||k?(c.extend(f,{wrap:e.wrap(d.name,d.container?d.container.replace(e.REGEXP_HASH_START,""):c.__undef__)}),l?c.extend(f,{html:e.wrapTemplate(d.name,d.id)(f.source)}):c.isUndef(f.source)?c.extend(f,{html:f.html}):c.extend(f,{html:e.wrapStyle(d.name,d.id)(f.source)})):c.extend(f,{wrap:e.wrap()})),g.push(f),c.disposeDeferred(a,!1),a.resolve.apply(a.resolve,g)}),d.path)if(i){var r=e.normalizeScriptPath(d.path);require([r],function(b){if(a.__rejected__)return void h.reject();if(e.instanceof(b,e.Initializer)){c.isUndef(d.id)&&c.def(d,"id",e.uuid(),{writable:!1,configurable:!1}),c.isUndef(d.level)&&c.def(d,"level",1,{writable:!1,configurable:!1}),c.def(d,"label",m.STATE[0],{writable:!1,configurable:!0});var f=new e.Creator(b,d,e);h.resolve(c.__undef__,new e.Launcher(f,e))}else h.resolve(e.Error.make("script_invalid_return",{level:e.Error.LEVEL_PAGE,args:[d.path,r+".js"]}))},function(b){var f=b.requireModules&&b.requireModules[0];if(f&&requirejs.undef(f),a.__rejected__)return void h.reject();var g;try{g=require.toUrl(f)||"";var i=g.indexOf("?");i>-1&&(g=g.substring(0,i))}catch(b){g=f}g=g||"",0==g.indexOf(o)&&(g=g.substring(o.length-1));var j,k,l=b.originalError,m=l&&l.error?l.error:b;l&&c.notNull(l.lineno)&&(k=["line "+l.lineno],c.notNull(l.colno)&&k.push("col "+l.colno),k=k.join(", ")),/^Error$/i.test(m.name)?(j=m.message+"",h.resolve(e.Error.make(j.indexOf("timeout")>-1?"script_timeout":"script_unfound",{level:e.Error.LEVEL_PAGE,args:[d.path,g+".js"]},m))):(j=m.name?m.name+" - "+m.message:m.message+"",j+=k?" (at "+k+")":"",h.resolve(e.Error.make("script_error",{level:e.Error.LEVEL_PAGE,args:[d.path,g+".js",j]},m)))})}else if(k){var s=e.normalizeStylePath(d.url);if(s&&(s=s[0])){var t;t=n?q.styleLoader:j,t.load(s,function(b,f){if(a.__rejected__)return void h.reject();f.filename&&(f.filename=c.trim(f.filename))?c.def(d,"id",c.encodeIdFromURI(f.filename),{writable:!1,configurable:!1}):c.def(d,"id",d.name,{writable:!1,configurable:!1}),n&&c.def(d,"name",q.getState("name"),{writable:!1,configurable:!1}),b&&n&&(b=e.Error.make("style_unfound",{NS:j.NAMESPACE,args:[d.path,b.message],level:e.Error.LEVEL_CONSOLE},b)),h.resolve(b,f)})}else h.resolve(c.__undef__,{wrap:e.wrap()})}else{var u,v=e.normalizeTemplatePath(d.path);u=n?q.template:g,u.remote(v,function(b,e){if(a.__rejected__)return void h.reject();c.def(d,"id",d.name,{writable:!1,configurable:!1}),n&&c.def(d,"name",q.getState("name"),{writable:!1,configurable:!1}),e&&(e.state=d),h.resolve(b,e)})}else h.resolve(e.Error.make("param_invalid",{level:e.Error.LEVEL_PAGE,args:["load","state.path"]}))}else a.resolve(c.__undef__,{wrap:e.wrap()})}(f,a,d),f},m.prototype.include=function(a,d,e){function f(a){var b=a?a.id:"",e=-1;if(b&&c.isArray(d))for(var f,g=0;g<d.length;g++)if(f=d[g],h.instanceof(f)&&f.getState("id")==b){e=g;break}return e}function g(a,b){if(c.isEmpty(a))return c.__undef__;a=c.setPropsRecursive(a,c.extend({__caller_name__:p+".include",state:h.instanceof(this)?this.getState():this.state},b));var d=c.sliceError(a,{level:h.Error.LEVEL_CONSOLE});return a=c.concatError(a,c.setPropsRecursive(c.shiftError(a,d),{level:h.Error.LEVEL_WIDGET}))}var h=this.INCLUDE_WIDGET||this;c.isFunction(d)&&(e=d,d=[]),c.isFunction(a)&&(e=a,a=null);var i=b.Deferred();return function(a,b,e){function i(b,d){d&&(d.context=this,d.widget=h);var e=this.getInstance(),f=h.instanceof(e.context,h.Creator)?e.context.getLayout():null;h.instanceof(f,h.Creator)?c.def(e,"__layout__",f):c.def(e,"__layout__",null),b=g.call(this,b,{context:e}),a.resolve(b,d)}if(c.isFunction(e)&&a.done(function(a,c){try{e.apply(h,arguments)}catch(a){var d;d=h.validIncludedState(b)?b.include.context.makeError("callback",[b.include.context.getPath(),"includeCallback",a.message],a):h.Error.make("callback_"+p,["includeCallback",a.message],a),h.Event.trigger("CallbackError",d)}}),h.validIncludedState(b)){var j,k=f(b);k>-1&&(j=d[k]),h.instanceof(j)?j.dispose().reset(b).load(i):h.load(b,function(b,d){if(c.isEmpty(b))if(h.instanceof(d)){var e=d.getState("include"),f=e?e.context:null;h.instanceof(f,h.Creator)&&(c.def(d.getInstance(),"context",f),f.__included__.push(d)),d.load(i)}else d.widget=h,a.resolve(c.__undef__,d);else d.widget=h,b=g.call(d,b),a.resolve(b,d)})}else a.resolve()}(i,a,e),i},m.prototype.includeAll=function(a,d,e){var f=this.INCLUDE_WIDGET||this;c.isFunction(d)&&(e=d,d=[]),c.isFunction(a)&&(e=a,a=[]),a=a||[],c.isArray(a)||(a=[a]),d=d||[],c.isArray(d)||(d=[d]);var g=b.Deferred(),h=[];return b.each(a,function(a,b){h.push(f.include(b,d))}),function(a,d,e){c.isFunction(e)&&a.done(function(a,b){try{e.apply(f,arguments)}catch(a){f.Event.trigger("CallbackError",f.Error.make("callback_"+p,["includeAllCallback",a.message],a))}}),d.length?b.when.apply(b.when,d).done(function(){var e,f,g=c.__aslice.call(arguments);d.length>1?b.each(g,function(a,b){c.isUndef(b[0])||(e=e||new Array(d.length),e[a]=b[0]),c.isUndef(b[1])||(f=f||new Array(d.length),f[a]=b[1])}):(e=g[0],f=g[1]),a.resolve(e,f)}):a.resolve()}(g,h,e),g},m.prototype.includeAsync=function(a,d,e){var f=this.INCLUDE_WIDGET||this;c.isFunction(d)&&(e=d,d=[]),c.isFunction(a)&&(e=a,a=[]),a=a||[],c.isArray(a)||(a=[a]),d=d||[],c.isArray(d)||(d=[d]);var g;return b.each(a,function(a,b){g=g||[],g.push(f.include(b,d,e))}),g},m.prototype.sliceIncludes=function(a,d){var e=this.INCLUDE_WIDGET||this,f=[];a=a||[],c.isArray(a)||(a=[a]);var g={};return c.notNull(d)&&(c.isArray(d)?g.mode=d:c.isObject(d)?c.extend(g,d):g.id=c.trim(d)),g.mode=g.mode||m.INCLUDE_MODE||[],c.isArray(g.mode)||(g.mode=[g.mode]),b.each(a,function(a,b){e.validIncludedState(b)&&c.inArray(b.include.mode,g.mode)>-1&&(!g.id||g.id==b.id||g.id==b.name)&&f.push(b)}),f},m.prototype.validIncludedState=function(a){var b=this.INCLUDE_WIDGET||this;return a&&a.include&&b.instanceof(a.include.context,b.Creator)},m.prototype.normalizeState=function(a){if(c.isEmpty(a))return this.defaultState(a);if(a.__normalized__)return a;var d={};a=c.isObject(a)?c.extend({},a):{path:c.trim(a)};var e=decodeURIComponent(a.hash||a.path||""),f=e,g=e.indexOf("#");if(this.REGEXP_DSLASH_START.test(f)&&(f=o+f),this.REGEXP_PROTOCOL_START.test(f)){c.def(d,"url",f,{writable:!1,configurable:!1}),f=f.replace(this.REGEXP_PROTOCOL_START,"").replace(this.REGEXP_SLASH_START,"");var h=f.indexOf("/");h>-1&&(f=f.substring(h)),e=g>-1?e.substring(g):""}else g>-1&&(f=e.substring(g+1),e=e.substring(g)),e&&(this.REGEXP_HASH_START.test(e)||(e="#"+e),this.REGEXP_HASH_PATH_START.test(e)||(e=e.replace(this.REGEXP_HASH_START,"#/"))),c.def(d,"url",e.replace(this.REGEXP_HASH_START,""),{writable:!1,configurable:!1});c.def(d,"hash",e,{writable:!1,configurable:!1});var i,j=f.indexOf("?");j>-1&&(i=b.parseQuery(f),f=f.substring(0,j)),this.REGEXP_SLASH_START.test(f)||(f="/"+f),f=f.replace(this.REGEXP_SLASH_END,"");var k,l=f.lastIndexOf("."),m=f.lastIndexOf("/");l>-1&&l>m&&(k=f.substring(l+1),f=f.substring(0,l)),k=c.isEmpty(k)?"js":c.trim(k).toLowerCase(),c.def(d,"suffix",k,{writable:!1,configurable:!1});var n;return n="js"==d.suffix?"script":"css"==d.suffix||"less"==d.suffix||"scss"==d.suffix?"style":"template",c.def(d,"type",n,{writable:!1,configurable:!1}),"style"===d.type&&(f+="."+k),c.def(d,"name",c.encodeIdFromURI(f),{writable:!1,configurable:"script"!=n}),c.def(d,"path",f,{writable:!1,configurable:!1}),c.def(d,"param",c.extend({},i),{writable:!1,configurable:!1}),c.def(d,"data",c.extend({},a.data),{writable:!1,configurable:!1}),c.def(d,"__normalized__",!0),d},m.prototype.normalizeScriptPath=function(a){return a?0==a.indexOf(this.PREFIX_PATH_SCRIPT+"/")?a:(this.REGEXP_SLASH_START.test(a)||(a="/"+a),this.PREFIX_PATH_SCRIPT+a):""},m.prototype.normalizeTemplatePath=function(a){if(!a)return"";var b,c=a.lastIndexOf("?");c>-1&&(b=a.substring(c),a=a.substring(0,c));var d=a.lastIndexOf(".");return-1==d?a+=".html":d==a.length-1&&(a+="html"),b&&(a+=b),0==a.indexOf(this.PREFIX_PATH_TEMPLATE+"/")?a:(this.REGEXP_SLASH_START.test(a)||(a="/"+a),this.PREFIX_PATH_TEMPLATE+a)},m.prototype.trimTemplatePath=function(a){var b=c.trim(a);if(b.length){var d=c.getRequireUrl(this.PREFIX_PATH_TEMPLATE);0==d.indexOf(c.LOCAL_ROOT)&&(d=d.substring(c.LOCAL_ROOT.length-1)),0==b.indexOf(d)&&(b=this.REGEXP_SLASH_END.test(d)?b.substring(d.length-1):b.substring(d.length));var e=b.lastIndexOf(".");e>-1&&(b=b.substring(0,e))}return b},m.prototype.normalizeStylePath=function(a){if(a){var d=this,e=function(f,g){var h;return(g=g||0)>1e3?h:(c.isArray(f)?(g+=1,b.each(f,function(a,b){(b=e(b,g))&&(h=h||[],h=h.concat(b))})):c.isEmpty(f)||(f=c.trim(f),d.REGEXP_DSLASH_START.test(f)?f=c.LOCAL_PROTOCOL+f:d.REGEXP_PROTOCOL_START.test(f)||(d.REGEXP_SLASH_START.test(f)||(f="/"+f),0!=a.indexOf(d.PREFIX_PATH_STYLE+"/")&&(f=d.PREFIX_PATH_STYLE+f),f=c.getRequireUrl(f)),h=h||[],h.push(f)),h)};return e(a)}},m.prototype.wrap=function(a,d,e){var f=e||this.BIND_KEY,g=a||"undefined";return d=d||this.CONTAINER_ID,function(a,e){e=c.trim(e);var h="<div"+(c.isEmpty(e)?"":' class="'+e+'"')+' id="'+d+'" '+f+'="'+g+'"></div>',i=b(h);return i.html(a||""),c.html2str(i)||h}},m.prototype.wrapTemplate=function(a,d,e){var f=e||this.BIND_KEY,g=a||"undefined";return d=d||this.CONTAINER_ID,function(a){var e='<script type="text/html" id="'+d+'" '+f+'="'+g+'"><\/script>',h=b(e);return h.html(a||""),c.html2str(h)||e}},m.prototype.wrapStyle=function(a,d,e){var f=e||this.BIND_KEY,g=a||"undefined";return d=d||this.CONTAINER_ID,function(a){var e='<style type="text/css" id="'+d+'" '+f+'="'+g+'"></style>',h=b(e);return h.html(a||""),c.html2str(h)||e}},m.prototype.updateWrap=function(a,c){var d=a||"undefined",e=b("#"+(c||this.CONTAINER_ID));return!!e.length&&(e.attr(this.BIND_KEY,d),!0)},m.prototype.Launcher=function(a,b){if(!(a instanceof b.Creator))throw b.Error.make("instantiated");if(!(this instanceof b.Launcher))return new b.Launcher(a,b);c.def(this,"__widget__",b),c.def(this,"__instance__",a),c.def(this,"__options__",a.__options__),c.def(this,"ajax",a.ajax,{writable:!1,configurable:!1}),c.def(this,"template",a.template,{writable:!1,configurable:!1}),c.def(this,"styleLoader",a.styleLoader,{writable:!1,configurable:!1}),c.def(this,"ws",a.ws,{writable:!1,configurable:!1}),c.def(this,"__ready_done__",!1,{configurable:!0}),c.def(this,"__deferred__",null,{configurable:!0})},m.prototype.Launcher.prototype={getInstance:function(){return this.__instance__},getInitializer:function(){return this.getInstance().getInitializer()},getState:function(a){var b=this.getInstance();return b.getState.apply(b,arguments)},setState:function(a,b){var c=this.getInstance();return c.setState.apply(c,arguments),this},getData:function(){var a=this.getInstance();return a.getData.apply(a,arguments)},setData:function(a,b){var c=this.getInstance();return c.setData.apply(c,arguments),this},getCache:function(){var a=this.getInstance();return a.getCache.apply(a,arguments)},setCache:function(a,b){var c=this.getInstance();return c.setCache.apply(c,arguments),this},getUrl:function(a,b){var c=this.getInstance();return c.getUrl.apply(c,arguments)},load:function(a){if(this.__deferred__)return this.__deferred__;var d=this,e=this.__widget__,f=this.__options__||{},g=this.getInstance(),h=m.updateState.call(g,"beforeLoad");!1!==h&&g.callOption("statechange",h),g.callOption("beforeLoad");var i=b.Deferred();c.def(d,"__deferred__",i),i.done(function(b,f){if(g.context!==g.rootContext){var h=m.updateState.call(g,"loaded");!1!==h&&g.callOption("statechange",h),g.callOption("loaded")}if(c.isFunction(a))try{a.apply(d,arguments)}catch(a){e.Event.trigger("CallbackError",g.makeError("callback",[g.getPath(),"loadCallback",a.message],a))}c.def(d,"__deferred__",null)});var j=b.Deferred(),k=b.Deferred();b.when(j,k).done(function(a,f){var h;a[0]&&(h=c.concatError(h,a[0])),f&&f[0]&&(h=c.concatError(h,f[0]));var j=a[1];c.isEmpty(h)&&(h=c.__undef__);var k,l=[h],m=d.getState("container");m?(k=g.getContainerId(),c.def(g,"container",m)):d.setState("container",e.CONTAINER),d.setData(c.extend({},a[2],{$include:d.getData("$include")})),d.setState("source",a[3]);var n=function(a,d){var e;if((d=d||0)>1e3)return e;if(c.isArray(a))d+=1,b.each(a,function(a,c){var f=n(c,d);f&&(e=e||b([]),e=e.add(f))});else if(c.notNull(a)&&a.html){var f=c.trim(a.html);try{e=b(f)}catch(a){e=f}}return e};f&&d.setState("$style",n(f[1]));var o={html:j,wrap:e.wrap(d.getState("name"),k)};l.push(o),c.disposeDeferred(i,!1),i.resolve.apply(i.resolve,l)}),c.assignDeferred(i,[j,k]);var l=b.Deferred();l.done(function(a,b,d,e){c.disposeDeferred(j,!1);var f=c.__aslice.call(arguments);if(!c.isUndef(b)){var h=g.getData("__body__");if(c.notNull(h)){b=c.replaceMainBody(b,"body",h);try{delete g.__state__.data.__body__}catch(a){}f[1]=b}}j.resolve.apply(j.resolve,f)}),c.assignDeferred(j,l);var n=g.get("template"),o=g.callOption("data");if(!c.eqNull(n)||c.notNull(o)){c.isUndef(n)&&(n={url:d.getState("path")}),c.isObject(n)||(n={source:c.trim(n)});var p=c.extend({},n,{data:o,dataFilter:f.dataFilter});c.def(p,"__self__",!0),g.render(p,function(a){a&&g.removeError(a),l.resolve.apply(l.resolve,arguments)})}else l.resolve(c.__undef__,c.__undef__);var q=e.normalizeStylePath(g.callOption("style"));if(q){var r,s=[];b.each(q,function(a,b){r=e.normalizeState(b),r.context=g,s.push(e.load(r))}),b.when.apply(b.when,s).done(function(){var a,d,e=c.__aslice.call(arguments);s.length>1?b.each(e,function(b,c){c[0]&&(a=a||new Array(s.length),a[b]=c[0]),d=d||new Array(s.length),d[b]=c[1]}):(a=e[0],d=e[1]),c.disposeDeferred(k,!1),k.resolve(a,d)}),c.assignDeferred(k,s)}else k.resolve();return i},doneReady:function(){return!!this.__ready_done__},ready:function(){var a=this.__widget__,d=this.getInstance();c.def(this,"__ready_done__",!0);var e,f,g=d.__binds__;if(c.isArray(g)&&g.length){for(f=0;f<g.length;f++)e=g[f],c.isArray(e)&&d.unbind(e[0],e[1],e[3]);g.splice(0,g.length)}var h=m.updateState.call(d,"beforeReady");!1!==h&&d.callOption("statechange",h),d.callOption("beforeReady");var i=d.callOption("binds");if(c.isArray(i)&&i.length)for(f=0;f<i.length;f++)e=i[f],c.isArray(e)&&d.bind.apply(d,e);return d.load({mode:"lazy"}),b.each(d.__included__,function(b,c){if(a.instanceof(c)){c.getInstance().isLoaded()&&c.ready()}}),h=m.updateState.call(d,"ready"),!1!==h&&d.callOption("statechange",h),d.callOption("ready"),d.__already__||c.def(d,"__already__",!0),this},reset:function(a){var b,d=this.getInstance();if(a&&a.param)for(b in a.param)b in d.__state__.param?d.__state__.param[b]=a.param[b]:delete d.__state__.param[b];return d.__includes__.splice(0,d.__includes__.length),d.__included__.splice(0,d.__included__.length),this.ws.close(),c.def(this,"__ready_done__",!1),this},beforeDestroy:function(){var a,d=this.__widget__,e=this.getInstance(),f=c.__aslice.call(arguments);b.each(e.__included__,function(b,e){if(d.instanceof(e)&&(a=e.beforeDestroy.apply(e,f),c.notNull(a)))return!1});var g=m.updateState.call(e,"beforeDestroy");!1!==g&&e.callOption("statechange",g);var h=e.get("beforeDestroy");if(c.isNull(a)&&c.isFunction(h))try{a=h.apply(e,f)}catch(b){var i=e.makeError("callback",[e.getPath(),"beforeDestroy",b.message],b);a=i.message}return a},destroy:function(){var a,d=this.__widget__,e=this.getInstance();e.inState("beforeDestroy")||(a=m.updateState.call(e,"beforeDestroy"),!1!==a&&e.callOption("statechange",a),e.callOption("beforeDestroy")),b.each(e.__included__,function(a,b){d.instanceof(b)&&b.destroy()});var f=e.__binds__;if(c.isArray(f)){for(var g,h=0;h<f.length;h++)g=f[h],c.isArray(g)&&e.unbind(g[0],g[1],g[3]);f.splice(0,f.length)}return this.ws.close(),this},destroyed:function(){var a=this.__widget__,d=this.getInstance();b.each(d.__included__,function(b,c){a.instanceof(c)&&c.destroyed()}),d.__error__.splice(0,d.__error__.length),d.__includes__.splice(0,d.__includes__.length),d.__included__.splice(0,d.__included__.length),c.def(d,"__already__",!1),c.def(this,"__ready_done__",!1);var e=m.updateState.call(d,"destroyed");!1!==e&&d.callOption("statechange",e),d.callOption("destroyed");var f;for(f in d.__options__)delete d.__options__[f];for(f in d)delete d[f];return this},readyStyle:function(a){var d=this.getState("$style");if(c.is$(d)){var e,f=b(c.document.head||"head");if(a)try{e=b(a)}catch(a){e=f}e&&e.length||(e=f),e===f?e.append(d):e.prepend(d)}return this},destroyStyle:function(a){var b=this.__widget__,c=this.getState("$style");return b.removeStyle$(c,a),this},dispose:function(){var a=this.__widget__,c=this.getInstance();return m.updateState.call(c,"dispose"),this.ajax.abort(!1),b.each(c.__included__,function(b,c){a.instanceof(c)&&(m.updateState.call(c.getInstance(),"dispose"),c.ajax.abort(!1))}),this}},m.prototype.Creator=function(a,e,l){if(!(a instanceof l.Initializer))throw l.Error.make("initialized");if(!(this instanceof l.Creator))return new l.Creator(a,e,l);c.def(this,"__ns__",l.NAMESPACE),c.def(this,"__widget__",l),c.def(this,"__initializer__",a),c.def(this,"__options__",{}),c.def(this,"__setter__",c.setter(l.DEFAULTS,l.Creator)),c.def(this,"__getter__",c.getter(l.DEFAULTS,l.Creator)),c.def(this,"__state_index__",m.STATE_INDEX.BEFORE_CREATE,{configurable:!0}),c.def(this,"__state_index_getter__",c.stateIndexGetter(m.STATE,m.STATE_INDEX)),c.def(this,"__error__",[]),c.def(this,"__error_ns__","WIDGET"),c.def(this,"__error_maker__",c.errorMaker(l.Error));var o,p=this,q=a.getOptions();for(o in q)if(c.__hasOwn.call(q,o)){var r=q[o];c.isUndef(r)||this.set(o,r)}e=e||{},c.def(e,"label",m.STATE[this.__state_index__]),this.callOption("statechange",e),this.callOption("beforeCreate",e),c.def(this,"__state_org__",e),c.stateReplacement.call(this,"__state__",e),this.__state__.data&&this.__state__.data.reload&&(this.removeCache(),delete this.__state__.data.reload),c.def(this,"__already__",!1,{configurable:!0}),c.def(this,"__binds__",[]),c.def(this,"__includes__",[]),c.def(this,"__included__",[]),c.def(this,"rootContext",l.CONTEXT||this,{writable:!1,configurable:!1}),c.def(this,"context",l.CONTEXT||this,{writable:!1}),c.def(this,"container",l.CONTAINER,{writable:!1});var s=this.callOption("binds");c.isArray(s)||(s=[]);var t=[];b.each(s,function(a,b){c.isArray(b)&&t.push(d.normalizeBindArgs.apply(d,b))}),this.set("binds",t);var u=c.extend({},l.DEFAULTS.loading,this.callOption("loading"),{type:"include"});this.set("loading",u);var v=this.callOption("cache");if(c.isNull(v))try{v=this.rootContext.get("cache"),this.set("cache",v)}catch(a){}var w,x=this.callOption("template");if(c.notNull(x)&&c.isObject(x))if(f.instanceof(x)&&(x=x.get(),c.notNull(x)&&!c.isObject(x)&&(x={url:c.trim(x)})),c.notNull(x))for(o in x)c.__hasOwn.call(g.DEFAULTS,o)||(w=w||{},w[o]=x[o],delete x[o]);else w=x;else w=x;this.set("template",l.defaultTemplate(w));var y=this.callOption("styleLoader");c.notNull(v)&&(y=c.extend({cache:v},y)),this.set("styleLoader",y);var z=this.callOption("mode");this.set("mode",z);var A=this.callOption("ajax");c.notNull(z)&&(A=c.extend({mode:z},A)),this.set("ajax",A);var B=this.callOption("websocket");c.notNull(z)&&(B=c.extend({mode:z},B)),this.set("websocket",B),this.set("cookie",this.callOption("cookie"));var C=this.get("rendered");c.def(this,"template",g(c.extend({cache:v,include:function(){return n.apply(p,arguments)}},x,c.isFunction(C)?{rendered:C}:null),this),{writable:!1,configurable:!1}),c.def(this,"__render_file__",null,{configurable:!0}),c.def(this,"styleLoader",j(y,this),{writable:!1,configurable:!1}),c.def(this,"ajax",h(A,this),{writable:!1,configurable:!1}),c.def(this,"ws",i(B,this),{writable:!1,configurable:!1}),c.def(this,"cookie",k(null,this),{writable:!1,configurable:!1});var D=this.get("cookie");if(c.notNull(D)&&c.isObject(D)){var E;for(o in D)E=D[o],c.__hasOwn.call(k.DEFAULTS,o)?this.cookie.setOption(o,E):c.__hasProto.call(k.prototype,o)||(this.cookie[o]=E),E=c.__undef__}this.cookie.setPath(this.getPath());var F=m.updateState.call(this,"created");!1!==F&&this.callOption("statechange",F),this.callOption("created")},m.prototype.Creator.prototype={getInitializer:function(){return this.__initializer__},getLayout:function(){return this.__layout__},set:function(a,b){var d,e=this.__setter__;if(c.isFunction(e)&&(d=e.apply(this,arguments)),!1===d){var f=this.makeError("setter",[this.getPath(),a]);this.addError(f);var g=this.__widget__;this.afterState("beforeLoad")&&g.Event.trigger("Error",f)}return this},get:function(a){var b,d=this.__getter__;return c.isFunction(d)&&(b=d.apply(this,arguments)),b},getOptions:function(){return c.extend(!0,{},this.__options__)},callOption:function(a,b){var d=c.__aslice.call(arguments,1);return this.applyOption(a,d)},applyOption:function(a,b){var d,e;c.isArray(b)||(b=c.isUndef(b)?[]:[b]),c.isFunction(a)?(d=a,a=d.name):d=this.get(a);var f,g={__caller_name__:a};if(c.isFunction(d))try{e=d.apply(this,b)}catch(b){f=c.setPropsRecursive(this.makeError("callback",[this.getPath(),a,b.message],b),g),this.addError(f),e=c.__undef__}else e=d;if(!c.isEmpty(f)&&this.afterState("beforeLoad")){this.__widget__.Event.trigger("Error",f)}return e},setState:function(a,b){var d=c.stateSetter(this.__state__,this.__state_org__);return c.isFunction(d)&&d.apply(this,arguments),this},getState:function(a){var b,d=c.stateGetter(this.__state__);return c.isFunction(d)&&(b=d.apply(this,arguments)),b},getStateIndex:function(a){var b,d=this.__state_index_getter__;return c.isFunction(d)&&(b=d.apply(this,arguments)),b},inState:function(a){var b=!1,d=this.getStateIndex(a);return c.isUndef(d)||this.__state_index__!=d||(b=!0),b},beforeState:function(a){var b=!1,d=this.getStateIndex(a);return!c.isUndef(d)&&this.__state_index__<d&&(b=!0),b},afterState:function(a){var b=!1,d=this.getStateIndex(a);return!c.isUndef(d)&&this.__state_index__>d&&(b=!0),b},isBeforeCreate:function(){return this.inState("beforeCreate")},isCreated:function(){return this.inState("created")},isBeforeLoad:function(){return this.inState("beforeLoad")},isLoaded:function(){return this.inState("loaded")},isBeforeReady:function(){return this.inState("beforeReady")},isReady:function(){return this.inState("ready")},isBeforeDestroy:function(){return this.inState("beforeDestroy")},isDestroyed:function(){return this.inState("destroyed")},isDispose:function(){return this.inState("dispose")},already:function(){return!!this.__already__},getUrl:function(a,b){var d,e=this.__widget__;d=c.notNull(this.__render_file__)?e.trimTemplatePath(this.__render_file__):this.getPath();var f=c.toUrl(a,b,d);return e.REGEXP_HASH_START.test(f)||(f="#"+f),f},getPath:function(a){return c.getPath(a,this.getState("path"))},getPathId:function(a){return c.getPathId(a,this.getState("path"))},getParam:function(a){return c.getParam(a,this.getParams())},getParams:function(){return this.getState("param")||{}},getData:function(a){var b,d=this.getState("data");return d&&(c.isUndef(a)?b=d:(a=c.trim(a),a.length>0&&(b=d[a])),b=c.copyValue(b)),b},setData:function(a,b){if(this.__state__&&this.__state__.data&&c.notNull(a))if(c.isObject(a))for(var d in a)c.def(this.__state__.data,d,a[d],{enumerable:!0});else a=c.trim(a),a.length>0&&c.def(this.__state__.data,a,b,{enumerable:!0});return this},getCache:function(a){var b=c.__aslice.call(arguments),d=this.getInitializer(),e=this.getCacheKey();return c.isEmpty(e)?d.getCache.apply(d,b):(b.unshift(e),d.getCache.call(d,b))},setCache:function(a,b){var d=c.__aslice.call(arguments),e=this.getInitializer(),f=this.getCacheKey();return c.isEmpty(f)||(c.isArray(d[0])||(d[0]=[d[0]]),d[0].unshift(f)),e.setCache.apply(e,d),this},removeCache:function(a){var b=c.__aslice.call(arguments),d=this.getInitializer(),e=this.getCacheKey();return c.isEmpty(e)?d.removeCache.apply(d,b):(b.unshift(e),d.removeCache.call(d,b)),this},getCacheKey:function(){if(this.__cacheKey__)return this.__cacheKey__;var a=[],b=this.__widget__,d=this.context;if(d!==this.rootContext){a.push(this.getState("name"));var e=this.getState("include"),f=e?e.id:c.__undef__;for(c.isUndef(f)||a.push(f);b.instanceof(d,b.Creator)&&d!==this.rootContext;)a.push(d.getState("name")),d=d.context}else a.push(this.getState("name"));return a="__"+a.join("_")+"__",c.def(this,"__cacheKey__",a),a},getContainerId:function(){var a=this.__widget__,b=this.getState("container");return b||(b=c.trim(this.container)),b=b.replace(a.REGEXP_HASH_START,"")},findInclude:function(a,d){var e=this.to$(a),f=this.includeSelector();return c.notNull(d)&&(d=parseInt(d),f=f+":eq("+d+")"),b(f,e)},firstInclude:function(a){var c=this.to$(a),d=this.includeSelector();return b(d+":first",c)},lastInclude:function(a){var c=this.to$(a),d=this.includeSelector();return b(d+":last",c)},readyInclude:function(a,d){function e(a,d){if(c.isNull(d)||this.isDestroyed()||this.isDispose())return this;var g=d.context;if(f.instanceof(g)){var h,i=g.getInstance();try{h=b(i.container)}catch(a){h=null}h&&h.length?g.doneReady()||g.readyStyle(h).ready():c.requestAnimationFrame.call(this,e,c.__aslice.call(arguments),30)}}if(this.isDestroyed()||this.isDispose()||this.beforeState("ready"))return this;var f=this.__widget__;if(c.isArray(d))for(var g=0;g<d.length;g++)e.call(this,a?a[g]:c.__undef__,d[g]);else e.call(this,a,d);return this},includeSelector:function(){var a=this.__widget__,b=a.INCLUDE_WIDGET;return'[id^="'+b.CONTAINER_ID+'"]['+b.BIND_KEY+"]"},to$:function(a){c.isEmpty(a)&&(a=this.container);var d;try{d=c.is$(a)?a:b(a)}catch(a){d=c.__undef__}return d},$:function(a){var d,e=this.to$()||b([]);if(c.isDom(a)||c.is$(a)||(a=c.trim(a)),c.isEmpty(a))return b([]);try{if(/^window$/i.test(a))return b(c.window);if(/^document$/i.test(a))return b(c.document);if(c.isDom(a))return b(a);if(c.is$(a))return a;d=b(a,e)}catch(a){d=b([])}if(d.prevObject&&d.prevObject.length||(d.prevObject=e),!d.length)return d;var f=this,g=b([]),h=this.includeSelector();return d.each(function(){var a=b(this),c=a.parents(h+":first").attr("id");(c=c?"#"+c:f.container)===f.container&&(g=g.add(a))}),g.selector=d.selector,g.context=d.context,g.prevObject=d.prevObject,g},bind:function(a,b,e,f,g){function h(a,b,d,e,f){for(var g,h=-1,i=0;i<o.length;i++)if(g=o[i],c.isArray(g)&&g[0]===a&&g[1]===b&&g[2]===d&&g[3]===e&&g[4]===f){h=i;break}return h}var i=this,j=this.__widget__;if(this.isDestroyed()||this.isDispose())return this;if(c.notNull(a)&&c.isObject(a)){c.validElement(b)||(e=e||b,b=c.__undef__);for(var k in a)this.bind(k,b,e,a[k],g);return this}var l=d.normalizeBindArgs.apply(this,arguments);if(!l)return this;if(a=l[0],b=l[1],e=l[2],f=l[3],this.beforeState("beforeReady")){var m=i.get("binds");return c.isArray(m)||(m=[]),m.push([a,b,e,f,g]),i.set("binds",m),this}if(f&&(f.context=i),c.is$(b))f&&b.prevObject&&(f.delegateTarget=b.prevObject[0]),j.Event.bind(a,b,e,f,g);else{if(b=/^viewchange/.test(a)?c.window:b?i.$(b):i.to$(),f){var n=i.to$();n&&(f.delegateTarget=n[0])}j.Event.bind(a,b,e,f,g)}var o=i.__binds__;return-1==h(a,b,e,f,g)&&o.push([a,b,e,f,g]),this},on:function(){return this.bind.apply(this,arguments)},one:function(a,b,c,d){return this.bind(a,b,c,d,1)},unbind:function(a,b,e){var f=this,g=this.__widget__,h=d.normalizeUnBindArgs.apply(d,arguments);return a=h[0],b=h[1],e=h[2],c.is$(b)?g.Event.unbind(a,b,e):(b=/^viewchange/.test(a)?c.window:b?f.$(b):f.to$(),g.Event.unbind(a,b,e)),this},
off:function(){return this.unbind.apply(this,arguments)},trigger:function(a,b,e){var f=this,g=this.__widget__;if(this.isDestroyed()||this.isDispose())return this;if(this.beforeState("ready"))return g.Event.trigger.apply(g.Event,arguments),this;var h=d.normalizeTriggerArgs.apply(d,arguments);return a=h[0],b=h[1],e=h[2],c.is$(e)?g.Event.trigger(a,b,e):(e=/^viewchange/.test(a)?c.window:e?f.$(e):f.to$(),g.Event.trigger(a,b,e)),this},makeError:function(a,b,d){var e,f=this.__error_maker__;return c.isFunction(f)&&(e=f.apply(this,arguments)),e||{}},setError:function(a){return this.__error__.splice(0,this.__error__.length),this.addError.apply(this,arguments),this},getError:function(a){return c.isNull(a)?c.isEmpty(this.__error__)?[]:[].concat(this.__error__):c.sliceError(this.__error__,a)},addError:function(a){var b=c.__aslice.call(arguments);b.unshift(this.__error__);var d=c.concatError.apply(c,b);return this.__error__.splice(0,this.__error__.length),this.__error__.push.apply(this.__error__,d),this},removeError:function(a){var b=c.__aslice.call(arguments);b.unshift(this.__error__);var d=c.shiftError.apply(c,b);return this.__error__.splice(0,this.__error__.length),this.__error__.push.apply(this.__error__,d),this},includeError:function(a,b){var d=c.__aslice.call(arguments);return d.unshift(this.__error__),c.includeError.apply(c,d)},excludeError:function(a,b){var d=c.__aslice.call(arguments);return d.unshift(this.__error__),c.excludeError.apply(c,d)},inError:function(a){var b=c.__aslice.call(arguments);return b.unshift(this.__error__),c.inError.apply(c,b)},onError:function(a,b){return c.isFunction(b)&&c.setPropsRecursive(a,{__err_handler__:b}),this},assignError:function(a,b,d){return b=this.__widget__.Error.normalizeOption(b),c.setPropsRecursive(a,b,d),this},render:function(a,d,e,h){function i(a){return c.isEmpty(a)?a=c.__undef__:(a=c.trim(a),a=c.toUrl(a,null,l.getPath()),a=m.normalizeTemplatePath(a)),a}var j,k,l=this,m=this.__widget__;f.instanceof(a)&&(a=a.get(),c.notNull(a)&&!c.isObject(a)&&(a={url:a})),c.isFunction(d)?(c.isFunction(e)?(e=d,h=e):(e=c.__undef__,h=d),d=c.__undef__):c.isFunction(e)&&!c.isFunction(h)&&(h=e,e=c.__undef__),c.notNull(a)&&(c.isObject(a)?(j=a.url,k=a.source,c.isUndef(d)&&(d=a.data),c.isUndef(e)&&(e=a.dataFilter),c.isUndef(h)&&(h=a.callback)):k=c.trim(a));var n=!!a&&!!a.__self__;j=i(j);var o=b.Deferred(),q={__caller_name__:p+".render"},r=c.extend({context:l},q);return function(a,d,e,h,i,j,k){a.done(function(a,b,d,e){var f=c.__aslice.call(arguments);c.requestAnimationFrame.call(l,function(a,b,d,e,f){a=c.setPropsRecursive(a,r);var g=this;g.addError(a);var h;if(c.isFunction(k))try{k.apply(g,arguments),c.normalizeCallbackArgs(k,arguments)}catch(a){var i=c.setPropsRecursive(g.makeError("callback",[g.getPath(),"render callback",a.message],a),r);g.addError(i)}h=g.getError(q),!c.isEmpty(h)&&g.afterState("beforeLoad")&&m.Event.trigger("Error",h),c.isArray(f)&&g.readyInclude.apply(g,f)},f)});var n=b.Deferred(),o=b.Deferred();b.when(n,o).done(function(b,d){var e;b[0]&&(e=b[0],l.addError(b[0]));var f;if(c.isFunction(j)){var h=[].concat(b);h.unshift(j),f=l.template.dataFilter.apply(l.template,h),e=l.includeError(!0,e),c.notNull(j.__err_called__)&&(e=c.concatError(e,j.__err_called__))}else f=b[1];l.removeError(e);var i=g.normalizeData(f);i=c.extend({},i,{$param:l.getState("param"),$include:l.getData("$include")}),d[0]&&(e=c.concatError(e,d[0])),c.isEmpty(e)&&(e=c.__undef__),d=d.slice(1),c.isUndef(d[0])?a.resolve(e,c.__undef__,f,d[0]):l.template.render(d[0],i,d[1],function(b,g,h,i,j){b&&(l.removeError(b),e=c.concatError(e,b)),j&&c.def(j,"__do_ready__",!0),a.resolve(e,g,f,d[0],j)})});var p=!1;f.instanceof(i)&&(i=i.get(),p=!0),c.isPromise(i)?i.done(function(){var a=c.__aslice.call(arguments);a.unshift(c.__undef__),n.resolve.apply(n.resolve,a)}).fail(function(){var a=c.__aslice.call(arguments);c.notNull(a[0])&&!c.isObject(a[0])&&(a[0]={message:c.trim(a[0])}),n.resolve.apply(n.resolve,a)}):p&&c.notNull(i)?l.ajax.send(i,function(a,b,c){a&&l.removeError(a),n.resolve(a,b,c)}):n.resolve(c.__undef__,i),e?l.template.remote(e,function(a,b){a&&l.removeError(a),d&&b&&c.notNull(b.filename)&&l.setState("template",b.filename),o.resolve(a,b?b.source:c.__undef__,b?b.filename:c.__undef__)}):o.resolve(c.__undef__,h||c.__undef__)}(o,n,j,k,d,e,h),o.promise()},load:function(a,d){function e(a){if(a){var b=c.extend({},h.get("loading"),{id:"include-"+a.id,container:a.container}),d=l(b,h);a.__loading__=d,d.ready()}}function f(a){if(a){var b=a.__loading__;b instanceof l&&b.destroy(),delete a.__loading__}}function g(a,d){if(a&&d){var e=b(d.container);c.isUndef(a.html)||e.html(a.html);var f;i.instanceof(f=a.context)&&(c.inArray(f,h.__included__)<0&&h.__included__.push(f),f.readyStyle(e).ready())}}var h=this,i=this.__widget__.INCLUDE_WIDGET||this;if(!c.isEmpty(a)){var j;if(c.is$(a))try{c.isNull(a.attr(i.BIND_KEY))&&(a=h.firstInclude(a)),a.length?(j=a.attr("id"),a={}):a=c.__undef__}catch(b){a=c.__undef__}else c.isObject(a)?j=a.id:(j=a,a={});if(!a)return this;if(!c.isEmpty(j)){j=c.trim(j).replace(i.REGEXP_HASH_START,"");var k=i.CONTAINER_ID+"-";0==j.indexOf(k)&&(j=j.substring(k.length)),j&&(a.id=j)}}if(c.isEmpty(a))return this;var m=i.sliceIncludes(this.__includes__,a);if(c.isEmpty(m))return this;if(c.notNull(d)&&!c.isObject(d)){d=c.trim(d),-1==d.indexOf("?")&&(d="?"+d);try{d=b.parseQuery(d)}catch(a){d=c.__undef__}}return b.each(m,function(a,b){if(d)if(c.isEmpty(b.param))b.param=c.extend({},d);else{for(var f in b.param)f in d||delete b.param[f];b.param=c.extend(b.param,d)}e(b)}),i.includeAsync(m,h.__included__,function(a,b){if(b){var d,e,h,j=!1;if(i.instanceof(e=b.context)?(h=e.getInstance(),d=h.getState(),i.instanceof(h.context,i.Creator)&&(j=h.context.isDestroyed()||h.context.isDispose())):d=b.state,c.isEmpty(a)&&c.isUndef(b.html)&&(b.html=""),f(d),j)return;g(b,d),a&&i.Event.trigger("IncludeError",a)}}),this}},c.def(m.prototype.Creator.prototype,"__const_props__",["__ns__","__widget__","__initializer__","__options__","__setter__","__getter__","__error__","__error_ns__","__error_maker__","__state_index__","__state_index_getter__","__state_org__","__state__","__already__","__binds__","__includes__","__included__","__render_file__","rootContext","context","container","ajax","template","styleLoader","ws","cookie"]),m.prototype.Initializer=function(a,b){if(!(this instanceof b.Initializer))return new b.Initializer(a,b);c.def(this,"__widget__",b),c.def(this,"__options__",c.extend({},b.DEFAULTS,a)),c.def(this,"__cache__",{})},m.prototype.Initializer.prototype={set:function(a,b){var d=this.__widget__;return c.isFunction(this.__setter__)||c.def(this,"__setter__",c.optionSetter(d.DEFAULTS)),this.__setter__.apply(this,arguments),this},get:c.optionGetter(),getOptions:c.optionsGetter(),getCache:function(a){var b;if(this.__cache__){var d,e=this.__cache__;if(c.isArray(a))for(var f=0;f<a.length&&(d=c.trim(a[f]),!c.isNull(e));f++)!c.isEmpty(d)&&f<a.length-1&&(e=e[d]);else c.isUndef(a)||(d=c.trim(a));a=d,c.isNull(a)?b=e:!c.isEmpty(a)&&c.notNull(e)&&(b=e[a]),b=c.copyValue(b)}return b},setCache:function(a,b){if(this.__cache__){var d,e,f=this.__cache__;if(c.isArray(a)){for(var g=0;g<a.length;g++)if(d=a[g],c.notNull(d)){if(c.isObject(d)){for(e in d)f[e]=d[e];break}c.isEmpty(d)||(d=c.trim(d),g==a.length-1?f[d]=b:(!c.isNull(f[d])&&c.isObject(f[d])||(f[d]={}),f=f[d]))}}else if(c.notNull(a))if(c.isObject(a))for(d in a)f[a]=a[d];else c.isEmpty(a)||(a=c.trim(a),f[a]=b)}return this},removeCache:function(a){if(this.__cache__){var b,d=this.__cache__;if(c.isArray(a))for(var e=0;e<a.length&&(b=c.trim(a[e]),!c.isNull(d));e++)!c.isEmpty(b)&&e<a.length-1&&(d=d[b]);else c.isUndef(a)||(b=c.trim(a));if(a=b,c.notNull(d))if(c.isNull(a))for(b in d)delete d[b];else c.isEmpty(a)||delete d[a]}return this},bind:function(a,b,e,f,g){if(c.notNull(a)&&c.isObject(a)){c.validElement(b)||(e=e||b,b=c.__undef__);for(var h in a)this.bind(h,b,e,a[h],g);return this}var i=d.normalizeBindArgs.apply(this,arguments);if(!i)return this;a=i[0],b=i[1],e=i[2],f=i[3];var j=this.get("binds");return c.isArray(j)?j.push([a,b,e,f,g]):j=[[a,b,e,f,g]],this.set("binds",j),this},on:function(){return this.bind.apply(this,arguments)},one:function(a,b,c,d){return this.bind(a,b,c,d,1)},beforeCreate:function(a){return this.set("beforeCreate",a),this},created:function(a){return this.set("created",a),this},beforeLoad:function(a){return this.set("beforeLoad",a),this},loaded:function(a){return this.set("loaded",a),this},beforeReady:function(a){return this.set("beforeReady",a),this},ready:function(a){return this.set("ready",a),this},beforeDestroy:function(a){return this.set("beforeDestroy",a),this},destroyed:function(a){return this.set("destroyed",a),this}},m.prototype.create=function(a){return new this.Initializer(a,this)},m}),define("yfjs/spa/ui/loading",["../version","jquery","../util/helpers","../util/error","../util/event"],function(a,b,c,d,e){var f=function(a,b){if(!(this instanceof f))return new f(a,b);c.notNull(a)&&!c.isObject(a)&&(a={type:c.trim(a)}),c.def(this,"__options__",c.extend({},f.DEFAULTS,a)),this.setOption("type",c.trim(this.getOption("type"))),a=this.__options__||{},c.def(this,"__context__",b);var d=c.isEmpty(a.id)?c.isEmpty(a.type)?"":a.type:a.id;c.def(this,"id",d,{writable:!1,configurable:!1}),c.def(this,"containerId",f.CONTAINER_ID+(c.isEmpty(d)?"":"-"+d),{writable:!1,configurable:!1}),c.def(this,"className",f.CLASSNAME+(c.isEmpty(a.type)?"":"-"+a.type),{writable:!1,configurable:!1})};return f.NAMESPACE="Loading",f.VERSION=a(f.NAMESPACE),f.CONTAINER_ID="app-loader",f.CLASSNAME="loading",f.DEFAULTS={type:"",id:"",container:"body",html:'<div class="loader"></div>',ready:function(a){return b(".loader",a).loader(),this},destroy:function(a){return b(".loader",a).loader("destroy"),this}},f.Error=d(f.NAMESPACE),f.Error.translate({callback:"执行 Loading - {0} 的 {1} 操作时发生了错误: {2}"}),f.Event=e(f.NAMESPACE),f.prototype={setOption:c.optionSetter(f.DEFAULTS),getOption:c.optionGetter(),getOptions:c.optionsGetter(),getContext:function(){return this.__context__},getContainer$:function(){var a,d=this.getOption("container")||c.docBody;try{a=b(d),a.length||(a=b(c.docBody))}catch(d){a=b(c.docBody)}return a},ready:function(){var a=this.__options__||{},b=this.getContainer$();b.addClass(this.className);var d;if(c.isFunction(a.html))try{d=a.html.call(this.getContext()||this,this)}catch(b){return f.Event.trigger("Error",this.makeError("callback",[a.type,"calledHtmlOption",b.message],b)),!1}else d=a.html;d=c.trim(d);var e="#"+this.containerId,g=b.children(e);if(g.length?g.html(d):(d=f.wrap(this.id,a.type)(d),b.prepend(d),g=b.children(e)),c.isFunction(a.ready))try{a.ready.call(this.getContext()||this,g,this)}catch(b){return f.Event.trigger("Error",this.makeError("callback",[a.type,"ready",b.message],b)),!1}},destroy:function(){var a,b=this.__options__||{},d=this.getContainer$(),e="#"+this.containerId,g=d.children(e);if(c.isFunction(b.destroy))try{b.destroy.call(this.getContext()||this,g,this)}catch(c){a=this.makeError("callback",[b.type,"destroy",c.message],c)}if(d.removeClass(this.className),g.remove(),a)return f.Event.trigger("Error",a),!1},makeError:function(a,b,d){var e=this.__error_maker__;return e||(c.def(this,"__error_maker__",c.errorMaker(f.Error,this.getContext())),e=this.__error_maker__),e.apply(this,arguments)}},f.wrap=function(a,d){return a=f.CONTAINER_ID+(c.isEmpty(a)?"":"-"+a),d=f.CONTAINER_ID+(c.isEmpty(d)?"":"-"+d),function(e){var f='<div class="'+d+'" id="'+a+'"></div>',g=b(f);return g.html(e||""),c.html2str(g)||f}},f});